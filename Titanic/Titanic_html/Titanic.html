<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />
<title>Titanic</title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<style type="text/css">
    /*!
*
* Twitter Bootstrap
*
*/
/*!
 * Bootstrap v3.3.7 (http://getbootstrap.com)
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */
html {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block;
  vertical-align: baseline;
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a {
  background-color: transparent;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"],
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button;
  cursor: pointer;
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box;
  padding: 0;
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield;
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0;
  padding: 0;
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */
@media print {
  *,
  *:before,
  *:after {
    background: transparent !important;
    color: #000 !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  a,
  a:visited {
    text-decoration: underline;
  }
  a[href]:after {
    content: " (" attr(href) ")";
  }
  abbr[title]:after {
    content: " (" attr(title) ")";
  }
  a[href^="#"]:after,
  a[href^="javascript:"]:after {
    content: "";
  }
  pre,
  blockquote {
    border: 1px solid #999;
    page-break-inside: avoid;
  }
  thead {
    display: table-header-group;
  }
  tr,
  img {
    page-break-inside: avoid;
  }
  img {
    max-width: 100% !important;
  }
  p,
  h2,
  h3 {
    orphans: 3;
    widows: 3;
  }
  h2,
  h3 {
    page-break-after: avoid;
  }
  .navbar {
    display: none;
  }
  .btn > .caret,
  .dropup > .btn > .caret {
    border-top-color: #000 !important;
  }
  .label {
    border: 1px solid #000;
  }
  .table {
    border-collapse: collapse !important;
  }
  .table td,
  .table th {
    background-color: #fff !important;
  }
  .table-bordered th,
  .table-bordered td {
    border: 1px solid #ddd !important;
  }
}
@font-face {
  font-family: 'Glyphicons Halflings';
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot');
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff2') format('woff2'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff') format('woff'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.ttf') format('truetype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');
}
.glyphicon {
  position: relative;
  top: 1px;
  display: inline-block;
  font-family: 'Glyphicons Halflings';
  font-style: normal;
  font-weight: normal;
  line-height: 1;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
.glyphicon-asterisk:before {
  content: "\002a";
}
.glyphicon-plus:before {
  content: "\002b";
}
.glyphicon-euro:before,
.glyphicon-eur:before {
  content: "\20ac";
}
.glyphicon-minus:before {
  content: "\2212";
}
.glyphicon-cloud:before {
  content: "\2601";
}
.glyphicon-envelope:before {
  content: "\2709";
}
.glyphicon-pencil:before {
  content: "\270f";
}
.glyphicon-glass:before {
  content: "\e001";
}
.glyphicon-music:before {
  content: "\e002";
}
.glyphicon-search:before {
  content: "\e003";
}
.glyphicon-heart:before {
  content: "\e005";
}
.glyphicon-star:before {
  content: "\e006";
}
.glyphicon-star-empty:before {
  content: "\e007";
}
.glyphicon-user:before {
  content: "\e008";
}
.glyphicon-film:before {
  content: "\e009";
}
.glyphicon-th-large:before {
  content: "\e010";
}
.glyphicon-th:before {
  content: "\e011";
}
.glyphicon-th-list:before {
  content: "\e012";
}
.glyphicon-ok:before {
  content: "\e013";
}
.glyphicon-remove:before {
  content: "\e014";
}
.glyphicon-zoom-in:before {
  content: "\e015";
}
.glyphicon-zoom-out:before {
  content: "\e016";
}
.glyphicon-off:before {
  content: "\e017";
}
.glyphicon-signal:before {
  content: "\e018";
}
.glyphicon-cog:before {
  content: "\e019";
}
.glyphicon-trash:before {
  content: "\e020";
}
.glyphicon-home:before {
  content: "\e021";
}
.glyphicon-file:before {
  content: "\e022";
}
.glyphicon-time:before {
  content: "\e023";
}
.glyphicon-road:before {
  content: "\e024";
}
.glyphicon-download-alt:before {
  content: "\e025";
}
.glyphicon-download:before {
  content: "\e026";
}
.glyphicon-upload:before {
  content: "\e027";
}
.glyphicon-inbox:before {
  content: "\e028";
}
.glyphicon-play-circle:before {
  content: "\e029";
}
.glyphicon-repeat:before {
  content: "\e030";
}
.glyphicon-refresh:before {
  content: "\e031";
}
.glyphicon-list-alt:before {
  content: "\e032";
}
.glyphicon-lock:before {
  content: "\e033";
}
.glyphicon-flag:before {
  content: "\e034";
}
.glyphicon-headphones:before {
  content: "\e035";
}
.glyphicon-volume-off:before {
  content: "\e036";
}
.glyphicon-volume-down:before {
  content: "\e037";
}
.glyphicon-volume-up:before {
  content: "\e038";
}
.glyphicon-qrcode:before {
  content: "\e039";
}
.glyphicon-barcode:before {
  content: "\e040";
}
.glyphicon-tag:before {
  content: "\e041";
}
.glyphicon-tags:before {
  content: "\e042";
}
.glyphicon-book:before {
  content: "\e043";
}
.glyphicon-bookmark:before {
  content: "\e044";
}
.glyphicon-print:before {
  content: "\e045";
}
.glyphicon-camera:before {
  content: "\e046";
}
.glyphicon-font:before {
  content: "\e047";
}
.glyphicon-bold:before {
  content: "\e048";
}
.glyphicon-italic:before {
  content: "\e049";
}
.glyphicon-text-height:before {
  content: "\e050";
}
.glyphicon-text-width:before {
  content: "\e051";
}
.glyphicon-align-left:before {
  content: "\e052";
}
.glyphicon-align-center:before {
  content: "\e053";
}
.glyphicon-align-right:before {
  content: "\e054";
}
.glyphicon-align-justify:before {
  content: "\e055";
}
.glyphicon-list:before {
  content: "\e056";
}
.glyphicon-indent-left:before {
  content: "\e057";
}
.glyphicon-indent-right:before {
  content: "\e058";
}
.glyphicon-facetime-video:before {
  content: "\e059";
}
.glyphicon-picture:before {
  content: "\e060";
}
.glyphicon-map-marker:before {
  content: "\e062";
}
.glyphicon-adjust:before {
  content: "\e063";
}
.glyphicon-tint:before {
  content: "\e064";
}
.glyphicon-edit:before {
  content: "\e065";
}
.glyphicon-share:before {
  content: "\e066";
}
.glyphicon-check:before {
  content: "\e067";
}
.glyphicon-move:before {
  content: "\e068";
}
.glyphicon-step-backward:before {
  content: "\e069";
}
.glyphicon-fast-backward:before {
  content: "\e070";
}
.glyphicon-backward:before {
  content: "\e071";
}
.glyphicon-play:before {
  content: "\e072";
}
.glyphicon-pause:before {
  content: "\e073";
}
.glyphicon-stop:before {
  content: "\e074";
}
.glyphicon-forward:before {
  content: "\e075";
}
.glyphicon-fast-forward:before {
  content: "\e076";
}
.glyphicon-step-forward:before {
  content: "\e077";
}
.glyphicon-eject:before {
  content: "\e078";
}
.glyphicon-chevron-left:before {
  content: "\e079";
}
.glyphicon-chevron-right:before {
  content: "\e080";
}
.glyphicon-plus-sign:before {
  content: "\e081";
}
.glyphicon-minus-sign:before {
  content: "\e082";
}
.glyphicon-remove-sign:before {
  content: "\e083";
}
.glyphicon-ok-sign:before {
  content: "\e084";
}
.glyphicon-question-sign:before {
  content: "\e085";
}
.glyphicon-info-sign:before {
  content: "\e086";
}
.glyphicon-screenshot:before {
  content: "\e087";
}
.glyphicon-remove-circle:before {
  content: "\e088";
}
.glyphicon-ok-circle:before {
  content: "\e089";
}
.glyphicon-ban-circle:before {
  content: "\e090";
}
.glyphicon-arrow-left:before {
  content: "\e091";
}
.glyphicon-arrow-right:before {
  content: "\e092";
}
.glyphicon-arrow-up:before {
  content: "\e093";
}
.glyphicon-arrow-down:before {
  content: "\e094";
}
.glyphicon-share-alt:before {
  content: "\e095";
}
.glyphicon-resize-full:before {
  content: "\e096";
}
.glyphicon-resize-small:before {
  content: "\e097";
}
.glyphicon-exclamation-sign:before {
  content: "\e101";
}
.glyphicon-gift:before {
  content: "\e102";
}
.glyphicon-leaf:before {
  content: "\e103";
}
.glyphicon-fire:before {
  content: "\e104";
}
.glyphicon-eye-open:before {
  content: "\e105";
}
.glyphicon-eye-close:before {
  content: "\e106";
}
.glyphicon-warning-sign:before {
  content: "\e107";
}
.glyphicon-plane:before {
  content: "\e108";
}
.glyphicon-calendar:before {
  content: "\e109";
}
.glyphicon-random:before {
  content: "\e110";
}
.glyphicon-comment:before {
  content: "\e111";
}
.glyphicon-magnet:before {
  content: "\e112";
}
.glyphicon-chevron-up:before {
  content: "\e113";
}
.glyphicon-chevron-down:before {
  content: "\e114";
}
.glyphicon-retweet:before {
  content: "\e115";
}
.glyphicon-shopping-cart:before {
  content: "\e116";
}
.glyphicon-folder-close:before {
  content: "\e117";
}
.glyphicon-folder-open:before {
  content: "\e118";
}
.glyphicon-resize-vertical:before {
  content: "\e119";
}
.glyphicon-resize-horizontal:before {
  content: "\e120";
}
.glyphicon-hdd:before {
  content: "\e121";
}
.glyphicon-bullhorn:before {
  content: "\e122";
}
.glyphicon-bell:before {
  content: "\e123";
}
.glyphicon-certificate:before {
  content: "\e124";
}
.glyphicon-thumbs-up:before {
  content: "\e125";
}
.glyphicon-thumbs-down:before {
  content: "\e126";
}
.glyphicon-hand-right:before {
  content: "\e127";
}
.glyphicon-hand-left:before {
  content: "\e128";
}
.glyphicon-hand-up:before {
  content: "\e129";
}
.glyphicon-hand-down:before {
  content: "\e130";
}
.glyphicon-circle-arrow-right:before {
  content: "\e131";
}
.glyphicon-circle-arrow-left:before {
  content: "\e132";
}
.glyphicon-circle-arrow-up:before {
  content: "\e133";
}
.glyphicon-circle-arrow-down:before {
  content: "\e134";
}
.glyphicon-globe:before {
  content: "\e135";
}
.glyphicon-wrench:before {
  content: "\e136";
}
.glyphicon-tasks:before {
  content: "\e137";
}
.glyphicon-filter:before {
  content: "\e138";
}
.glyphicon-briefcase:before {
  content: "\e139";
}
.glyphicon-fullscreen:before {
  content: "\e140";
}
.glyphicon-dashboard:before {
  content: "\e141";
}
.glyphicon-paperclip:before {
  content: "\e142";
}
.glyphicon-heart-empty:before {
  content: "\e143";
}
.glyphicon-link:before {
  content: "\e144";
}
.glyphicon-phone:before {
  content: "\e145";
}
.glyphicon-pushpin:before {
  content: "\e146";
}
.glyphicon-usd:before {
  content: "\e148";
}
.glyphicon-gbp:before {
  content: "\e149";
}
.glyphicon-sort:before {
  content: "\e150";
}
.glyphicon-sort-by-alphabet:before {
  content: "\e151";
}
.glyphicon-sort-by-alphabet-alt:before {
  content: "\e152";
}
.glyphicon-sort-by-order:before {
  content: "\e153";
}
.glyphicon-sort-by-order-alt:before {
  content: "\e154";
}
.glyphicon-sort-by-attributes:before {
  content: "\e155";
}
.glyphicon-sort-by-attributes-alt:before {
  content: "\e156";
}
.glyphicon-unchecked:before {
  content: "\e157";
}
.glyphicon-expand:before {
  content: "\e158";
}
.glyphicon-collapse-down:before {
  content: "\e159";
}
.glyphicon-collapse-up:before {
  content: "\e160";
}
.glyphicon-log-in:before {
  content: "\e161";
}
.glyphicon-flash:before {
  content: "\e162";
}
.glyphicon-log-out:before {
  content: "\e163";
}
.glyphicon-new-window:before {
  content: "\e164";
}
.glyphicon-record:before {
  content: "\e165";
}
.glyphicon-save:before {
  content: "\e166";
}
.glyphicon-open:before {
  content: "\e167";
}
.glyphicon-saved:before {
  content: "\e168";
}
.glyphicon-import:before {
  content: "\e169";
}
.glyphicon-export:before {
  content: "\e170";
}
.glyphicon-send:before {
  content: "\e171";
}
.glyphicon-floppy-disk:before {
  content: "\e172";
}
.glyphicon-floppy-saved:before {
  content: "\e173";
}
.glyphicon-floppy-remove:before {
  content: "\e174";
}
.glyphicon-floppy-save:before {
  content: "\e175";
}
.glyphicon-floppy-open:before {
  content: "\e176";
}
.glyphicon-credit-card:before {
  content: "\e177";
}
.glyphicon-transfer:before {
  content: "\e178";
}
.glyphicon-cutlery:before {
  content: "\e179";
}
.glyphicon-header:before {
  content: "\e180";
}
.glyphicon-compressed:before {
  content: "\e181";
}
.glyphicon-earphone:before {
  content: "\e182";
}
.glyphicon-phone-alt:before {
  content: "\e183";
}
.glyphicon-tower:before {
  content: "\e184";
}
.glyphicon-stats:before {
  content: "\e185";
}
.glyphicon-sd-video:before {
  content: "\e186";
}
.glyphicon-hd-video:before {
  content: "\e187";
}
.glyphicon-subtitles:before {
  content: "\e188";
}
.glyphicon-sound-stereo:before {
  content: "\e189";
}
.glyphicon-sound-dolby:before {
  content: "\e190";
}
.glyphicon-sound-5-1:before {
  content: "\e191";
}
.glyphicon-sound-6-1:before {
  content: "\e192";
}
.glyphicon-sound-7-1:before {
  content: "\e193";
}
.glyphicon-copyright-mark:before {
  content: "\e194";
}
.glyphicon-registration-mark:before {
  content: "\e195";
}
.glyphicon-cloud-download:before {
  content: "\e197";
}
.glyphicon-cloud-upload:before {
  content: "\e198";
}
.glyphicon-tree-conifer:before {
  content: "\e199";
}
.glyphicon-tree-deciduous:before {
  content: "\e200";
}
.glyphicon-cd:before {
  content: "\e201";
}
.glyphicon-save-file:before {
  content: "\e202";
}
.glyphicon-open-file:before {
  content: "\e203";
}
.glyphicon-level-up:before {
  content: "\e204";
}
.glyphicon-copy:before {
  content: "\e205";
}
.glyphicon-paste:before {
  content: "\e206";
}
.glyphicon-alert:before {
  content: "\e209";
}
.glyphicon-equalizer:before {
  content: "\e210";
}
.glyphicon-king:before {
  content: "\e211";
}
.glyphicon-queen:before {
  content: "\e212";
}
.glyphicon-pawn:before {
  content: "\e213";
}
.glyphicon-bishop:before {
  content: "\e214";
}
.glyphicon-knight:before {
  content: "\e215";
}
.glyphicon-baby-formula:before {
  content: "\e216";
}
.glyphicon-tent:before {
  content: "\26fa";
}
.glyphicon-blackboard:before {
  content: "\e218";
}
.glyphicon-bed:before {
  content: "\e219";
}
.glyphicon-apple:before {
  content: "\f8ff";
}
.glyphicon-erase:before {
  content: "\e221";
}
.glyphicon-hourglass:before {
  content: "\231b";
}
.glyphicon-lamp:before {
  content: "\e223";
}
.glyphicon-duplicate:before {
  content: "\e224";
}
.glyphicon-piggy-bank:before {
  content: "\e225";
}
.glyphicon-scissors:before {
  content: "\e226";
}
.glyphicon-bitcoin:before {
  content: "\e227";
}
.glyphicon-btc:before {
  content: "\e227";
}
.glyphicon-xbt:before {
  content: "\e227";
}
.glyphicon-yen:before {
  content: "\00a5";
}
.glyphicon-jpy:before {
  content: "\00a5";
}
.glyphicon-ruble:before {
  content: "\20bd";
}
.glyphicon-rub:before {
  content: "\20bd";
}
.glyphicon-scale:before {
  content: "\e230";
}
.glyphicon-ice-lolly:before {
  content: "\e231";
}
.glyphicon-ice-lolly-tasted:before {
  content: "\e232";
}
.glyphicon-education:before {
  content: "\e233";
}
.glyphicon-option-horizontal:before {
  content: "\e234";
}
.glyphicon-option-vertical:before {
  content: "\e235";
}
.glyphicon-menu-hamburger:before {
  content: "\e236";
}
.glyphicon-modal-window:before {
  content: "\e237";
}
.glyphicon-oil:before {
  content: "\e238";
}
.glyphicon-grain:before {
  content: "\e239";
}
.glyphicon-sunglasses:before {
  content: "\e240";
}
.glyphicon-text-size:before {
  content: "\e241";
}
.glyphicon-text-color:before {
  content: "\e242";
}
.glyphicon-text-background:before {
  content: "\e243";
}
.glyphicon-object-align-top:before {
  content: "\e244";
}
.glyphicon-object-align-bottom:before {
  content: "\e245";
}
.glyphicon-object-align-horizontal:before {
  content: "\e246";
}
.glyphicon-object-align-left:before {
  content: "\e247";
}
.glyphicon-object-align-vertical:before {
  content: "\e248";
}
.glyphicon-object-align-right:before {
  content: "\e249";
}
.glyphicon-triangle-right:before {
  content: "\e250";
}
.glyphicon-triangle-left:before {
  content: "\e251";
}
.glyphicon-triangle-bottom:before {
  content: "\e252";
}
.glyphicon-triangle-top:before {
  content: "\e253";
}
.glyphicon-console:before {
  content: "\e254";
}
.glyphicon-superscript:before {
  content: "\e255";
}
.glyphicon-subscript:before {
  content: "\e256";
}
.glyphicon-menu-left:before {
  content: "\e257";
}
.glyphicon-menu-right:before {
  content: "\e258";
}
.glyphicon-menu-down:before {
  content: "\e259";
}
.glyphicon-menu-up:before {
  content: "\e260";
}
* {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
*:before,
*:after {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
html {
  font-size: 10px;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}
body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 13px;
  line-height: 1.42857143;
  color: #000;
  background-color: #fff;
}
input,
button,
select,
textarea {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}
a {
  color: #337ab7;
  text-decoration: none;
}
a:hover,
a:focus {
  color: #23527c;
  text-decoration: underline;
}
a:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
figure {
  margin: 0;
}
img {
  vertical-align: middle;
}
.img-responsive,
.thumbnail > img,
.thumbnail a > img,
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  display: block;
  max-width: 100%;
  height: auto;
}
.img-rounded {
  border-radius: 3px;
}
.img-thumbnail {
  padding: 4px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: all 0.2s ease-in-out;
  -o-transition: all 0.2s ease-in-out;
  transition: all 0.2s ease-in-out;
  display: inline-block;
  max-width: 100%;
  height: auto;
}
.img-circle {
  border-radius: 50%;
}
hr {
  margin-top: 18px;
  margin-bottom: 18px;
  border: 0;
  border-top: 1px solid #eeeeee;
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: -1px;
  padding: 0;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
[role="button"] {
  cursor: pointer;
}
h1,
h2,
h3,
h4,
h5,
h6,
.h1,
.h2,
.h3,
.h4,
.h5,
.h6 {
  font-family: inherit;
  font-weight: 500;
  line-height: 1.1;
  color: inherit;
}
h1 small,
h2 small,
h3 small,
h4 small,
h5 small,
h6 small,
.h1 small,
.h2 small,
.h3 small,
.h4 small,
.h5 small,
.h6 small,
h1 .small,
h2 .small,
h3 .small,
h4 .small,
h5 .small,
h6 .small,
.h1 .small,
.h2 .small,
.h3 .small,
.h4 .small,
.h5 .small,
.h6 .small {
  font-weight: normal;
  line-height: 1;
  color: #777777;
}
h1,
.h1,
h2,
.h2,
h3,
.h3 {
  margin-top: 18px;
  margin-bottom: 9px;
}
h1 small,
.h1 small,
h2 small,
.h2 small,
h3 small,
.h3 small,
h1 .small,
.h1 .small,
h2 .small,
.h2 .small,
h3 .small,
.h3 .small {
  font-size: 65%;
}
h4,
.h4,
h5,
.h5,
h6,
.h6 {
  margin-top: 9px;
  margin-bottom: 9px;
}
h4 small,
.h4 small,
h5 small,
.h5 small,
h6 small,
.h6 small,
h4 .small,
.h4 .small,
h5 .small,
.h5 .small,
h6 .small,
.h6 .small {
  font-size: 75%;
}
h1,
.h1 {
  font-size: 33px;
}
h2,
.h2 {
  font-size: 27px;
}
h3,
.h3 {
  font-size: 23px;
}
h4,
.h4 {
  font-size: 17px;
}
h5,
.h5 {
  font-size: 13px;
}
h6,
.h6 {
  font-size: 12px;
}
p {
  margin: 0 0 9px;
}
.lead {
  margin-bottom: 18px;
  font-size: 14px;
  font-weight: 300;
  line-height: 1.4;
}
@media (min-width: 768px) {
  .lead {
    font-size: 19.5px;
  }
}
small,
.small {
  font-size: 92%;
}
mark,
.mark {
  background-color: #fcf8e3;
  padding: .2em;
}
.text-left {
  text-align: left;
}
.text-right {
  text-align: right;
}
.text-center {
  text-align: center;
}
.text-justify {
  text-align: justify;
}
.text-nowrap {
  white-space: nowrap;
}
.text-lowercase {
  text-transform: lowercase;
}
.text-uppercase {
  text-transform: uppercase;
}
.text-capitalize {
  text-transform: capitalize;
}
.text-muted {
  color: #777777;
}
.text-primary {
  color: #337ab7;
}
a.text-primary:hover,
a.text-primary:focus {
  color: #286090;
}
.text-success {
  color: #3c763d;
}
a.text-success:hover,
a.text-success:focus {
  color: #2b542c;
}
.text-info {
  color: #31708f;
}
a.text-info:hover,
a.text-info:focus {
  color: #245269;
}
.text-warning {
  color: #8a6d3b;
}
a.text-warning:hover,
a.text-warning:focus {
  color: #66512c;
}
.text-danger {
  color: #a94442;
}
a.text-danger:hover,
a.text-danger:focus {
  color: #843534;
}
.bg-primary {
  color: #fff;
  background-color: #337ab7;
}
a.bg-primary:hover,
a.bg-primary:focus {
  background-color: #286090;
}
.bg-success {
  background-color: #dff0d8;
}
a.bg-success:hover,
a.bg-success:focus {
  background-color: #c1e2b3;
}
.bg-info {
  background-color: #d9edf7;
}
a.bg-info:hover,
a.bg-info:focus {
  background-color: #afd9ee;
}
.bg-warning {
  background-color: #fcf8e3;
}
a.bg-warning:hover,
a.bg-warning:focus {
  background-color: #f7ecb5;
}
.bg-danger {
  background-color: #f2dede;
}
a.bg-danger:hover,
a.bg-danger:focus {
  background-color: #e4b9b9;
}
.page-header {
  padding-bottom: 8px;
  margin: 36px 0 18px;
  border-bottom: 1px solid #eeeeee;
}
ul,
ol {
  margin-top: 0;
  margin-bottom: 9px;
}
ul ul,
ol ul,
ul ol,
ol ol {
  margin-bottom: 0;
}
.list-unstyled {
  padding-left: 0;
  list-style: none;
}
.list-inline {
  padding-left: 0;
  list-style: none;
  margin-left: -5px;
}
.list-inline > li {
  display: inline-block;
  padding-left: 5px;
  padding-right: 5px;
}
dl {
  margin-top: 0;
  margin-bottom: 18px;
}
dt,
dd {
  line-height: 1.42857143;
}
dt {
  font-weight: bold;
}
dd {
  margin-left: 0;
}
@media (min-width: 541px) {
  .dl-horizontal dt {
    float: left;
    width: 160px;
    clear: left;
    text-align: right;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .dl-horizontal dd {
    margin-left: 180px;
  }
}
abbr[title],
abbr[data-original-title] {
  cursor: help;
  border-bottom: 1px dotted #777777;
}
.initialism {
  font-size: 90%;
  text-transform: uppercase;
}
blockquote {
  padding: 9px 18px;
  margin: 0 0 18px;
  font-size: inherit;
  border-left: 5px solid #eeeeee;
}
blockquote p:last-child,
blockquote ul:last-child,
blockquote ol:last-child {
  margin-bottom: 0;
}
blockquote footer,
blockquote small,
blockquote .small {
  display: block;
  font-size: 80%;
  line-height: 1.42857143;
  color: #777777;
}
blockquote footer:before,
blockquote small:before,
blockquote .small:before {
  content: '\2014 \00A0';
}
.blockquote-reverse,
blockquote.pull-right {
  padding-right: 15px;
  padding-left: 0;
  border-right: 5px solid #eeeeee;
  border-left: 0;
  text-align: right;
}
.blockquote-reverse footer:before,
blockquote.pull-right footer:before,
.blockquote-reverse small:before,
blockquote.pull-right small:before,
.blockquote-reverse .small:before,
blockquote.pull-right .small:before {
  content: '';
}
.blockquote-reverse footer:after,
blockquote.pull-right footer:after,
.blockquote-reverse small:after,
blockquote.pull-right small:after,
.blockquote-reverse .small:after,
blockquote.pull-right .small:after {
  content: '\00A0 \2014';
}
address {
  margin-bottom: 18px;
  font-style: normal;
  line-height: 1.42857143;
}
code,
kbd,
pre,
samp {
  font-family: monospace;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 2px;
}
kbd {
  padding: 2px 4px;
  font-size: 90%;
  color: #888;
  background-color: transparent;
  border-radius: 1px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
}
kbd kbd {
  padding: 0;
  font-size: 100%;
  font-weight: bold;
  box-shadow: none;
}
pre {
  display: block;
  padding: 8.5px;
  margin: 0 0 9px;
  font-size: 12px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  color: #333333;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 2px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit;
  white-space: pre-wrap;
  background-color: transparent;
  border-radius: 0;
}
.pre-scrollable {
  max-height: 340px;
  overflow-y: scroll;
}
.container {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
@media (min-width: 768px) {
  .container {
    width: 768px;
  }
}
@media (min-width: 992px) {
  .container {
    width: 940px;
  }
}
@media (min-width: 1200px) {
  .container {
    width: 1140px;
  }
}
.container-fluid {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
.row {
  margin-left: 0px;
  margin-right: 0px;
}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 {
  position: relative;
  min-height: 1px;
  padding-left: 0px;
  padding-right: 0px;
}
.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {
  float: left;
}
.col-xs-12 {
  width: 100%;
}
.col-xs-11 {
  width: 91.66666667%;
}
.col-xs-10 {
  width: 83.33333333%;
}
.col-xs-9 {
  width: 75%;
}
.col-xs-8 {
  width: 66.66666667%;
}
.col-xs-7 {
  width: 58.33333333%;
}
.col-xs-6 {
  width: 50%;
}
.col-xs-5 {
  width: 41.66666667%;
}
.col-xs-4 {
  width: 33.33333333%;
}
.col-xs-3 {
  width: 25%;
}
.col-xs-2 {
  width: 16.66666667%;
}
.col-xs-1 {
  width: 8.33333333%;
}
.col-xs-pull-12 {
  right: 100%;
}
.col-xs-pull-11 {
  right: 91.66666667%;
}
.col-xs-pull-10 {
  right: 83.33333333%;
}
.col-xs-pull-9 {
  right: 75%;
}
.col-xs-pull-8 {
  right: 66.66666667%;
}
.col-xs-pull-7 {
  right: 58.33333333%;
}
.col-xs-pull-6 {
  right: 50%;
}
.col-xs-pull-5 {
  right: 41.66666667%;
}
.col-xs-pull-4 {
  right: 33.33333333%;
}
.col-xs-pull-3 {
  right: 25%;
}
.col-xs-pull-2 {
  right: 16.66666667%;
}
.col-xs-pull-1 {
  right: 8.33333333%;
}
.col-xs-pull-0 {
  right: auto;
}
.col-xs-push-12 {
  left: 100%;
}
.col-xs-push-11 {
  left: 91.66666667%;
}
.col-xs-push-10 {
  left: 83.33333333%;
}
.col-xs-push-9 {
  left: 75%;
}
.col-xs-push-8 {
  left: 66.66666667%;
}
.col-xs-push-7 {
  left: 58.33333333%;
}
.col-xs-push-6 {
  left: 50%;
}
.col-xs-push-5 {
  left: 41.66666667%;
}
.col-xs-push-4 {
  left: 33.33333333%;
}
.col-xs-push-3 {
  left: 25%;
}
.col-xs-push-2 {
  left: 16.66666667%;
}
.col-xs-push-1 {
  left: 8.33333333%;
}
.col-xs-push-0 {
  left: auto;
}
.col-xs-offset-12 {
  margin-left: 100%;
}
.col-xs-offset-11 {
  margin-left: 91.66666667%;
}
.col-xs-offset-10 {
  margin-left: 83.33333333%;
}
.col-xs-offset-9 {
  margin-left: 75%;
}
.col-xs-offset-8 {
  margin-left: 66.66666667%;
}
.col-xs-offset-7 {
  margin-left: 58.33333333%;
}
.col-xs-offset-6 {
  margin-left: 50%;
}
.col-xs-offset-5 {
  margin-left: 41.66666667%;
}
.col-xs-offset-4 {
  margin-left: 33.33333333%;
}
.col-xs-offset-3 {
  margin-left: 25%;
}
.col-xs-offset-2 {
  margin-left: 16.66666667%;
}
.col-xs-offset-1 {
  margin-left: 8.33333333%;
}
.col-xs-offset-0 {
  margin-left: 0%;
}
@media (min-width: 768px) {
  .col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10, .col-sm-11, .col-sm-12 {
    float: left;
  }
  .col-sm-12 {
    width: 100%;
  }
  .col-sm-11 {
    width: 91.66666667%;
  }
  .col-sm-10 {
    width: 83.33333333%;
  }
  .col-sm-9 {
    width: 75%;
  }
  .col-sm-8 {
    width: 66.66666667%;
  }
  .col-sm-7 {
    width: 58.33333333%;
  }
  .col-sm-6 {
    width: 50%;
  }
  .col-sm-5 {
    width: 41.66666667%;
  }
  .col-sm-4 {
    width: 33.33333333%;
  }
  .col-sm-3 {
    width: 25%;
  }
  .col-sm-2 {
    width: 16.66666667%;
  }
  .col-sm-1 {
    width: 8.33333333%;
  }
  .col-sm-pull-12 {
    right: 100%;
  }
  .col-sm-pull-11 {
    right: 91.66666667%;
  }
  .col-sm-pull-10 {
    right: 83.33333333%;
  }
  .col-sm-pull-9 {
    right: 75%;
  }
  .col-sm-pull-8 {
    right: 66.66666667%;
  }
  .col-sm-pull-7 {
    right: 58.33333333%;
  }
  .col-sm-pull-6 {
    right: 50%;
  }
  .col-sm-pull-5 {
    right: 41.66666667%;
  }
  .col-sm-pull-4 {
    right: 33.33333333%;
  }
  .col-sm-pull-3 {
    right: 25%;
  }
  .col-sm-pull-2 {
    right: 16.66666667%;
  }
  .col-sm-pull-1 {
    right: 8.33333333%;
  }
  .col-sm-pull-0 {
    right: auto;
  }
  .col-sm-push-12 {
    left: 100%;
  }
  .col-sm-push-11 {
    left: 91.66666667%;
  }
  .col-sm-push-10 {
    left: 83.33333333%;
  }
  .col-sm-push-9 {
    left: 75%;
  }
  .col-sm-push-8 {
    left: 66.66666667%;
  }
  .col-sm-push-7 {
    left: 58.33333333%;
  }
  .col-sm-push-6 {
    left: 50%;
  }
  .col-sm-push-5 {
    left: 41.66666667%;
  }
  .col-sm-push-4 {
    left: 33.33333333%;
  }
  .col-sm-push-3 {
    left: 25%;
  }
  .col-sm-push-2 {
    left: 16.66666667%;
  }
  .col-sm-push-1 {
    left: 8.33333333%;
  }
  .col-sm-push-0 {
    left: auto;
  }
  .col-sm-offset-12 {
    margin-left: 100%;
  }
  .col-sm-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-sm-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-sm-offset-9 {
    margin-left: 75%;
  }
  .col-sm-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-sm-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-sm-offset-6 {
    margin-left: 50%;
  }
  .col-sm-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-sm-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-sm-offset-3 {
    margin-left: 25%;
  }
  .col-sm-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-sm-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-sm-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 992px) {
  .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12 {
    float: left;
  }
  .col-md-12 {
    width: 100%;
  }
  .col-md-11 {
    width: 91.66666667%;
  }
  .col-md-10 {
    width: 83.33333333%;
  }
  .col-md-9 {
    width: 75%;
  }
  .col-md-8 {
    width: 66.66666667%;
  }
  .col-md-7 {
    width: 58.33333333%;
  }
  .col-md-6 {
    width: 50%;
  }
  .col-md-5 {
    width: 41.66666667%;
  }
  .col-md-4 {
    width: 33.33333333%;
  }
  .col-md-3 {
    width: 25%;
  }
  .col-md-2 {
    width: 16.66666667%;
  }
  .col-md-1 {
    width: 8.33333333%;
  }
  .col-md-pull-12 {
    right: 100%;
  }
  .col-md-pull-11 {
    right: 91.66666667%;
  }
  .col-md-pull-10 {
    right: 83.33333333%;
  }
  .col-md-pull-9 {
    right: 75%;
  }
  .col-md-pull-8 {
    right: 66.66666667%;
  }
  .col-md-pull-7 {
    right: 58.33333333%;
  }
  .col-md-pull-6 {
    right: 50%;
  }
  .col-md-pull-5 {
    right: 41.66666667%;
  }
  .col-md-pull-4 {
    right: 33.33333333%;
  }
  .col-md-pull-3 {
    right: 25%;
  }
  .col-md-pull-2 {
    right: 16.66666667%;
  }
  .col-md-pull-1 {
    right: 8.33333333%;
  }
  .col-md-pull-0 {
    right: auto;
  }
  .col-md-push-12 {
    left: 100%;
  }
  .col-md-push-11 {
    left: 91.66666667%;
  }
  .col-md-push-10 {
    left: 83.33333333%;
  }
  .col-md-push-9 {
    left: 75%;
  }
  .col-md-push-8 {
    left: 66.66666667%;
  }
  .col-md-push-7 {
    left: 58.33333333%;
  }
  .col-md-push-6 {
    left: 50%;
  }
  .col-md-push-5 {
    left: 41.66666667%;
  }
  .col-md-push-4 {
    left: 33.33333333%;
  }
  .col-md-push-3 {
    left: 25%;
  }
  .col-md-push-2 {
    left: 16.66666667%;
  }
  .col-md-push-1 {
    left: 8.33333333%;
  }
  .col-md-push-0 {
    left: auto;
  }
  .col-md-offset-12 {
    margin-left: 100%;
  }
  .col-md-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-md-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-md-offset-9 {
    margin-left: 75%;
  }
  .col-md-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-md-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-md-offset-6 {
    margin-left: 50%;
  }
  .col-md-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-md-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-md-offset-3 {
    margin-left: 25%;
  }
  .col-md-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-md-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-md-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 1200px) {
  .col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12 {
    float: left;
  }
  .col-lg-12 {
    width: 100%;
  }
  .col-lg-11 {
    width: 91.66666667%;
  }
  .col-lg-10 {
    width: 83.33333333%;
  }
  .col-lg-9 {
    width: 75%;
  }
  .col-lg-8 {
    width: 66.66666667%;
  }
  .col-lg-7 {
    width: 58.33333333%;
  }
  .col-lg-6 {
    width: 50%;
  }
  .col-lg-5 {
    width: 41.66666667%;
  }
  .col-lg-4 {
    width: 33.33333333%;
  }
  .col-lg-3 {
    width: 25%;
  }
  .col-lg-2 {
    width: 16.66666667%;
  }
  .col-lg-1 {
    width: 8.33333333%;
  }
  .col-lg-pull-12 {
    right: 100%;
  }
  .col-lg-pull-11 {
    right: 91.66666667%;
  }
  .col-lg-pull-10 {
    right: 83.33333333%;
  }
  .col-lg-pull-9 {
    right: 75%;
  }
  .col-lg-pull-8 {
    right: 66.66666667%;
  }
  .col-lg-pull-7 {
    right: 58.33333333%;
  }
  .col-lg-pull-6 {
    right: 50%;
  }
  .col-lg-pull-5 {
    right: 41.66666667%;
  }
  .col-lg-pull-4 {
    right: 33.33333333%;
  }
  .col-lg-pull-3 {
    right: 25%;
  }
  .col-lg-pull-2 {
    right: 16.66666667%;
  }
  .col-lg-pull-1 {
    right: 8.33333333%;
  }
  .col-lg-pull-0 {
    right: auto;
  }
  .col-lg-push-12 {
    left: 100%;
  }
  .col-lg-push-11 {
    left: 91.66666667%;
  }
  .col-lg-push-10 {
    left: 83.33333333%;
  }
  .col-lg-push-9 {
    left: 75%;
  }
  .col-lg-push-8 {
    left: 66.66666667%;
  }
  .col-lg-push-7 {
    left: 58.33333333%;
  }
  .col-lg-push-6 {
    left: 50%;
  }
  .col-lg-push-5 {
    left: 41.66666667%;
  }
  .col-lg-push-4 {
    left: 33.33333333%;
  }
  .col-lg-push-3 {
    left: 25%;
  }
  .col-lg-push-2 {
    left: 16.66666667%;
  }
  .col-lg-push-1 {
    left: 8.33333333%;
  }
  .col-lg-push-0 {
    left: auto;
  }
  .col-lg-offset-12 {
    margin-left: 100%;
  }
  .col-lg-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-lg-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-lg-offset-9 {
    margin-left: 75%;
  }
  .col-lg-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-lg-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-lg-offset-6 {
    margin-left: 50%;
  }
  .col-lg-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-lg-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-lg-offset-3 {
    margin-left: 25%;
  }
  .col-lg-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-lg-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-lg-offset-0 {
    margin-left: 0%;
  }
}
table {
  background-color: transparent;
}
caption {
  padding-top: 8px;
  padding-bottom: 8px;
  color: #777777;
  text-align: left;
}
th {
  text-align: left;
}
.table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 18px;
}
.table > thead > tr > th,
.table > tbody > tr > th,
.table > tfoot > tr > th,
.table > thead > tr > td,
.table > tbody > tr > td,
.table > tfoot > tr > td {
  padding: 8px;
  line-height: 1.42857143;
  vertical-align: top;
  border-top: 1px solid #ddd;
}
.table > thead > tr > th {
  vertical-align: bottom;
  border-bottom: 2px solid #ddd;
}
.table > caption + thead > tr:first-child > th,
.table > colgroup + thead > tr:first-child > th,
.table > thead:first-child > tr:first-child > th,
.table > caption + thead > tr:first-child > td,
.table > colgroup + thead > tr:first-child > td,
.table > thead:first-child > tr:first-child > td {
  border-top: 0;
}
.table > tbody + tbody {
  border-top: 2px solid #ddd;
}
.table .table {
  background-color: #fff;
}
.table-condensed > thead > tr > th,
.table-condensed > tbody > tr > th,
.table-condensed > tfoot > tr > th,
.table-condensed > thead > tr > td,
.table-condensed > tbody > tr > td,
.table-condensed > tfoot > tr > td {
  padding: 5px;
}
.table-bordered {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > tbody > tr > th,
.table-bordered > tfoot > tr > th,
.table-bordered > thead > tr > td,
.table-bordered > tbody > tr > td,
.table-bordered > tfoot > tr > td {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > thead > tr > td {
  border-bottom-width: 2px;
}
.table-striped > tbody > tr:nth-of-type(odd) {
  background-color: #f9f9f9;
}
.table-hover > tbody > tr:hover {
  background-color: #f5f5f5;
}
table col[class*="col-"] {
  position: static;
  float: none;
  display: table-column;
}
table td[class*="col-"],
table th[class*="col-"] {
  position: static;
  float: none;
  display: table-cell;
}
.table > thead > tr > td.active,
.table > tbody > tr > td.active,
.table > tfoot > tr > td.active,
.table > thead > tr > th.active,
.table > tbody > tr > th.active,
.table > tfoot > tr > th.active,
.table > thead > tr.active > td,
.table > tbody > tr.active > td,
.table > tfoot > tr.active > td,
.table > thead > tr.active > th,
.table > tbody > tr.active > th,
.table > tfoot > tr.active > th {
  background-color: #f5f5f5;
}
.table-hover > tbody > tr > td.active:hover,
.table-hover > tbody > tr > th.active:hover,
.table-hover > tbody > tr.active:hover > td,
.table-hover > tbody > tr:hover > .active,
.table-hover > tbody > tr.active:hover > th {
  background-color: #e8e8e8;
}
.table > thead > tr > td.success,
.table > tbody > tr > td.success,
.table > tfoot > tr > td.success,
.table > thead > tr > th.success,
.table > tbody > tr > th.success,
.table > tfoot > tr > th.success,
.table > thead > tr.success > td,
.table > tbody > tr.success > td,
.table > tfoot > tr.success > td,
.table > thead > tr.success > th,
.table > tbody > tr.success > th,
.table > tfoot > tr.success > th {
  background-color: #dff0d8;
}
.table-hover > tbody > tr > td.success:hover,
.table-hover > tbody > tr > th.success:hover,
.table-hover > tbody > tr.success:hover > td,
.table-hover > tbody > tr:hover > .success,
.table-hover > tbody > tr.success:hover > th {
  background-color: #d0e9c6;
}
.table > thead > tr > td.info,
.table > tbody > tr > td.info,
.table > tfoot > tr > td.info,
.table > thead > tr > th.info,
.table > tbody > tr > th.info,
.table > tfoot > tr > th.info,
.table > thead > tr.info > td,
.table > tbody > tr.info > td,
.table > tfoot > tr.info > td,
.table > thead > tr.info > th,
.table > tbody > tr.info > th,
.table > tfoot > tr.info > th {
  background-color: #d9edf7;
}
.table-hover > tbody > tr > td.info:hover,
.table-hover > tbody > tr > th.info:hover,
.table-hover > tbody > tr.info:hover > td,
.table-hover > tbody > tr:hover > .info,
.table-hover > tbody > tr.info:hover > th {
  background-color: #c4e3f3;
}
.table > thead > tr > td.warning,
.table > tbody > tr > td.warning,
.table > tfoot > tr > td.warning,
.table > thead > tr > th.warning,
.table > tbody > tr > th.warning,
.table > tfoot > tr > th.warning,
.table > thead > tr.warning > td,
.table > tbody > tr.warning > td,
.table > tfoot > tr.warning > td,
.table > thead > tr.warning > th,
.table > tbody > tr.warning > th,
.table > tfoot > tr.warning > th {
  background-color: #fcf8e3;
}
.table-hover > tbody > tr > td.warning:hover,
.table-hover > tbody > tr > th.warning:hover,
.table-hover > tbody > tr.warning:hover > td,
.table-hover > tbody > tr:hover > .warning,
.table-hover > tbody > tr.warning:hover > th {
  background-color: #faf2cc;
}
.table > thead > tr > td.danger,
.table > tbody > tr > td.danger,
.table > tfoot > tr > td.danger,
.table > thead > tr > th.danger,
.table > tbody > tr > th.danger,
.table > tfoot > tr > th.danger,
.table > thead > tr.danger > td,
.table > tbody > tr.danger > td,
.table > tfoot > tr.danger > td,
.table > thead > tr.danger > th,
.table > tbody > tr.danger > th,
.table > tfoot > tr.danger > th {
  background-color: #f2dede;
}
.table-hover > tbody > tr > td.danger:hover,
.table-hover > tbody > tr > th.danger:hover,
.table-hover > tbody > tr.danger:hover > td,
.table-hover > tbody > tr:hover > .danger,
.table-hover > tbody > tr.danger:hover > th {
  background-color: #ebcccc;
}
.table-responsive {
  overflow-x: auto;
  min-height: 0.01%;
}
@media screen and (max-width: 767px) {
  .table-responsive {
    width: 100%;
    margin-bottom: 13.5px;
    overflow-y: hidden;
    -ms-overflow-style: -ms-autohiding-scrollbar;
    border: 1px solid #ddd;
  }
  .table-responsive > .table {
    margin-bottom: 0;
  }
  .table-responsive > .table > thead > tr > th,
  .table-responsive > .table > tbody > tr > th,
  .table-responsive > .table > tfoot > tr > th,
  .table-responsive > .table > thead > tr > td,
  .table-responsive > .table > tbody > tr > td,
  .table-responsive > .table > tfoot > tr > td {
    white-space: nowrap;
  }
  .table-responsive > .table-bordered {
    border: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:first-child,
  .table-responsive > .table-bordered > tbody > tr > th:first-child,
  .table-responsive > .table-bordered > tfoot > tr > th:first-child,
  .table-responsive > .table-bordered > thead > tr > td:first-child,
  .table-responsive > .table-bordered > tbody > tr > td:first-child,
  .table-responsive > .table-bordered > tfoot > tr > td:first-child {
    border-left: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:last-child,
  .table-responsive > .table-bordered > tbody > tr > th:last-child,
  .table-responsive > .table-bordered > tfoot > tr > th:last-child,
  .table-responsive > .table-bordered > thead > tr > td:last-child,
  .table-responsive > .table-bordered > tbody > tr > td:last-child,
  .table-responsive > .table-bordered > tfoot > tr > td:last-child {
    border-right: 0;
  }
  .table-responsive > .table-bordered > tbody > tr:last-child > th,
  .table-responsive > .table-bordered > tfoot > tr:last-child > th,
  .table-responsive > .table-bordered > tbody > tr:last-child > td,
  .table-responsive > .table-bordered > tfoot > tr:last-child > td {
    border-bottom: 0;
  }
}
fieldset {
  padding: 0;
  margin: 0;
  border: 0;
  min-width: 0;
}
legend {
  display: block;
  width: 100%;
  padding: 0;
  margin-bottom: 18px;
  font-size: 19.5px;
  line-height: inherit;
  color: #333333;
  border: 0;
  border-bottom: 1px solid #e5e5e5;
}
label {
  display: inline-block;
  max-width: 100%;
  margin-bottom: 5px;
  font-weight: bold;
}
input[type="search"] {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
input[type="radio"],
input[type="checkbox"] {
  margin: 4px 0 0;
  margin-top: 1px \9;
  line-height: normal;
}
input[type="file"] {
  display: block;
}
input[type="range"] {
  display: block;
  width: 100%;
}
select[multiple],
select[size] {
  height: auto;
}
input[type="file"]:focus,
input[type="radio"]:focus,
input[type="checkbox"]:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
output {
  display: block;
  padding-top: 7px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
}
.form-control {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
}
.form-control:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.form-control::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.form-control:-ms-input-placeholder {
  color: #999;
}
.form-control::-webkit-input-placeholder {
  color: #999;
}
.form-control::-ms-expand {
  border: 0;
  background-color: transparent;
}
.form-control[disabled],
.form-control[readonly],
fieldset[disabled] .form-control {
  background-color: #eeeeee;
  opacity: 1;
}
.form-control[disabled],
fieldset[disabled] .form-control {
  cursor: not-allowed;
}
textarea.form-control {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: none;
}
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  input[type="date"].form-control,
  input[type="time"].form-control,
  input[type="datetime-local"].form-control,
  input[type="month"].form-control {
    line-height: 32px;
  }
  input[type="date"].input-sm,
  input[type="time"].input-sm,
  input[type="datetime-local"].input-sm,
  input[type="month"].input-sm,
  .input-group-sm input[type="date"],
  .input-group-sm input[type="time"],
  .input-group-sm input[type="datetime-local"],
  .input-group-sm input[type="month"] {
    line-height: 30px;
  }
  input[type="date"].input-lg,
  input[type="time"].input-lg,
  input[type="datetime-local"].input-lg,
  input[type="month"].input-lg,
  .input-group-lg input[type="date"],
  .input-group-lg input[type="time"],
  .input-group-lg input[type="datetime-local"],
  .input-group-lg input[type="month"] {
    line-height: 45px;
  }
}
.form-group {
  margin-bottom: 15px;
}
.radio,
.checkbox {
  position: relative;
  display: block;
  margin-top: 10px;
  margin-bottom: 10px;
}
.radio label,
.checkbox label {
  min-height: 18px;
  padding-left: 20px;
  margin-bottom: 0;
  font-weight: normal;
  cursor: pointer;
}
.radio input[type="radio"],
.radio-inline input[type="radio"],
.checkbox input[type="checkbox"],
.checkbox-inline input[type="checkbox"] {
  position: absolute;
  margin-left: -20px;
  margin-top: 4px \9;
}
.radio + .radio,
.checkbox + .checkbox {
  margin-top: -5px;
}
.radio-inline,
.checkbox-inline {
  position: relative;
  display: inline-block;
  padding-left: 20px;
  margin-bottom: 0;
  vertical-align: middle;
  font-weight: normal;
  cursor: pointer;
}
.radio-inline + .radio-inline,
.checkbox-inline + .checkbox-inline {
  margin-top: 0;
  margin-left: 10px;
}
input[type="radio"][disabled],
input[type="checkbox"][disabled],
input[type="radio"].disabled,
input[type="checkbox"].disabled,
fieldset[disabled] input[type="radio"],
fieldset[disabled] input[type="checkbox"] {
  cursor: not-allowed;
}
.radio-inline.disabled,
.checkbox-inline.disabled,
fieldset[disabled] .radio-inline,
fieldset[disabled] .checkbox-inline {
  cursor: not-allowed;
}
.radio.disabled label,
.checkbox.disabled label,
fieldset[disabled] .radio label,
fieldset[disabled] .checkbox label {
  cursor: not-allowed;
}
.form-control-static {
  padding-top: 7px;
  padding-bottom: 7px;
  margin-bottom: 0;
  min-height: 31px;
}
.form-control-static.input-lg,
.form-control-static.input-sm {
  padding-left: 0;
  padding-right: 0;
}
.input-sm {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-sm {
  height: 30px;
  line-height: 30px;
}
textarea.input-sm,
select[multiple].input-sm {
  height: auto;
}
.form-group-sm .form-control {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.form-group-sm select.form-control {
  height: 30px;
  line-height: 30px;
}
.form-group-sm textarea.form-control,
.form-group-sm select[multiple].form-control {
  height: auto;
}
.form-group-sm .form-control-static {
  height: 30px;
  min-height: 30px;
  padding: 6px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.input-lg {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-lg {
  height: 45px;
  line-height: 45px;
}
textarea.input-lg,
select[multiple].input-lg {
  height: auto;
}
.form-group-lg .form-control {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.form-group-lg select.form-control {
  height: 45px;
  line-height: 45px;
}
.form-group-lg textarea.form-control,
.form-group-lg select[multiple].form-control {
  height: auto;
}
.form-group-lg .form-control-static {
  height: 45px;
  min-height: 35px;
  padding: 11px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.has-feedback {
  position: relative;
}
.has-feedback .form-control {
  padding-right: 40px;
}
.form-control-feedback {
  position: absolute;
  top: 0;
  right: 0;
  z-index: 2;
  display: block;
  width: 32px;
  height: 32px;
  line-height: 32px;
  text-align: center;
  pointer-events: none;
}
.input-lg + .form-control-feedback,
.input-group-lg + .form-control-feedback,
.form-group-lg .form-control + .form-control-feedback {
  width: 45px;
  height: 45px;
  line-height: 45px;
}
.input-sm + .form-control-feedback,
.input-group-sm + .form-control-feedback,
.form-group-sm .form-control + .form-control-feedback {
  width: 30px;
  height: 30px;
  line-height: 30px;
}
.has-success .help-block,
.has-success .control-label,
.has-success .radio,
.has-success .checkbox,
.has-success .radio-inline,
.has-success .checkbox-inline,
.has-success.radio label,
.has-success.checkbox label,
.has-success.radio-inline label,
.has-success.checkbox-inline label {
  color: #3c763d;
}
.has-success .form-control {
  border-color: #3c763d;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-success .form-control:focus {
  border-color: #2b542c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
}
.has-success .input-group-addon {
  color: #3c763d;
  border-color: #3c763d;
  background-color: #dff0d8;
}
.has-success .form-control-feedback {
  color: #3c763d;
}
.has-warning .help-block,
.has-warning .control-label,
.has-warning .radio,
.has-warning .checkbox,
.has-warning .radio-inline,
.has-warning .checkbox-inline,
.has-warning.radio label,
.has-warning.checkbox label,
.has-warning.radio-inline label,
.has-warning.checkbox-inline label {
  color: #8a6d3b;
}
.has-warning .form-control {
  border-color: #8a6d3b;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-warning .form-control:focus {
  border-color: #66512c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
}
.has-warning .input-group-addon {
  color: #8a6d3b;
  border-color: #8a6d3b;
  background-color: #fcf8e3;
}
.has-warning .form-control-feedback {
  color: #8a6d3b;
}
.has-error .help-block,
.has-error .control-label,
.has-error .radio,
.has-error .checkbox,
.has-error .radio-inline,
.has-error .checkbox-inline,
.has-error.radio label,
.has-error.checkbox label,
.has-error.radio-inline label,
.has-error.checkbox-inline label {
  color: #a94442;
}
.has-error .form-control {
  border-color: #a94442;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-error .form-control:focus {
  border-color: #843534;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
}
.has-error .input-group-addon {
  color: #a94442;
  border-color: #a94442;
  background-color: #f2dede;
}
.has-error .form-control-feedback {
  color: #a94442;
}
.has-feedback label ~ .form-control-feedback {
  top: 23px;
}
.has-feedback label.sr-only ~ .form-control-feedback {
  top: 0;
}
.help-block {
  display: block;
  margin-top: 5px;
  margin-bottom: 10px;
  color: #404040;
}
@media (min-width: 768px) {
  .form-inline .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .form-inline .form-control-static {
    display: inline-block;
  }
  .form-inline .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .form-inline .input-group .input-group-addon,
  .form-inline .input-group .input-group-btn,
  .form-inline .input-group .form-control {
    width: auto;
  }
  .form-inline .input-group > .form-control {
    width: 100%;
  }
  .form-inline .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio,
  .form-inline .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio label,
  .form-inline .checkbox label {
    padding-left: 0;
  }
  .form-inline .radio input[type="radio"],
  .form-inline .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .form-inline .has-feedback .form-control-feedback {
    top: 0;
  }
}
.form-horizontal .radio,
.form-horizontal .checkbox,
.form-horizontal .radio-inline,
.form-horizontal .checkbox-inline {
  margin-top: 0;
  margin-bottom: 0;
  padding-top: 7px;
}
.form-horizontal .radio,
.form-horizontal .checkbox {
  min-height: 25px;
}
.form-horizontal .form-group {
  margin-left: 0px;
  margin-right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .control-label {
    text-align: right;
    margin-bottom: 0;
    padding-top: 7px;
  }
}
.form-horizontal .has-feedback .form-control-feedback {
  right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .form-group-lg .control-label {
    padding-top: 11px;
    font-size: 17px;
  }
}
@media (min-width: 768px) {
  .form-horizontal .form-group-sm .control-label {
    padding-top: 6px;
    font-size: 12px;
  }
}
.btn {
  display: inline-block;
  margin-bottom: 0;
  font-weight: normal;
  text-align: center;
  vertical-align: middle;
  touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  white-space: nowrap;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  border-radius: 2px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #333;
  text-decoration: none;
}
.btn:active,
.btn.active {
  outline: 0;
  background-image: none;
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  opacity: 0.65;
  filter: alpha(opacity=65);
  -webkit-box-shadow: none;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.btn-default:focus,
.btn-default.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.btn-default:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active:hover,
.btn-default.active:hover,
.open > .dropdown-toggle.btn-default:hover,
.btn-default:active:focus,
.btn-default.active:focus,
.open > .dropdown-toggle.btn-default:focus,
.btn-default:active.focus,
.btn-default.active.focus,
.open > .dropdown-toggle.btn-default.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  background-image: none;
}
.btn-default.disabled:hover,
.btn-default[disabled]:hover,
fieldset[disabled] .btn-default:hover,
.btn-default.disabled:focus,
.btn-default[disabled]:focus,
fieldset[disabled] .btn-default:focus,
.btn-default.disabled.focus,
.btn-default[disabled].focus,
fieldset[disabled] .btn-default.focus {
  background-color: #fff;
  border-color: #ccc;
}
.btn-default .badge {
  color: #fff;
  background-color: #333;
}
.btn-primary {
  color: #fff;
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary:focus,
.btn-primary.focus {
  color: #fff;
  background-color: #286090;
  border-color: #122b40;
}
.btn-primary:hover {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active:hover,
.btn-primary.active:hover,
.open > .dropdown-toggle.btn-primary:hover,
.btn-primary:active:focus,
.btn-primary.active:focus,
.open > .dropdown-toggle.btn-primary:focus,
.btn-primary:active.focus,
.btn-primary.active.focus,
.open > .dropdown-toggle.btn-primary.focus {
  color: #fff;
  background-color: #204d74;
  border-color: #122b40;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  background-image: none;
}
.btn-primary.disabled:hover,
.btn-primary[disabled]:hover,
fieldset[disabled] .btn-primary:hover,
.btn-primary.disabled:focus,
.btn-primary[disabled]:focus,
fieldset[disabled] .btn-primary:focus,
.btn-primary.disabled.focus,
.btn-primary[disabled].focus,
fieldset[disabled] .btn-primary.focus {
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary .badge {
  color: #337ab7;
  background-color: #fff;
}
.btn-success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success:focus,
.btn-success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.btn-success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active:hover,
.btn-success.active:hover,
.open > .dropdown-toggle.btn-success:hover,
.btn-success:active:focus,
.btn-success.active:focus,
.open > .dropdown-toggle.btn-success:focus,
.btn-success:active.focus,
.btn-success.active.focus,
.open > .dropdown-toggle.btn-success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  background-image: none;
}
.btn-success.disabled:hover,
.btn-success[disabled]:hover,
fieldset[disabled] .btn-success:hover,
.btn-success.disabled:focus,
.btn-success[disabled]:focus,
fieldset[disabled] .btn-success:focus,
.btn-success.disabled.focus,
.btn-success[disabled].focus,
fieldset[disabled] .btn-success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.btn-info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info:focus,
.btn-info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.btn-info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active:hover,
.btn-info.active:hover,
.open > .dropdown-toggle.btn-info:hover,
.btn-info:active:focus,
.btn-info.active:focus,
.open > .dropdown-toggle.btn-info:focus,
.btn-info:active.focus,
.btn-info.active.focus,
.open > .dropdown-toggle.btn-info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  background-image: none;
}
.btn-info.disabled:hover,
.btn-info[disabled]:hover,
fieldset[disabled] .btn-info:hover,
.btn-info.disabled:focus,
.btn-info[disabled]:focus,
fieldset[disabled] .btn-info:focus,
.btn-info.disabled.focus,
.btn-info[disabled].focus,
fieldset[disabled] .btn-info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.btn-warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning:focus,
.btn-warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.btn-warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active:hover,
.btn-warning.active:hover,
.open > .dropdown-toggle.btn-warning:hover,
.btn-warning:active:focus,
.btn-warning.active:focus,
.open > .dropdown-toggle.btn-warning:focus,
.btn-warning:active.focus,
.btn-warning.active.focus,
.open > .dropdown-toggle.btn-warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  background-image: none;
}
.btn-warning.disabled:hover,
.btn-warning[disabled]:hover,
fieldset[disabled] .btn-warning:hover,
.btn-warning.disabled:focus,
.btn-warning[disabled]:focus,
fieldset[disabled] .btn-warning:focus,
.btn-warning.disabled.focus,
.btn-warning[disabled].focus,
fieldset[disabled] .btn-warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.btn-danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger:focus,
.btn-danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.btn-danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active:hover,
.btn-danger.active:hover,
.open > .dropdown-toggle.btn-danger:hover,
.btn-danger:active:focus,
.btn-danger.active:focus,
.open > .dropdown-toggle.btn-danger:focus,
.btn-danger:active.focus,
.btn-danger.active.focus,
.open > .dropdown-toggle.btn-danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  background-image: none;
}
.btn-danger.disabled:hover,
.btn-danger[disabled]:hover,
fieldset[disabled] .btn-danger:hover,
.btn-danger.disabled:focus,
.btn-danger[disabled]:focus,
fieldset[disabled] .btn-danger:focus,
.btn-danger.disabled.focus,
.btn-danger[disabled].focus,
fieldset[disabled] .btn-danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger .badge {
  color: #d9534f;
  background-color: #fff;
}
.btn-link {
  color: #337ab7;
  font-weight: normal;
  border-radius: 0;
}
.btn-link,
.btn-link:active,
.btn-link.active,
.btn-link[disabled],
fieldset[disabled] .btn-link {
  background-color: transparent;
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn-link,
.btn-link:hover,
.btn-link:focus,
.btn-link:active {
  border-color: transparent;
}
.btn-link:hover,
.btn-link:focus {
  color: #23527c;
  text-decoration: underline;
  background-color: transparent;
}
.btn-link[disabled]:hover,
fieldset[disabled] .btn-link:hover,
.btn-link[disabled]:focus,
fieldset[disabled] .btn-link:focus {
  color: #777777;
  text-decoration: none;
}
.btn-lg,
.btn-group-lg > .btn {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.btn-sm,
.btn-group-sm > .btn {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-xs,
.btn-group-xs > .btn {
  padding: 1px 5px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-block {
  display: block;
  width: 100%;
}
.btn-block + .btn-block {
  margin-top: 5px;
}
input[type="submit"].btn-block,
input[type="reset"].btn-block,
input[type="button"].btn-block {
  width: 100%;
}
.fade {
  opacity: 0;
  -webkit-transition: opacity 0.15s linear;
  -o-transition: opacity 0.15s linear;
  transition: opacity 0.15s linear;
}
.fade.in {
  opacity: 1;
}
.collapse {
  display: none;
}
.collapse.in {
  display: block;
}
tr.collapse.in {
  display: table-row;
}
tbody.collapse.in {
  display: table-row-group;
}
.collapsing {
  position: relative;
  height: 0;
  overflow: hidden;
  -webkit-transition-property: height, visibility;
  transition-property: height, visibility;
  -webkit-transition-duration: 0.35s;
  transition-duration: 0.35s;
  -webkit-transition-timing-function: ease;
  transition-timing-function: ease;
}
.caret {
  display: inline-block;
  width: 0;
  height: 0;
  margin-left: 2px;
  vertical-align: middle;
  border-top: 4px dashed;
  border-top: 4px solid \9;
  border-right: 4px solid transparent;
  border-left: 4px solid transparent;
}
.dropup,
.dropdown {
  position: relative;
}
.dropdown-toggle:focus {
  outline: 0;
}
.dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  display: none;
  float: left;
  min-width: 160px;
  padding: 5px 0;
  margin: 2px 0 0;
  list-style: none;
  font-size: 13px;
  text-align: left;
  background-color: #fff;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  background-clip: padding-box;
}
.dropdown-menu.pull-right {
  right: 0;
  left: auto;
}
.dropdown-menu .divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: normal;
  line-height: 1.42857143;
  color: #333333;
  white-space: nowrap;
}
.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  text-decoration: none;
  color: #262626;
  background-color: #f5f5f5;
}
.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #fff;
  text-decoration: none;
  outline: 0;
  background-color: #337ab7;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #777777;
}
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
  cursor: not-allowed;
}
.open > .dropdown-menu {
  display: block;
}
.open > a {
  outline: 0;
}
.dropdown-menu-right {
  left: auto;
  right: 0;
}
.dropdown-menu-left {
  left: 0;
  right: auto;
}
.dropdown-header {
  display: block;
  padding: 3px 20px;
  font-size: 12px;
  line-height: 1.42857143;
  color: #777777;
  white-space: nowrap;
}
.dropdown-backdrop {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  z-index: 990;
}
.pull-right > .dropdown-menu {
  right: 0;
  left: auto;
}
.dropup .caret,
.navbar-fixed-bottom .dropdown .caret {
  border-top: 0;
  border-bottom: 4px dashed;
  border-bottom: 4px solid \9;
  content: "";
}
.dropup .dropdown-menu,
.navbar-fixed-bottom .dropdown .dropdown-menu {
  top: auto;
  bottom: 100%;
  margin-bottom: 2px;
}
@media (min-width: 541px) {
  .navbar-right .dropdown-menu {
    left: auto;
    right: 0;
  }
  .navbar-right .dropdown-menu-left {
    left: 0;
    right: auto;
  }
}
.btn-group,
.btn-group-vertical {
  position: relative;
  display: inline-block;
  vertical-align: middle;
}
.btn-group > .btn,
.btn-group-vertical > .btn {
  position: relative;
  float: left;
}
.btn-group > .btn:hover,
.btn-group-vertical > .btn:hover,
.btn-group > .btn:focus,
.btn-group-vertical > .btn:focus,
.btn-group > .btn:active,
.btn-group-vertical > .btn:active,
.btn-group > .btn.active,
.btn-group-vertical > .btn.active {
  z-index: 2;
}
.btn-group .btn + .btn,
.btn-group .btn + .btn-group,
.btn-group .btn-group + .btn,
.btn-group .btn-group + .btn-group {
  margin-left: -1px;
}
.btn-toolbar {
  margin-left: -5px;
}
.btn-toolbar .btn,
.btn-toolbar .btn-group,
.btn-toolbar .input-group {
  float: left;
}
.btn-toolbar > .btn,
.btn-toolbar > .btn-group,
.btn-toolbar > .input-group {
  margin-left: 5px;
}
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-left: 8px;
  padding-right: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-left: 12px;
  padding-right: 12px;
}
.btn-group.open .dropdown-toggle {
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn .caret {
  margin-left: 0;
}
.btn-lg .caret {
  border-width: 5px 5px 0;
  border-bottom-width: 0;
}
.dropup .btn-lg .caret {
  border-width: 0 5px 5px;
}
.btn-group-vertical > .btn,
.btn-group-vertical > .btn-group,
.btn-group-vertical > .btn-group > .btn {
  display: block;
  float: none;
  width: 100%;
  max-width: 100%;
}
.btn-group-vertical > .btn-group > .btn {
  float: none;
}
.btn-group-vertical > .btn + .btn,
.btn-group-vertical > .btn + .btn-group,
.btn-group-vertical > .btn-group + .btn,
.btn-group-vertical > .btn-group + .btn-group {
  margin-top: -1px;
  margin-left: 0;
}
.btn-group-vertical > .btn:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.btn-group-vertical > .btn:first-child:not(:last-child) {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn:last-child:not(:first-child) {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
.btn-group-vertical > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.btn-group-justified {
  display: table;
  width: 100%;
  table-layout: fixed;
  border-collapse: separate;
}
.btn-group-justified > .btn,
.btn-group-justified > .btn-group {
  float: none;
  display: table-cell;
  width: 1%;
}
.btn-group-justified > .btn-group .btn {
  width: 100%;
}
.btn-group-justified > .btn-group .dropdown-menu {
  left: auto;
}
[data-toggle="buttons"] > .btn input[type="radio"],
[data-toggle="buttons"] > .btn-group > .btn input[type="radio"],
[data-toggle="buttons"] > .btn input[type="checkbox"],
[data-toggle="buttons"] > .btn-group > .btn input[type="checkbox"] {
  position: absolute;
  clip: rect(0, 0, 0, 0);
  pointer-events: none;
}
.input-group {
  position: relative;
  display: table;
  border-collapse: separate;
}
.input-group[class*="col-"] {
  float: none;
  padding-left: 0;
  padding-right: 0;
}
.input-group .form-control {
  position: relative;
  z-index: 2;
  float: left;
  width: 100%;
  margin-bottom: 0;
}
.input-group .form-control:focus {
  z-index: 3;
}
.input-group-lg > .form-control,
.input-group-lg > .input-group-addon,
.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-group-lg > .form-control,
select.input-group-lg > .input-group-addon,
select.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  line-height: 45px;
}
textarea.input-group-lg > .form-control,
textarea.input-group-lg > .input-group-addon,
textarea.input-group-lg > .input-group-btn > .btn,
select[multiple].input-group-lg > .form-control,
select[multiple].input-group-lg > .input-group-addon,
select[multiple].input-group-lg > .input-group-btn > .btn {
  height: auto;
}
.input-group-sm > .form-control,
.input-group-sm > .input-group-addon,
.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-group-sm > .form-control,
select.input-group-sm > .input-group-addon,
select.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  line-height: 30px;
}
textarea.input-group-sm > .form-control,
textarea.input-group-sm > .input-group-addon,
textarea.input-group-sm > .input-group-btn > .btn,
select[multiple].input-group-sm > .form-control,
select[multiple].input-group-sm > .input-group-addon,
select[multiple].input-group-sm > .input-group-btn > .btn {
  height: auto;
}
.input-group-addon,
.input-group-btn,
.input-group .form-control {
  display: table-cell;
}
.input-group-addon:not(:first-child):not(:last-child),
.input-group-btn:not(:first-child):not(:last-child),
.input-group .form-control:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.input-group-addon,
.input-group-btn {
  width: 1%;
  white-space: nowrap;
  vertical-align: middle;
}
.input-group-addon {
  padding: 6px 12px;
  font-size: 13px;
  font-weight: normal;
  line-height: 1;
  color: #555555;
  text-align: center;
  background-color: #eeeeee;
  border: 1px solid #ccc;
  border-radius: 2px;
}
.input-group-addon.input-sm {
  padding: 5px 10px;
  font-size: 12px;
  border-radius: 1px;
}
.input-group-addon.input-lg {
  padding: 10px 16px;
  font-size: 17px;
  border-radius: 3px;
}
.input-group-addon input[type="radio"],
.input-group-addon input[type="checkbox"] {
  margin-top: 0;
}
.input-group .form-control:first-child,
.input-group-addon:first-child,
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group > .btn,
.input-group-btn:first-child > .dropdown-toggle,
.input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle),
.input-group-btn:last-child > .btn-group:not(:last-child) > .btn {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.input-group-addon:first-child {
  border-right: 0;
}
.input-group .form-control:last-child,
.input-group-addon:last-child,
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group > .btn,
.input-group-btn:last-child > .dropdown-toggle,
.input-group-btn:first-child > .btn:not(:first-child),
.input-group-btn:first-child > .btn-group:not(:first-child) > .btn {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.input-group-addon:last-child {
  border-left: 0;
}
.input-group-btn {
  position: relative;
  font-size: 0;
  white-space: nowrap;
}
.input-group-btn > .btn {
  position: relative;
}
.input-group-btn > .btn + .btn {
  margin-left: -1px;
}
.input-group-btn > .btn:hover,
.input-group-btn > .btn:focus,
.input-group-btn > .btn:active {
  z-index: 2;
}
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group {
  margin-right: -1px;
}
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group {
  z-index: 2;
  margin-left: -1px;
}
.nav {
  margin-bottom: 0;
  padding-left: 0;
  list-style: none;
}
.nav > li {
  position: relative;
  display: block;
}
.nav > li > a {
  position: relative;
  display: block;
  padding: 10px 15px;
}
.nav > li > a:hover,
.nav > li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.nav > li.disabled > a {
  color: #777777;
}
.nav > li.disabled > a:hover,
.nav > li.disabled > a:focus {
  color: #777777;
  text-decoration: none;
  background-color: transparent;
  cursor: not-allowed;
}
.nav .open > a,
.nav .open > a:hover,
.nav .open > a:focus {
  background-color: #eeeeee;
  border-color: #337ab7;
}
.nav .nav-divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.nav > li > a > img {
  max-width: none;
}
.nav-tabs {
  border-bottom: 1px solid #ddd;
}
.nav-tabs > li {
  float: left;
  margin-bottom: -1px;
}
.nav-tabs > li > a {
  margin-right: 2px;
  line-height: 1.42857143;
  border: 1px solid transparent;
  border-radius: 2px 2px 0 0;
}
.nav-tabs > li > a:hover {
  border-color: #eeeeee #eeeeee #ddd;
}
.nav-tabs > li.active > a,
.nav-tabs > li.active > a:hover,
.nav-tabs > li.active > a:focus {
  color: #555555;
  background-color: #fff;
  border: 1px solid #ddd;
  border-bottom-color: transparent;
  cursor: default;
}
.nav-tabs.nav-justified {
  width: 100%;
  border-bottom: 0;
}
.nav-tabs.nav-justified > li {
  float: none;
}
.nav-tabs.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-tabs.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-tabs.nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs.nav-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs.nav-justified > .active > a,
.nav-tabs.nav-justified > .active > a:hover,
.nav-tabs.nav-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs.nav-justified > .active > a,
  .nav-tabs.nav-justified > .active > a:hover,
  .nav-tabs.nav-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.nav-pills > li {
  float: left;
}
.nav-pills > li > a {
  border-radius: 2px;
}
.nav-pills > li + li {
  margin-left: 2px;
}
.nav-pills > li.active > a,
.nav-pills > li.active > a:hover,
.nav-pills > li.active > a:focus {
  color: #fff;
  background-color: #337ab7;
}
.nav-stacked > li {
  float: none;
}
.nav-stacked > li + li {
  margin-top: 2px;
  margin-left: 0;
}
.nav-justified {
  width: 100%;
}
.nav-justified > li {
  float: none;
}
.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs-justified {
  border-bottom: 0;
}
.nav-tabs-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs-justified > .active > a,
.nav-tabs-justified > .active > a:hover,
.nav-tabs-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs-justified > .active > a,
  .nav-tabs-justified > .active > a:hover,
  .nav-tabs-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.tab-content > .tab-pane {
  display: none;
}
.tab-content > .active {
  display: block;
}
.nav-tabs .dropdown-menu {
  margin-top: -1px;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar {
  position: relative;
  min-height: 30px;
  margin-bottom: 18px;
  border: 1px solid transparent;
}
@media (min-width: 541px) {
  .navbar {
    border-radius: 2px;
  }
}
@media (min-width: 541px) {
  .navbar-header {
    float: left;
  }
}
.navbar-collapse {
  overflow-x: visible;
  padding-right: 0px;
  padding-left: 0px;
  border-top: 1px solid transparent;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
  -webkit-overflow-scrolling: touch;
}
.navbar-collapse.in {
  overflow-y: auto;
}
@media (min-width: 541px) {
  .navbar-collapse {
    width: auto;
    border-top: 0;
    box-shadow: none;
  }
  .navbar-collapse.collapse {
    display: block !important;
    height: auto !important;
    padding-bottom: 0;
    overflow: visible !important;
  }
  .navbar-collapse.in {
    overflow-y: visible;
  }
  .navbar-fixed-top .navbar-collapse,
  .navbar-static-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    padding-left: 0;
    padding-right: 0;
  }
}
.navbar-fixed-top .navbar-collapse,
.navbar-fixed-bottom .navbar-collapse {
  max-height: 340px;
}
@media (max-device-width: 540px) and (orientation: landscape) {
  .navbar-fixed-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    max-height: 200px;
  }
}
.container > .navbar-header,
.container-fluid > .navbar-header,
.container > .navbar-collapse,
.container-fluid > .navbar-collapse {
  margin-right: 0px;
  margin-left: 0px;
}
@media (min-width: 541px) {
  .container > .navbar-header,
  .container-fluid > .navbar-header,
  .container > .navbar-collapse,
  .container-fluid > .navbar-collapse {
    margin-right: 0;
    margin-left: 0;
  }
}
.navbar-static-top {
  z-index: 1000;
  border-width: 0 0 1px;
}
@media (min-width: 541px) {
  .navbar-static-top {
    border-radius: 0;
  }
}
.navbar-fixed-top,
.navbar-fixed-bottom {
  position: fixed;
  right: 0;
  left: 0;
  z-index: 1030;
}
@media (min-width: 541px) {
  .navbar-fixed-top,
  .navbar-fixed-bottom {
    border-radius: 0;
  }
}
.navbar-fixed-top {
  top: 0;
  border-width: 0 0 1px;
}
.navbar-fixed-bottom {
  bottom: 0;
  margin-bottom: 0;
  border-width: 1px 0 0;
}
.navbar-brand {
  float: left;
  padding: 6px 0px;
  font-size: 17px;
  line-height: 18px;
  height: 30px;
}
.navbar-brand:hover,
.navbar-brand:focus {
  text-decoration: none;
}
.navbar-brand > img {
  display: block;
}
@media (min-width: 541px) {
  .navbar > .container .navbar-brand,
  .navbar > .container-fluid .navbar-brand {
    margin-left: 0px;
  }
}
.navbar-toggle {
  position: relative;
  float: right;
  margin-right: 0px;
  padding: 9px 10px;
  margin-top: -2px;
  margin-bottom: -2px;
  background-color: transparent;
  background-image: none;
  border: 1px solid transparent;
  border-radius: 2px;
}
.navbar-toggle:focus {
  outline: 0;
}
.navbar-toggle .icon-bar {
  display: block;
  width: 22px;
  height: 2px;
  border-radius: 1px;
}
.navbar-toggle .icon-bar + .icon-bar {
  margin-top: 4px;
}
@media (min-width: 541px) {
  .navbar-toggle {
    display: none;
  }
}
.navbar-nav {
  margin: 3px 0px;
}
.navbar-nav > li > a {
  padding-top: 10px;
  padding-bottom: 10px;
  line-height: 18px;
}
@media (max-width: 540px) {
  .navbar-nav .open .dropdown-menu {
    position: static;
    float: none;
    width: auto;
    margin-top: 0;
    background-color: transparent;
    border: 0;
    box-shadow: none;
  }
  .navbar-nav .open .dropdown-menu > li > a,
  .navbar-nav .open .dropdown-menu .dropdown-header {
    padding: 5px 15px 5px 25px;
  }
  .navbar-nav .open .dropdown-menu > li > a {
    line-height: 18px;
  }
  .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-nav .open .dropdown-menu > li > a:focus {
    background-image: none;
  }
}
@media (min-width: 541px) {
  .navbar-nav {
    float: left;
    margin: 0;
  }
  .navbar-nav > li {
    float: left;
  }
  .navbar-nav > li > a {
    padding-top: 6px;
    padding-bottom: 6px;
  }
}
.navbar-form {
  margin-left: 0px;
  margin-right: 0px;
  padding: 10px 0px;
  border-top: 1px solid transparent;
  border-bottom: 1px solid transparent;
  -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  margin-top: -1px;
  margin-bottom: -1px;
}
@media (min-width: 768px) {
  .navbar-form .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .navbar-form .form-control-static {
    display: inline-block;
  }
  .navbar-form .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .navbar-form .input-group .input-group-addon,
  .navbar-form .input-group .input-group-btn,
  .navbar-form .input-group .form-control {
    width: auto;
  }
  .navbar-form .input-group > .form-control {
    width: 100%;
  }
  .navbar-form .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio,
  .navbar-form .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio label,
  .navbar-form .checkbox label {
    padding-left: 0;
  }
  .navbar-form .radio input[type="radio"],
  .navbar-form .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .navbar-form .has-feedback .form-control-feedback {
    top: 0;
  }
}
@media (max-width: 540px) {
  .navbar-form .form-group {
    margin-bottom: 5px;
  }
  .navbar-form .form-group:last-child {
    margin-bottom: 0;
  }
}
@media (min-width: 541px) {
  .navbar-form {
    width: auto;
    border: 0;
    margin-left: 0;
    margin-right: 0;
    padding-top: 0;
    padding-bottom: 0;
    -webkit-box-shadow: none;
    box-shadow: none;
  }
}
.navbar-nav > li > .dropdown-menu {
  margin-top: 0;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu {
  margin-bottom: 0;
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.navbar-btn {
  margin-top: -1px;
  margin-bottom: -1px;
}
.navbar-btn.btn-sm {
  margin-top: 0px;
  margin-bottom: 0px;
}
.navbar-btn.btn-xs {
  margin-top: 4px;
  margin-bottom: 4px;
}
.navbar-text {
  margin-top: 6px;
  margin-bottom: 6px;
}
@media (min-width: 541px) {
  .navbar-text {
    float: left;
    margin-left: 0px;
    margin-right: 0px;
  }
}
@media (min-width: 541px) {
  .navbar-left {
    float: left !important;
    float: left;
  }
  .navbar-right {
    float: right !important;
    float: right;
    margin-right: 0px;
  }
  .navbar-right ~ .navbar-right {
    margin-right: 0;
  }
}
.navbar-default {
  background-color: #f8f8f8;
  border-color: #e7e7e7;
}
.navbar-default .navbar-brand {
  color: #777;
}
.navbar-default .navbar-brand:hover,
.navbar-default .navbar-brand:focus {
  color: #5e5e5e;
  background-color: transparent;
}
.navbar-default .navbar-text {
  color: #777;
}
.navbar-default .navbar-nav > li > a {
  color: #777;
}
.navbar-default .navbar-nav > li > a:hover,
.navbar-default .navbar-nav > li > a:focus {
  color: #333;
  background-color: transparent;
}
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: #555;
  background-color: #e7e7e7;
}
.navbar-default .navbar-nav > .disabled > a,
.navbar-default .navbar-nav > .disabled > a:hover,
.navbar-default .navbar-nav > .disabled > a:focus {
  color: #ccc;
  background-color: transparent;
}
.navbar-default .navbar-toggle {
  border-color: #ddd;
}
.navbar-default .navbar-toggle:hover,
.navbar-default .navbar-toggle:focus {
  background-color: #ddd;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #888;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #e7e7e7;
}
.navbar-default .navbar-nav > .open > a,
.navbar-default .navbar-nav > .open > a:hover,
.navbar-default .navbar-nav > .open > a:focus {
  background-color: #e7e7e7;
  color: #555;
}
@media (max-width: 540px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #777;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #333;
    background-color: transparent;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #555;
    background-color: #e7e7e7;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #ccc;
    background-color: transparent;
  }
}
.navbar-default .navbar-link {
  color: #777;
}
.navbar-default .navbar-link:hover {
  color: #333;
}
.navbar-default .btn-link {
  color: #777;
}
.navbar-default .btn-link:hover,
.navbar-default .btn-link:focus {
  color: #333;
}
.navbar-default .btn-link[disabled]:hover,
fieldset[disabled] .navbar-default .btn-link:hover,
.navbar-default .btn-link[disabled]:focus,
fieldset[disabled] .navbar-default .btn-link:focus {
  color: #ccc;
}
.navbar-inverse {
  background-color: #222;
  border-color: #080808;
}
.navbar-inverse .navbar-brand {
  color: #9d9d9d;
}
.navbar-inverse .navbar-brand:hover,
.navbar-inverse .navbar-brand:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-text {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a:hover,
.navbar-inverse .navbar-nav > li > a:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-nav > .active > a,
.navbar-inverse .navbar-nav > .active > a:hover,
.navbar-inverse .navbar-nav > .active > a:focus {
  color: #fff;
  background-color: #080808;
}
.navbar-inverse .navbar-nav > .disabled > a,
.navbar-inverse .navbar-nav > .disabled > a:hover,
.navbar-inverse .navbar-nav > .disabled > a:focus {
  color: #444;
  background-color: transparent;
}
.navbar-inverse .navbar-toggle {
  border-color: #333;
}
.navbar-inverse .navbar-toggle:hover,
.navbar-inverse .navbar-toggle:focus {
  background-color: #333;
}
.navbar-inverse .navbar-toggle .icon-bar {
  background-color: #fff;
}
.navbar-inverse .navbar-collapse,
.navbar-inverse .navbar-form {
  border-color: #101010;
}
.navbar-inverse .navbar-nav > .open > a,
.navbar-inverse .navbar-nav > .open > a:hover,
.navbar-inverse .navbar-nav > .open > a:focus {
  background-color: #080808;
  color: #fff;
}
@media (max-width: 540px) {
  .navbar-inverse .navbar-nav .open .dropdown-menu > .dropdown-header {
    border-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu .divider {
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a {
    color: #9d9d9d;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #fff;
    background-color: transparent;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #fff;
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #444;
    background-color: transparent;
  }
}
.navbar-inverse .navbar-link {
  color: #9d9d9d;
}
.navbar-inverse .navbar-link:hover {
  color: #fff;
}
.navbar-inverse .btn-link {
  color: #9d9d9d;
}
.navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link:focus {
  color: #fff;
}
.navbar-inverse .btn-link[disabled]:hover,
fieldset[disabled] .navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link[disabled]:focus,
fieldset[disabled] .navbar-inverse .btn-link:focus {
  color: #444;
}
.breadcrumb {
  padding: 8px 15px;
  margin-bottom: 18px;
  list-style: none;
  background-color: #f5f5f5;
  border-radius: 2px;
}
.breadcrumb > li {
  display: inline-block;
}
.breadcrumb > li + li:before {
  content: "/\00a0";
  padding: 0 5px;
  color: #5e5e5e;
}
.breadcrumb > .active {
  color: #777777;
}
.pagination {
  display: inline-block;
  padding-left: 0;
  margin: 18px 0;
  border-radius: 2px;
}
.pagination > li {
  display: inline;
}
.pagination > li > a,
.pagination > li > span {
  position: relative;
  float: left;
  padding: 6px 12px;
  line-height: 1.42857143;
  text-decoration: none;
  color: #337ab7;
  background-color: #fff;
  border: 1px solid #ddd;
  margin-left: -1px;
}
.pagination > li:first-child > a,
.pagination > li:first-child > span {
  margin-left: 0;
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.pagination > li:last-child > a,
.pagination > li:last-child > span {
  border-bottom-right-radius: 2px;
  border-top-right-radius: 2px;
}
.pagination > li > a:hover,
.pagination > li > span:hover,
.pagination > li > a:focus,
.pagination > li > span:focus {
  z-index: 2;
  color: #23527c;
  background-color: #eeeeee;
  border-color: #ddd;
}
.pagination > .active > a,
.pagination > .active > span,
.pagination > .active > a:hover,
.pagination > .active > span:hover,
.pagination > .active > a:focus,
.pagination > .active > span:focus {
  z-index: 3;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
  cursor: default;
}
.pagination > .disabled > span,
.pagination > .disabled > span:hover,
.pagination > .disabled > span:focus,
.pagination > .disabled > a,
.pagination > .disabled > a:hover,
.pagination > .disabled > a:focus {
  color: #777777;
  background-color: #fff;
  border-color: #ddd;
  cursor: not-allowed;
}
.pagination-lg > li > a,
.pagination-lg > li > span {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.pagination-lg > li:first-child > a,
.pagination-lg > li:first-child > span {
  border-bottom-left-radius: 3px;
  border-top-left-radius: 3px;
}
.pagination-lg > li:last-child > a,
.pagination-lg > li:last-child > span {
  border-bottom-right-radius: 3px;
  border-top-right-radius: 3px;
}
.pagination-sm > li > a,
.pagination-sm > li > span {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.pagination-sm > li:first-child > a,
.pagination-sm > li:first-child > span {
  border-bottom-left-radius: 1px;
  border-top-left-radius: 1px;
}
.pagination-sm > li:last-child > a,
.pagination-sm > li:last-child > span {
  border-bottom-right-radius: 1px;
  border-top-right-radius: 1px;
}
.pager {
  padding-left: 0;
  margin: 18px 0;
  list-style: none;
  text-align: center;
}
.pager li {
  display: inline;
}
.pager li > a,
.pager li > span {
  display: inline-block;
  padding: 5px 14px;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 15px;
}
.pager li > a:hover,
.pager li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.pager .next > a,
.pager .next > span {
  float: right;
}
.pager .previous > a,
.pager .previous > span {
  float: left;
}
.pager .disabled > a,
.pager .disabled > a:hover,
.pager .disabled > a:focus,
.pager .disabled > span {
  color: #777777;
  background-color: #fff;
  cursor: not-allowed;
}
.label {
  display: inline;
  padding: .2em .6em .3em;
  font-size: 75%;
  font-weight: bold;
  line-height: 1;
  color: #fff;
  text-align: center;
  white-space: nowrap;
  vertical-align: baseline;
  border-radius: .25em;
}
a.label:hover,
a.label:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.label:empty {
  display: none;
}
.btn .label {
  position: relative;
  top: -1px;
}
.label-default {
  background-color: #777777;
}
.label-default[href]:hover,
.label-default[href]:focus {
  background-color: #5e5e5e;
}
.label-primary {
  background-color: #337ab7;
}
.label-primary[href]:hover,
.label-primary[href]:focus {
  background-color: #286090;
}
.label-success {
  background-color: #5cb85c;
}
.label-success[href]:hover,
.label-success[href]:focus {
  background-color: #449d44;
}
.label-info {
  background-color: #5bc0de;
}
.label-info[href]:hover,
.label-info[href]:focus {
  background-color: #31b0d5;
}
.label-warning {
  background-color: #f0ad4e;
}
.label-warning[href]:hover,
.label-warning[href]:focus {
  background-color: #ec971f;
}
.label-danger {
  background-color: #d9534f;
}
.label-danger[href]:hover,
.label-danger[href]:focus {
  background-color: #c9302c;
}
.badge {
  display: inline-block;
  min-width: 10px;
  padding: 3px 7px;
  font-size: 12px;
  font-weight: bold;
  color: #fff;
  line-height: 1;
  vertical-align: middle;
  white-space: nowrap;
  text-align: center;
  background-color: #777777;
  border-radius: 10px;
}
.badge:empty {
  display: none;
}
.btn .badge {
  position: relative;
  top: -1px;
}
.btn-xs .badge,
.btn-group-xs > .btn .badge {
  top: 0;
  padding: 1px 5px;
}
a.badge:hover,
a.badge:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.list-group-item.active > .badge,
.nav-pills > .active > a > .badge {
  color: #337ab7;
  background-color: #fff;
}
.list-group-item > .badge {
  float: right;
}
.list-group-item > .badge + .badge {
  margin-right: 5px;
}
.nav-pills > li > a > .badge {
  margin-left: 3px;
}
.jumbotron {
  padding-top: 30px;
  padding-bottom: 30px;
  margin-bottom: 30px;
  color: inherit;
  background-color: #eeeeee;
}
.jumbotron h1,
.jumbotron .h1 {
  color: inherit;
}
.jumbotron p {
  margin-bottom: 15px;
  font-size: 20px;
  font-weight: 200;
}
.jumbotron > hr {
  border-top-color: #d5d5d5;
}
.container .jumbotron,
.container-fluid .jumbotron {
  border-radius: 3px;
  padding-left: 0px;
  padding-right: 0px;
}
.jumbotron .container {
  max-width: 100%;
}
@media screen and (min-width: 768px) {
  .jumbotron {
    padding-top: 48px;
    padding-bottom: 48px;
  }
  .container .jumbotron,
  .container-fluid .jumbotron {
    padding-left: 60px;
    padding-right: 60px;
  }
  .jumbotron h1,
  .jumbotron .h1 {
    font-size: 59px;
  }
}
.thumbnail {
  display: block;
  padding: 4px;
  margin-bottom: 18px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: border 0.2s ease-in-out;
  -o-transition: border 0.2s ease-in-out;
  transition: border 0.2s ease-in-out;
}
.thumbnail > img,
.thumbnail a > img {
  margin-left: auto;
  margin-right: auto;
}
a.thumbnail:hover,
a.thumbnail:focus,
a.thumbnail.active {
  border-color: #337ab7;
}
.thumbnail .caption {
  padding: 9px;
  color: #000;
}
.alert {
  padding: 15px;
  margin-bottom: 18px;
  border: 1px solid transparent;
  border-radius: 2px;
}
.alert h4 {
  margin-top: 0;
  color: inherit;
}
.alert .alert-link {
  font-weight: bold;
}
.alert > p,
.alert > ul {
  margin-bottom: 0;
}
.alert > p + p {
  margin-top: 5px;
}
.alert-dismissable,
.alert-dismissible {
  padding-right: 35px;
}
.alert-dismissable .close,
.alert-dismissible .close {
  position: relative;
  top: -2px;
  right: -21px;
  color: inherit;
}
.alert-success {
  background-color: #dff0d8;
  border-color: #d6e9c6;
  color: #3c763d;
}
.alert-success hr {
  border-top-color: #c9e2b3;
}
.alert-success .alert-link {
  color: #2b542c;
}
.alert-info {
  background-color: #d9edf7;
  border-color: #bce8f1;
  color: #31708f;
}
.alert-info hr {
  border-top-color: #a6e1ec;
}
.alert-info .alert-link {
  color: #245269;
}
.alert-warning {
  background-color: #fcf8e3;
  border-color: #faebcc;
  color: #8a6d3b;
}
.alert-warning hr {
  border-top-color: #f7e1b5;
}
.alert-warning .alert-link {
  color: #66512c;
}
.alert-danger {
  background-color: #f2dede;
  border-color: #ebccd1;
  color: #a94442;
}
.alert-danger hr {
  border-top-color: #e4b9c0;
}
.alert-danger .alert-link {
  color: #843534;
}
@-webkit-keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
@keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
.progress {
  overflow: hidden;
  height: 18px;
  margin-bottom: 18px;
  background-color: #f5f5f5;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}
.progress-bar {
  float: left;
  width: 0%;
  height: 100%;
  font-size: 12px;
  line-height: 18px;
  color: #fff;
  text-align: center;
  background-color: #337ab7;
  -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  -webkit-transition: width 0.6s ease;
  -o-transition: width 0.6s ease;
  transition: width 0.6s ease;
}
.progress-striped .progress-bar,
.progress-bar-striped {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-size: 40px 40px;
}
.progress.active .progress-bar,
.progress-bar.active {
  -webkit-animation: progress-bar-stripes 2s linear infinite;
  -o-animation: progress-bar-stripes 2s linear infinite;
  animation: progress-bar-stripes 2s linear infinite;
}
.progress-bar-success {
  background-color: #5cb85c;
}
.progress-striped .progress-bar-success {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-info {
  background-color: #5bc0de;
}
.progress-striped .progress-bar-info {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-warning {
  background-color: #f0ad4e;
}
.progress-striped .progress-bar-warning {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-danger {
  background-color: #d9534f;
}
.progress-striped .progress-bar-danger {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.media {
  margin-top: 15px;
}
.media:first-child {
  margin-top: 0;
}
.media,
.media-body {
  zoom: 1;
  overflow: hidden;
}
.media-body {
  width: 10000px;
}
.media-object {
  display: block;
}
.media-object.img-thumbnail {
  max-width: none;
}
.media-right,
.media > .pull-right {
  padding-left: 10px;
}
.media-left,
.media > .pull-left {
  padding-right: 10px;
}
.media-left,
.media-right,
.media-body {
  display: table-cell;
  vertical-align: top;
}
.media-middle {
  vertical-align: middle;
}
.media-bottom {
  vertical-align: bottom;
}
.media-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.media-list {
  padding-left: 0;
  list-style: none;
}
.list-group {
  margin-bottom: 20px;
  padding-left: 0;
}
.list-group-item {
  position: relative;
  display: block;
  padding: 10px 15px;
  margin-bottom: -1px;
  background-color: #fff;
  border: 1px solid #ddd;
}
.list-group-item:first-child {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
}
.list-group-item:last-child {
  margin-bottom: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
a.list-group-item,
button.list-group-item {
  color: #555;
}
a.list-group-item .list-group-item-heading,
button.list-group-item .list-group-item-heading {
  color: #333;
}
a.list-group-item:hover,
button.list-group-item:hover,
a.list-group-item:focus,
button.list-group-item:focus {
  text-decoration: none;
  color: #555;
  background-color: #f5f5f5;
}
button.list-group-item {
  width: 100%;
  text-align: left;
}
.list-group-item.disabled,
.list-group-item.disabled:hover,
.list-group-item.disabled:focus {
  background-color: #eeeeee;
  color: #777777;
  cursor: not-allowed;
}
.list-group-item.disabled .list-group-item-heading,
.list-group-item.disabled:hover .list-group-item-heading,
.list-group-item.disabled:focus .list-group-item-heading {
  color: inherit;
}
.list-group-item.disabled .list-group-item-text,
.list-group-item.disabled:hover .list-group-item-text,
.list-group-item.disabled:focus .list-group-item-text {
  color: #777777;
}
.list-group-item.active,
.list-group-item.active:hover,
.list-group-item.active:focus {
  z-index: 2;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.list-group-item.active .list-group-item-heading,
.list-group-item.active:hover .list-group-item-heading,
.list-group-item.active:focus .list-group-item-heading,
.list-group-item.active .list-group-item-heading > small,
.list-group-item.active:hover .list-group-item-heading > small,
.list-group-item.active:focus .list-group-item-heading > small,
.list-group-item.active .list-group-item-heading > .small,
.list-group-item.active:hover .list-group-item-heading > .small,
.list-group-item.active:focus .list-group-item-heading > .small {
  color: inherit;
}
.list-group-item.active .list-group-item-text,
.list-group-item.active:hover .list-group-item-text,
.list-group-item.active:focus .list-group-item-text {
  color: #c7ddef;
}
.list-group-item-success {
  color: #3c763d;
  background-color: #dff0d8;
}
a.list-group-item-success,
button.list-group-item-success {
  color: #3c763d;
}
a.list-group-item-success .list-group-item-heading,
button.list-group-item-success .list-group-item-heading {
  color: inherit;
}
a.list-group-item-success:hover,
button.list-group-item-success:hover,
a.list-group-item-success:focus,
button.list-group-item-success:focus {
  color: #3c763d;
  background-color: #d0e9c6;
}
a.list-group-item-success.active,
button.list-group-item-success.active,
a.list-group-item-success.active:hover,
button.list-group-item-success.active:hover,
a.list-group-item-success.active:focus,
button.list-group-item-success.active:focus {
  color: #fff;
  background-color: #3c763d;
  border-color: #3c763d;
}
.list-group-item-info {
  color: #31708f;
  background-color: #d9edf7;
}
a.list-group-item-info,
button.list-group-item-info {
  color: #31708f;
}
a.list-group-item-info .list-group-item-heading,
button.list-group-item-info .list-group-item-heading {
  color: inherit;
}
a.list-group-item-info:hover,
button.list-group-item-info:hover,
a.list-group-item-info:focus,
button.list-group-item-info:focus {
  color: #31708f;
  background-color: #c4e3f3;
}
a.list-group-item-info.active,
button.list-group-item-info.active,
a.list-group-item-info.active:hover,
button.list-group-item-info.active:hover,
a.list-group-item-info.active:focus,
button.list-group-item-info.active:focus {
  color: #fff;
  background-color: #31708f;
  border-color: #31708f;
}
.list-group-item-warning {
  color: #8a6d3b;
  background-color: #fcf8e3;
}
a.list-group-item-warning,
button.list-group-item-warning {
  color: #8a6d3b;
}
a.list-group-item-warning .list-group-item-heading,
button.list-group-item-warning .list-group-item-heading {
  color: inherit;
}
a.list-group-item-warning:hover,
button.list-group-item-warning:hover,
a.list-group-item-warning:focus,
button.list-group-item-warning:focus {
  color: #8a6d3b;
  background-color: #faf2cc;
}
a.list-group-item-warning.active,
button.list-group-item-warning.active,
a.list-group-item-warning.active:hover,
button.list-group-item-warning.active:hover,
a.list-group-item-warning.active:focus,
button.list-group-item-warning.active:focus {
  color: #fff;
  background-color: #8a6d3b;
  border-color: #8a6d3b;
}
.list-group-item-danger {
  color: #a94442;
  background-color: #f2dede;
}
a.list-group-item-danger,
button.list-group-item-danger {
  color: #a94442;
}
a.list-group-item-danger .list-group-item-heading,
button.list-group-item-danger .list-group-item-heading {
  color: inherit;
}
a.list-group-item-danger:hover,
button.list-group-item-danger:hover,
a.list-group-item-danger:focus,
button.list-group-item-danger:focus {
  color: #a94442;
  background-color: #ebcccc;
}
a.list-group-item-danger.active,
button.list-group-item-danger.active,
a.list-group-item-danger.active:hover,
button.list-group-item-danger.active:hover,
a.list-group-item-danger.active:focus,
button.list-group-item-danger.active:focus {
  color: #fff;
  background-color: #a94442;
  border-color: #a94442;
}
.list-group-item-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.list-group-item-text {
  margin-bottom: 0;
  line-height: 1.3;
}
.panel {
  margin-bottom: 18px;
  background-color: #fff;
  border: 1px solid transparent;
  border-radius: 2px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
}
.panel-body {
  padding: 15px;
}
.panel-heading {
  padding: 10px 15px;
  border-bottom: 1px solid transparent;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel-heading > .dropdown .dropdown-toggle {
  color: inherit;
}
.panel-title {
  margin-top: 0;
  margin-bottom: 0;
  font-size: 15px;
  color: inherit;
}
.panel-title > a,
.panel-title > small,
.panel-title > .small,
.panel-title > small > a,
.panel-title > .small > a {
  color: inherit;
}
.panel-footer {
  padding: 10px 15px;
  background-color: #f5f5f5;
  border-top: 1px solid #ddd;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .list-group,
.panel > .panel-collapse > .list-group {
  margin-bottom: 0;
}
.panel > .list-group .list-group-item,
.panel > .panel-collapse > .list-group .list-group-item {
  border-width: 1px 0;
  border-radius: 0;
}
.panel > .list-group:first-child .list-group-item:first-child,
.panel > .panel-collapse > .list-group:first-child .list-group-item:first-child {
  border-top: 0;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .list-group:last-child .list-group-item:last-child,
.panel > .panel-collapse > .list-group:last-child .list-group-item:last-child {
  border-bottom: 0;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .panel-heading + .panel-collapse > .list-group .list-group-item:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.panel-heading + .list-group .list-group-item:first-child {
  border-top-width: 0;
}
.list-group + .panel-footer {
  border-top-width: 0;
}
.panel > .table,
.panel > .table-responsive > .table,
.panel > .panel-collapse > .table {
  margin-bottom: 0;
}
.panel > .table caption,
.panel > .table-responsive > .table caption,
.panel > .panel-collapse > .table caption {
  padding-left: 15px;
  padding-right: 15px;
}
.panel > .table:first-child,
.panel > .table-responsive:first-child > .table:first-child {
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child {
  border-top-left-radius: 1px;
  border-top-right-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:first-child {
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:last-child {
  border-top-right-radius: 1px;
}
.panel > .table:last-child,
.panel > .table-responsive:last-child > .table:last-child {
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child {
  border-bottom-left-radius: 1px;
  border-bottom-right-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:first-child {
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:last-child {
  border-bottom-right-radius: 1px;
}
.panel > .panel-body + .table,
.panel > .panel-body + .table-responsive,
.panel > .table + .panel-body,
.panel > .table-responsive + .panel-body {
  border-top: 1px solid #ddd;
}
.panel > .table > tbody:first-child > tr:first-child th,
.panel > .table > tbody:first-child > tr:first-child td {
  border-top: 0;
}
.panel > .table-bordered,
.panel > .table-responsive > .table-bordered {
  border: 0;
}
.panel > .table-bordered > thead > tr > th:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:first-child,
.panel > .table-bordered > tbody > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:first-child,
.panel > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-bordered > thead > tr > td:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:first-child,
.panel > .table-bordered > tbody > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:first-child,
.panel > .table-bordered > tfoot > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:first-child {
  border-left: 0;
}
.panel > .table-bordered > thead > tr > th:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:last-child,
.panel > .table-bordered > tbody > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:last-child,
.panel > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-bordered > thead > tr > td:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:last-child,
.panel > .table-bordered > tbody > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:last-child,
.panel > .table-bordered > tfoot > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:last-child {
  border-right: 0;
}
.panel > .table-bordered > thead > tr:first-child > td,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > td,
.panel > .table-bordered > tbody > tr:first-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > td,
.panel > .table-bordered > thead > tr:first-child > th,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > th,
.panel > .table-bordered > tbody > tr:first-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > th {
  border-bottom: 0;
}
.panel > .table-bordered > tbody > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > td,
.panel > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-bordered > tbody > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > th,
.panel > .table-bordered > tfoot > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > th {
  border-bottom: 0;
}
.panel > .table-responsive {
  border: 0;
  margin-bottom: 0;
}
.panel-group {
  margin-bottom: 18px;
}
.panel-group .panel {
  margin-bottom: 0;
  border-radius: 2px;
}
.panel-group .panel + .panel {
  margin-top: 5px;
}
.panel-group .panel-heading {
  border-bottom: 0;
}
.panel-group .panel-heading + .panel-collapse > .panel-body,
.panel-group .panel-heading + .panel-collapse > .list-group {
  border-top: 1px solid #ddd;
}
.panel-group .panel-footer {
  border-top: 0;
}
.panel-group .panel-footer + .panel-collapse .panel-body {
  border-bottom: 1px solid #ddd;
}
.panel-default {
  border-color: #ddd;
}
.panel-default > .panel-heading {
  color: #333333;
  background-color: #f5f5f5;
  border-color: #ddd;
}
.panel-default > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ddd;
}
.panel-default > .panel-heading .badge {
  color: #f5f5f5;
  background-color: #333333;
}
.panel-default > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ddd;
}
.panel-primary {
  border-color: #337ab7;
}
.panel-primary > .panel-heading {
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.panel-primary > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #337ab7;
}
.panel-primary > .panel-heading .badge {
  color: #337ab7;
  background-color: #fff;
}
.panel-primary > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #337ab7;
}
.panel-success {
  border-color: #d6e9c6;
}
.panel-success > .panel-heading {
  color: #3c763d;
  background-color: #dff0d8;
  border-color: #d6e9c6;
}
.panel-success > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #d6e9c6;
}
.panel-success > .panel-heading .badge {
  color: #dff0d8;
  background-color: #3c763d;
}
.panel-success > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #d6e9c6;
}
.panel-info {
  border-color: #bce8f1;
}
.panel-info > .panel-heading {
  color: #31708f;
  background-color: #d9edf7;
  border-color: #bce8f1;
}
.panel-info > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #bce8f1;
}
.panel-info > .panel-heading .badge {
  color: #d9edf7;
  background-color: #31708f;
}
.panel-info > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #bce8f1;
}
.panel-warning {
  border-color: #faebcc;
}
.panel-warning > .panel-heading {
  color: #8a6d3b;
  background-color: #fcf8e3;
  border-color: #faebcc;
}
.panel-warning > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #faebcc;
}
.panel-warning > .panel-heading .badge {
  color: #fcf8e3;
  background-color: #8a6d3b;
}
.panel-warning > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #faebcc;
}
.panel-danger {
  border-color: #ebccd1;
}
.panel-danger > .panel-heading {
  color: #a94442;
  background-color: #f2dede;
  border-color: #ebccd1;
}
.panel-danger > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ebccd1;
}
.panel-danger > .panel-heading .badge {
  color: #f2dede;
  background-color: #a94442;
}
.panel-danger > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ebccd1;
}
.embed-responsive {
  position: relative;
  display: block;
  height: 0;
  padding: 0;
  overflow: hidden;
}
.embed-responsive .embed-responsive-item,
.embed-responsive iframe,
.embed-responsive embed,
.embed-responsive object,
.embed-responsive video {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  height: 100%;
  width: 100%;
  border: 0;
}
.embed-responsive-16by9 {
  padding-bottom: 56.25%;
}
.embed-responsive-4by3 {
  padding-bottom: 75%;
}
.well {
  min-height: 20px;
  padding: 19px;
  margin-bottom: 20px;
  background-color: #f5f5f5;
  border: 1px solid #e3e3e3;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
}
.well blockquote {
  border-color: #ddd;
  border-color: rgba(0, 0, 0, 0.15);
}
.well-lg {
  padding: 24px;
  border-radius: 3px;
}
.well-sm {
  padding: 9px;
  border-radius: 1px;
}
.close {
  float: right;
  font-size: 19.5px;
  font-weight: bold;
  line-height: 1;
  color: #000;
  text-shadow: 0 1px 0 #fff;
  opacity: 0.2;
  filter: alpha(opacity=20);
}
.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
  opacity: 0.5;
  filter: alpha(opacity=50);
}
button.close {
  padding: 0;
  cursor: pointer;
  background: transparent;
  border: 0;
  -webkit-appearance: none;
}
.modal-open {
  overflow: hidden;
}
.modal {
  display: none;
  overflow: hidden;
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1050;
  -webkit-overflow-scrolling: touch;
  outline: 0;
}
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, -25%);
  -ms-transform: translate(0, -25%);
  -o-transform: translate(0, -25%);
  transform: translate(0, -25%);
  -webkit-transition: -webkit-transform 0.3s ease-out;
  -moz-transition: -moz-transform 0.3s ease-out;
  -o-transition: -o-transform 0.3s ease-out;
  transition: transform 0.3s ease-out;
}
.modal.in .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
.modal-open .modal {
  overflow-x: hidden;
  overflow-y: auto;
}
.modal-dialog {
  position: relative;
  width: auto;
  margin: 10px;
}
.modal-content {
  position: relative;
  background-color: #fff;
  border: 1px solid #999;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  background-clip: padding-box;
  outline: 0;
}
.modal-backdrop {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1040;
  background-color: #000;
}
.modal-backdrop.fade {
  opacity: 0;
  filter: alpha(opacity=0);
}
.modal-backdrop.in {
  opacity: 0.5;
  filter: alpha(opacity=50);
}
.modal-header {
  padding: 15px;
  border-bottom: 1px solid #e5e5e5;
}
.modal-header .close {
  margin-top: -2px;
}
.modal-title {
  margin: 0;
  line-height: 1.42857143;
}
.modal-body {
  position: relative;
  padding: 15px;
}
.modal-footer {
  padding: 15px;
  text-align: right;
  border-top: 1px solid #e5e5e5;
}
.modal-footer .btn + .btn {
  margin-left: 5px;
  margin-bottom: 0;
}
.modal-footer .btn-group .btn + .btn {
  margin-left: -1px;
}
.modal-footer .btn-block + .btn-block {
  margin-left: 0;
}
.modal-scrollbar-measure {
  position: absolute;
  top: -9999px;
  width: 50px;
  height: 50px;
  overflow: scroll;
}
@media (min-width: 768px) {
  .modal-dialog {
    width: 600px;
    margin: 30px auto;
  }
  .modal-content {
    -webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
  }
  .modal-sm {
    width: 300px;
  }
}
@media (min-width: 992px) {
  .modal-lg {
    width: 900px;
  }
}
.tooltip {
  position: absolute;
  z-index: 1070;
  display: block;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 12px;
  opacity: 0;
  filter: alpha(opacity=0);
}
.tooltip.in {
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.tooltip.top {
  margin-top: -3px;
  padding: 5px 0;
}
.tooltip.right {
  margin-left: 3px;
  padding: 0 5px;
}
.tooltip.bottom {
  margin-top: 3px;
  padding: 5px 0;
}
.tooltip.left {
  margin-left: -3px;
  padding: 0 5px;
}
.tooltip-inner {
  max-width: 200px;
  padding: 3px 8px;
  color: #fff;
  text-align: center;
  background-color: #000;
  border-radius: 2px;
}
.tooltip-arrow {
  position: absolute;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.tooltip.top .tooltip-arrow {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-left .tooltip-arrow {
  bottom: 0;
  right: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-right .tooltip-arrow {
  bottom: 0;
  left: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.right .tooltip-arrow {
  top: 50%;
  left: 0;
  margin-top: -5px;
  border-width: 5px 5px 5px 0;
  border-right-color: #000;
}
.tooltip.left .tooltip-arrow {
  top: 50%;
  right: 0;
  margin-top: -5px;
  border-width: 5px 0 5px 5px;
  border-left-color: #000;
}
.tooltip.bottom .tooltip-arrow {
  top: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-left .tooltip-arrow {
  top: 0;
  right: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-right .tooltip-arrow {
  top: 0;
  left: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.popover {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1060;
  display: none;
  max-width: 276px;
  padding: 1px;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 13px;
  background-color: #fff;
  background-clip: padding-box;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
}
.popover.top {
  margin-top: -10px;
}
.popover.right {
  margin-left: 10px;
}
.popover.bottom {
  margin-top: 10px;
}
.popover.left {
  margin-left: -10px;
}
.popover-title {
  margin: 0;
  padding: 8px 14px;
  font-size: 13px;
  background-color: #f7f7f7;
  border-bottom: 1px solid #ebebeb;
  border-radius: 2px 2px 0 0;
}
.popover-content {
  padding: 9px 14px;
}
.popover > .arrow,
.popover > .arrow:after {
  position: absolute;
  display: block;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.popover > .arrow {
  border-width: 11px;
}
.popover > .arrow:after {
  border-width: 10px;
  content: "";
}
.popover.top > .arrow {
  left: 50%;
  margin-left: -11px;
  border-bottom-width: 0;
  border-top-color: #999999;
  border-top-color: rgba(0, 0, 0, 0.25);
  bottom: -11px;
}
.popover.top > .arrow:after {
  content: " ";
  bottom: 1px;
  margin-left: -10px;
  border-bottom-width: 0;
  border-top-color: #fff;
}
.popover.right > .arrow {
  top: 50%;
  left: -11px;
  margin-top: -11px;
  border-left-width: 0;
  border-right-color: #999999;
  border-right-color: rgba(0, 0, 0, 0.25);
}
.popover.right > .arrow:after {
  content: " ";
  left: 1px;
  bottom: -10px;
  border-left-width: 0;
  border-right-color: #fff;
}
.popover.bottom > .arrow {
  left: 50%;
  margin-left: -11px;
  border-top-width: 0;
  border-bottom-color: #999999;
  border-bottom-color: rgba(0, 0, 0, 0.25);
  top: -11px;
}
.popover.bottom > .arrow:after {
  content: " ";
  top: 1px;
  margin-left: -10px;
  border-top-width: 0;
  border-bottom-color: #fff;
}
.popover.left > .arrow {
  top: 50%;
  right: -11px;
  margin-top: -11px;
  border-right-width: 0;
  border-left-color: #999999;
  border-left-color: rgba(0, 0, 0, 0.25);
}
.popover.left > .arrow:after {
  content: " ";
  right: 1px;
  border-right-width: 0;
  border-left-color: #fff;
  bottom: -10px;
}
.carousel {
  position: relative;
}
.carousel-inner {
  position: relative;
  overflow: hidden;
  width: 100%;
}
.carousel-inner > .item {
  display: none;
  position: relative;
  -webkit-transition: 0.6s ease-in-out left;
  -o-transition: 0.6s ease-in-out left;
  transition: 0.6s ease-in-out left;
}
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  line-height: 1;
}
@media all and (transform-3d), (-webkit-transform-3d) {
  .carousel-inner > .item {
    -webkit-transition: -webkit-transform 0.6s ease-in-out;
    -moz-transition: -moz-transform 0.6s ease-in-out;
    -o-transition: -o-transform 0.6s ease-in-out;
    transition: transform 0.6s ease-in-out;
    -webkit-backface-visibility: hidden;
    -moz-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    -moz-perspective: 1000px;
    perspective: 1000px;
  }
  .carousel-inner > .item.next,
  .carousel-inner > .item.active.right {
    -webkit-transform: translate3d(100%, 0, 0);
    transform: translate3d(100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.prev,
  .carousel-inner > .item.active.left {
    -webkit-transform: translate3d(-100%, 0, 0);
    transform: translate3d(-100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.next.left,
  .carousel-inner > .item.prev.right,
  .carousel-inner > .item.active {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    left: 0;
  }
}
.carousel-inner > .active,
.carousel-inner > .next,
.carousel-inner > .prev {
  display: block;
}
.carousel-inner > .active {
  left: 0;
}
.carousel-inner > .next,
.carousel-inner > .prev {
  position: absolute;
  top: 0;
  width: 100%;
}
.carousel-inner > .next {
  left: 100%;
}
.carousel-inner > .prev {
  left: -100%;
}
.carousel-inner > .next.left,
.carousel-inner > .prev.right {
  left: 0;
}
.carousel-inner > .active.left {
  left: -100%;
}
.carousel-inner > .active.right {
  left: 100%;
}
.carousel-control {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  width: 15%;
  opacity: 0.5;
  filter: alpha(opacity=50);
  font-size: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
  background-color: rgba(0, 0, 0, 0);
}
.carousel-control.left {
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#80000000', endColorstr='#00000000', GradientType=1);
}
.carousel-control.right {
  left: auto;
  right: 0;
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#80000000', GradientType=1);
}
.carousel-control:hover,
.carousel-control:focus {
  outline: 0;
  color: #fff;
  text-decoration: none;
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.carousel-control .icon-prev,
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-left,
.carousel-control .glyphicon-chevron-right {
  position: absolute;
  top: 50%;
  margin-top: -10px;
  z-index: 5;
  display: inline-block;
}
.carousel-control .icon-prev,
.carousel-control .glyphicon-chevron-left {
  left: 50%;
  margin-left: -10px;
}
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-right {
  right: 50%;
  margin-right: -10px;
}
.carousel-control .icon-prev,
.carousel-control .icon-next {
  width: 20px;
  height: 20px;
  line-height: 1;
  font-family: serif;
}
.carousel-control .icon-prev:before {
  content: '\2039';
}
.carousel-control .icon-next:before {
  content: '\203a';
}
.carousel-indicators {
  position: absolute;
  bottom: 10px;
  left: 50%;
  z-index: 15;
  width: 60%;
  margin-left: -30%;
  padding-left: 0;
  list-style: none;
  text-align: center;
}
.carousel-indicators li {
  display: inline-block;
  width: 10px;
  height: 10px;
  margin: 1px;
  text-indent: -999px;
  border: 1px solid #fff;
  border-radius: 10px;
  cursor: pointer;
  background-color: #000 \9;
  background-color: rgba(0, 0, 0, 0);
}
.carousel-indicators .active {
  margin: 0;
  width: 12px;
  height: 12px;
  background-color: #fff;
}
.carousel-caption {
  position: absolute;
  left: 15%;
  right: 15%;
  bottom: 20px;
  z-index: 10;
  padding-top: 20px;
  padding-bottom: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
}
.carousel-caption .btn {
  text-shadow: none;
}
@media screen and (min-width: 768px) {
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-prev,
  .carousel-control .icon-next {
    width: 30px;
    height: 30px;
    margin-top: -10px;
    font-size: 30px;
  }
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .icon-prev {
    margin-left: -10px;
  }
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-next {
    margin-right: -10px;
  }
  .carousel-caption {
    left: 20%;
    right: 20%;
    padding-bottom: 30px;
  }
  .carousel-indicators {
    bottom: 20px;
  }
}
.clearfix:before,
.clearfix:after,
.dl-horizontal dd:before,
.dl-horizontal dd:after,
.container:before,
.container:after,
.container-fluid:before,
.container-fluid:after,
.row:before,
.row:after,
.form-horizontal .form-group:before,
.form-horizontal .form-group:after,
.btn-toolbar:before,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:before,
.btn-group-vertical > .btn-group:after,
.nav:before,
.nav:after,
.navbar:before,
.navbar:after,
.navbar-header:before,
.navbar-header:after,
.navbar-collapse:before,
.navbar-collapse:after,
.pager:before,
.pager:after,
.panel-body:before,
.panel-body:after,
.modal-header:before,
.modal-header:after,
.modal-footer:before,
.modal-footer:after,
.item_buttons:before,
.item_buttons:after {
  content: " ";
  display: table;
}
.clearfix:after,
.dl-horizontal dd:after,
.container:after,
.container-fluid:after,
.row:after,
.form-horizontal .form-group:after,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:after,
.nav:after,
.navbar:after,
.navbar-header:after,
.navbar-collapse:after,
.pager:after,
.panel-body:after,
.modal-header:after,
.modal-footer:after,
.item_buttons:after {
  clear: both;
}
.center-block {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.pull-right {
  float: right !important;
}
.pull-left {
  float: left !important;
}
.hide {
  display: none !important;
}
.show {
  display: block !important;
}
.invisible {
  visibility: hidden;
}
.text-hide {
  font: 0/0 a;
  color: transparent;
  text-shadow: none;
  background-color: transparent;
  border: 0;
}
.hidden {
  display: none !important;
}
.affix {
  position: fixed;
}
@-ms-viewport {
  width: device-width;
}
.visible-xs,
.visible-sm,
.visible-md,
.visible-lg {
  display: none !important;
}
.visible-xs-block,
.visible-xs-inline,
.visible-xs-inline-block,
.visible-sm-block,
.visible-sm-inline,
.visible-sm-inline-block,
.visible-md-block,
.visible-md-inline,
.visible-md-inline-block,
.visible-lg-block,
.visible-lg-inline,
.visible-lg-inline-block {
  display: none !important;
}
@media (max-width: 767px) {
  .visible-xs {
    display: block !important;
  }
  table.visible-xs {
    display: table !important;
  }
  tr.visible-xs {
    display: table-row !important;
  }
  th.visible-xs,
  td.visible-xs {
    display: table-cell !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-block {
    display: block !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline {
    display: inline !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm {
    display: block !important;
  }
  table.visible-sm {
    display: table !important;
  }
  tr.visible-sm {
    display: table-row !important;
  }
  th.visible-sm,
  td.visible-sm {
    display: table-cell !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-block {
    display: block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline {
    display: inline !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md {
    display: block !important;
  }
  table.visible-md {
    display: table !important;
  }
  tr.visible-md {
    display: table-row !important;
  }
  th.visible-md,
  td.visible-md {
    display: table-cell !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-block {
    display: block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline {
    display: inline !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg {
    display: block !important;
  }
  table.visible-lg {
    display: table !important;
  }
  tr.visible-lg {
    display: table-row !important;
  }
  th.visible-lg,
  td.visible-lg {
    display: table-cell !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-block {
    display: block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline {
    display: inline !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline-block {
    display: inline-block !important;
  }
}
@media (max-width: 767px) {
  .hidden-xs {
    display: none !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .hidden-sm {
    display: none !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .hidden-md {
    display: none !important;
  }
}
@media (min-width: 1200px) {
  .hidden-lg {
    display: none !important;
  }
}
.visible-print {
  display: none !important;
}
@media print {
  .visible-print {
    display: block !important;
  }
  table.visible-print {
    display: table !important;
  }
  tr.visible-print {
    display: table-row !important;
  }
  th.visible-print,
  td.visible-print {
    display: table-cell !important;
  }
}
.visible-print-block {
  display: none !important;
}
@media print {
  .visible-print-block {
    display: block !important;
  }
}
.visible-print-inline {
  display: none !important;
}
@media print {
  .visible-print-inline {
    display: inline !important;
  }
}
.visible-print-inline-block {
  display: none !important;
}
@media print {
  .visible-print-inline-block {
    display: inline-block !important;
  }
}
@media print {
  .hidden-print {
    display: none !important;
  }
}
/*!
*
* Font Awesome
*
*/
/*!
 *  Font Awesome 4.2.0 by @davegandy - http://fontawesome.io - @fontawesome
 *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)
 */
/* FONT PATH
 * -------------------------- */
@font-face {
  font-family: 'FontAwesome';
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?v=4.2.0');
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?#iefix&v=4.2.0') format('embedded-opentype'), url('../components/font-awesome/fonts/fontawesome-webfont.woff?v=4.2.0') format('woff'), url('../components/font-awesome/fonts/fontawesome-webfont.ttf?v=4.2.0') format('truetype'), url('../components/font-awesome/fonts/fontawesome-webfont.svg?v=4.2.0#fontawesomeregular') format('svg');
  font-weight: normal;
  font-style: normal;
}
.fa {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* makes the font 33% larger relative to the icon container */
.fa-lg {
  font-size: 1.33333333em;
  line-height: 0.75em;
  vertical-align: -15%;
}
.fa-2x {
  font-size: 2em;
}
.fa-3x {
  font-size: 3em;
}
.fa-4x {
  font-size: 4em;
}
.fa-5x {
  font-size: 5em;
}
.fa-fw {
  width: 1.28571429em;
  text-align: center;
}
.fa-ul {
  padding-left: 0;
  margin-left: 2.14285714em;
  list-style-type: none;
}
.fa-ul > li {
  position: relative;
}
.fa-li {
  position: absolute;
  left: -2.14285714em;
  width: 2.14285714em;
  top: 0.14285714em;
  text-align: center;
}
.fa-li.fa-lg {
  left: -1.85714286em;
}
.fa-border {
  padding: .2em .25em .15em;
  border: solid 0.08em #eee;
  border-radius: .1em;
}
.pull-right {
  float: right;
}
.pull-left {
  float: left;
}
.fa.pull-left {
  margin-right: .3em;
}
.fa.pull-right {
  margin-left: .3em;
}
.fa-spin {
  -webkit-animation: fa-spin 2s infinite linear;
  animation: fa-spin 2s infinite linear;
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
.fa-rotate-90 {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=1);
  -webkit-transform: rotate(90deg);
  -ms-transform: rotate(90deg);
  transform: rotate(90deg);
}
.fa-rotate-180 {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=2);
  -webkit-transform: rotate(180deg);
  -ms-transform: rotate(180deg);
  transform: rotate(180deg);
}
.fa-rotate-270 {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
  -webkit-transform: rotate(270deg);
  -ms-transform: rotate(270deg);
  transform: rotate(270deg);
}
.fa-flip-horizontal {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1);
  -webkit-transform: scale(-1, 1);
  -ms-transform: scale(-1, 1);
  transform: scale(-1, 1);
}
.fa-flip-vertical {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1);
  -webkit-transform: scale(1, -1);
  -ms-transform: scale(1, -1);
  transform: scale(1, -1);
}
:root .fa-rotate-90,
:root .fa-rotate-180,
:root .fa-rotate-270,
:root .fa-flip-horizontal,
:root .fa-flip-vertical {
  filter: none;
}
.fa-stack {
  position: relative;
  display: inline-block;
  width: 2em;
  height: 2em;
  line-height: 2em;
  vertical-align: middle;
}
.fa-stack-1x,
.fa-stack-2x {
  position: absolute;
  left: 0;
  width: 100%;
  text-align: center;
}
.fa-stack-1x {
  line-height: inherit;
}
.fa-stack-2x {
  font-size: 2em;
}
.fa-inverse {
  color: #fff;
}
/* Font Awesome uses the Unicode Private Use Area (PUA) to ensure screen
   readers do not read off random characters that represent icons */
.fa-glass:before {
  content: "\f000";
}
.fa-music:before {
  content: "\f001";
}
.fa-search:before {
  content: "\f002";
}
.fa-envelope-o:before {
  content: "\f003";
}
.fa-heart:before {
  content: "\f004";
}
.fa-star:before {
  content: "\f005";
}
.fa-star-o:before {
  content: "\f006";
}
.fa-user:before {
  content: "\f007";
}
.fa-film:before {
  content: "\f008";
}
.fa-th-large:before {
  content: "\f009";
}
.fa-th:before {
  content: "\f00a";
}
.fa-th-list:before {
  content: "\f00b";
}
.fa-check:before {
  content: "\f00c";
}
.fa-remove:before,
.fa-close:before,
.fa-times:before {
  content: "\f00d";
}
.fa-search-plus:before {
  content: "\f00e";
}
.fa-search-minus:before {
  content: "\f010";
}
.fa-power-off:before {
  content: "\f011";
}
.fa-signal:before {
  content: "\f012";
}
.fa-gear:before,
.fa-cog:before {
  content: "\f013";
}
.fa-trash-o:before {
  content: "\f014";
}
.fa-home:before {
  content: "\f015";
}
.fa-file-o:before {
  content: "\f016";
}
.fa-clock-o:before {
  content: "\f017";
}
.fa-road:before {
  content: "\f018";
}
.fa-download:before {
  content: "\f019";
}
.fa-arrow-circle-o-down:before {
  content: "\f01a";
}
.fa-arrow-circle-o-up:before {
  content: "\f01b";
}
.fa-inbox:before {
  content: "\f01c";
}
.fa-play-circle-o:before {
  content: "\f01d";
}
.fa-rotate-right:before,
.fa-repeat:before {
  content: "\f01e";
}
.fa-refresh:before {
  content: "\f021";
}
.fa-list-alt:before {
  content: "\f022";
}
.fa-lock:before {
  content: "\f023";
}
.fa-flag:before {
  content: "\f024";
}
.fa-headphones:before {
  content: "\f025";
}
.fa-volume-off:before {
  content: "\f026";
}
.fa-volume-down:before {
  content: "\f027";
}
.fa-volume-up:before {
  content: "\f028";
}
.fa-qrcode:before {
  content: "\f029";
}
.fa-barcode:before {
  content: "\f02a";
}
.fa-tag:before {
  content: "\f02b";
}
.fa-tags:before {
  content: "\f02c";
}
.fa-book:before {
  content: "\f02d";
}
.fa-bookmark:before {
  content: "\f02e";
}
.fa-print:before {
  content: "\f02f";
}
.fa-camera:before {
  content: "\f030";
}
.fa-font:before {
  content: "\f031";
}
.fa-bold:before {
  content: "\f032";
}
.fa-italic:before {
  content: "\f033";
}
.fa-text-height:before {
  content: "\f034";
}
.fa-text-width:before {
  content: "\f035";
}
.fa-align-left:before {
  content: "\f036";
}
.fa-align-center:before {
  content: "\f037";
}
.fa-align-right:before {
  content: "\f038";
}
.fa-align-justify:before {
  content: "\f039";
}
.fa-list:before {
  content: "\f03a";
}
.fa-dedent:before,
.fa-outdent:before {
  content: "\f03b";
}
.fa-indent:before {
  content: "\f03c";
}
.fa-video-camera:before {
  content: "\f03d";
}
.fa-photo:before,
.fa-image:before,
.fa-picture-o:before {
  content: "\f03e";
}
.fa-pencil:before {
  content: "\f040";
}
.fa-map-marker:before {
  content: "\f041";
}
.fa-adjust:before {
  content: "\f042";
}
.fa-tint:before {
  content: "\f043";
}
.fa-edit:before,
.fa-pencil-square-o:before {
  content: "\f044";
}
.fa-share-square-o:before {
  content: "\f045";
}
.fa-check-square-o:before {
  content: "\f046";
}
.fa-arrows:before {
  content: "\f047";
}
.fa-step-backward:before {
  content: "\f048";
}
.fa-fast-backward:before {
  content: "\f049";
}
.fa-backward:before {
  content: "\f04a";
}
.fa-play:before {
  content: "\f04b";
}
.fa-pause:before {
  content: "\f04c";
}
.fa-stop:before {
  content: "\f04d";
}
.fa-forward:before {
  content: "\f04e";
}
.fa-fast-forward:before {
  content: "\f050";
}
.fa-step-forward:before {
  content: "\f051";
}
.fa-eject:before {
  content: "\f052";
}
.fa-chevron-left:before {
  content: "\f053";
}
.fa-chevron-right:before {
  content: "\f054";
}
.fa-plus-circle:before {
  content: "\f055";
}
.fa-minus-circle:before {
  content: "\f056";
}
.fa-times-circle:before {
  content: "\f057";
}
.fa-check-circle:before {
  content: "\f058";
}
.fa-question-circle:before {
  content: "\f059";
}
.fa-info-circle:before {
  content: "\f05a";
}
.fa-crosshairs:before {
  content: "\f05b";
}
.fa-times-circle-o:before {
  content: "\f05c";
}
.fa-check-circle-o:before {
  content: "\f05d";
}
.fa-ban:before {
  content: "\f05e";
}
.fa-arrow-left:before {
  content: "\f060";
}
.fa-arrow-right:before {
  content: "\f061";
}
.fa-arrow-up:before {
  content: "\f062";
}
.fa-arrow-down:before {
  content: "\f063";
}
.fa-mail-forward:before,
.fa-share:before {
  content: "\f064";
}
.fa-expand:before {
  content: "\f065";
}
.fa-compress:before {
  content: "\f066";
}
.fa-plus:before {
  content: "\f067";
}
.fa-minus:before {
  content: "\f068";
}
.fa-asterisk:before {
  content: "\f069";
}
.fa-exclamation-circle:before {
  content: "\f06a";
}
.fa-gift:before {
  content: "\f06b";
}
.fa-leaf:before {
  content: "\f06c";
}
.fa-fire:before {
  content: "\f06d";
}
.fa-eye:before {
  content: "\f06e";
}
.fa-eye-slash:before {
  content: "\f070";
}
.fa-warning:before,
.fa-exclamation-triangle:before {
  content: "\f071";
}
.fa-plane:before {
  content: "\f072";
}
.fa-calendar:before {
  content: "\f073";
}
.fa-random:before {
  content: "\f074";
}
.fa-comment:before {
  content: "\f075";
}
.fa-magnet:before {
  content: "\f076";
}
.fa-chevron-up:before {
  content: "\f077";
}
.fa-chevron-down:before {
  content: "\f078";
}
.fa-retweet:before {
  content: "\f079";
}
.fa-shopping-cart:before {
  content: "\f07a";
}
.fa-folder:before {
  content: "\f07b";
}
.fa-folder-open:before {
  content: "\f07c";
}
.fa-arrows-v:before {
  content: "\f07d";
}
.fa-arrows-h:before {
  content: "\f07e";
}
.fa-bar-chart-o:before,
.fa-bar-chart:before {
  content: "\f080";
}
.fa-twitter-square:before {
  content: "\f081";
}
.fa-facebook-square:before {
  content: "\f082";
}
.fa-camera-retro:before {
  content: "\f083";
}
.fa-key:before {
  content: "\f084";
}
.fa-gears:before,
.fa-cogs:before {
  content: "\f085";
}
.fa-comments:before {
  content: "\f086";
}
.fa-thumbs-o-up:before {
  content: "\f087";
}
.fa-thumbs-o-down:before {
  content: "\f088";
}
.fa-star-half:before {
  content: "\f089";
}
.fa-heart-o:before {
  content: "\f08a";
}
.fa-sign-out:before {
  content: "\f08b";
}
.fa-linkedin-square:before {
  content: "\f08c";
}
.fa-thumb-tack:before {
  content: "\f08d";
}
.fa-external-link:before {
  content: "\f08e";
}
.fa-sign-in:before {
  content: "\f090";
}
.fa-trophy:before {
  content: "\f091";
}
.fa-github-square:before {
  content: "\f092";
}
.fa-upload:before {
  content: "\f093";
}
.fa-lemon-o:before {
  content: "\f094";
}
.fa-phone:before {
  content: "\f095";
}
.fa-square-o:before {
  content: "\f096";
}
.fa-bookmark-o:before {
  content: "\f097";
}
.fa-phone-square:before {
  content: "\f098";
}
.fa-twitter:before {
  content: "\f099";
}
.fa-facebook:before {
  content: "\f09a";
}
.fa-github:before {
  content: "\f09b";
}
.fa-unlock:before {
  content: "\f09c";
}
.fa-credit-card:before {
  content: "\f09d";
}
.fa-rss:before {
  content: "\f09e";
}
.fa-hdd-o:before {
  content: "\f0a0";
}
.fa-bullhorn:before {
  content: "\f0a1";
}
.fa-bell:before {
  content: "\f0f3";
}
.fa-certificate:before {
  content: "\f0a3";
}
.fa-hand-o-right:before {
  content: "\f0a4";
}
.fa-hand-o-left:before {
  content: "\f0a5";
}
.fa-hand-o-up:before {
  content: "\f0a6";
}
.fa-hand-o-down:before {
  content: "\f0a7";
}
.fa-arrow-circle-left:before {
  content: "\f0a8";
}
.fa-arrow-circle-right:before {
  content: "\f0a9";
}
.fa-arrow-circle-up:before {
  content: "\f0aa";
}
.fa-arrow-circle-down:before {
  content: "\f0ab";
}
.fa-globe:before {
  content: "\f0ac";
}
.fa-wrench:before {
  content: "\f0ad";
}
.fa-tasks:before {
  content: "\f0ae";
}
.fa-filter:before {
  content: "\f0b0";
}
.fa-briefcase:before {
  content: "\f0b1";
}
.fa-arrows-alt:before {
  content: "\f0b2";
}
.fa-group:before,
.fa-users:before {
  content: "\f0c0";
}
.fa-chain:before,
.fa-link:before {
  content: "\f0c1";
}
.fa-cloud:before {
  content: "\f0c2";
}
.fa-flask:before {
  content: "\f0c3";
}
.fa-cut:before,
.fa-scissors:before {
  content: "\f0c4";
}
.fa-copy:before,
.fa-files-o:before {
  content: "\f0c5";
}
.fa-paperclip:before {
  content: "\f0c6";
}
.fa-save:before,
.fa-floppy-o:before {
  content: "\f0c7";
}
.fa-square:before {
  content: "\f0c8";
}
.fa-navicon:before,
.fa-reorder:before,
.fa-bars:before {
  content: "\f0c9";
}
.fa-list-ul:before {
  content: "\f0ca";
}
.fa-list-ol:before {
  content: "\f0cb";
}
.fa-strikethrough:before {
  content: "\f0cc";
}
.fa-underline:before {
  content: "\f0cd";
}
.fa-table:before {
  content: "\f0ce";
}
.fa-magic:before {
  content: "\f0d0";
}
.fa-truck:before {
  content: "\f0d1";
}
.fa-pinterest:before {
  content: "\f0d2";
}
.fa-pinterest-square:before {
  content: "\f0d3";
}
.fa-google-plus-square:before {
  content: "\f0d4";
}
.fa-google-plus:before {
  content: "\f0d5";
}
.fa-money:before {
  content: "\f0d6";
}
.fa-caret-down:before {
  content: "\f0d7";
}
.fa-caret-up:before {
  content: "\f0d8";
}
.fa-caret-left:before {
  content: "\f0d9";
}
.fa-caret-right:before {
  content: "\f0da";
}
.fa-columns:before {
  content: "\f0db";
}
.fa-unsorted:before,
.fa-sort:before {
  content: "\f0dc";
}
.fa-sort-down:before,
.fa-sort-desc:before {
  content: "\f0dd";
}
.fa-sort-up:before,
.fa-sort-asc:before {
  content: "\f0de";
}
.fa-envelope:before {
  content: "\f0e0";
}
.fa-linkedin:before {
  content: "\f0e1";
}
.fa-rotate-left:before,
.fa-undo:before {
  content: "\f0e2";
}
.fa-legal:before,
.fa-gavel:before {
  content: "\f0e3";
}
.fa-dashboard:before,
.fa-tachometer:before {
  content: "\f0e4";
}
.fa-comment-o:before {
  content: "\f0e5";
}
.fa-comments-o:before {
  content: "\f0e6";
}
.fa-flash:before,
.fa-bolt:before {
  content: "\f0e7";
}
.fa-sitemap:before {
  content: "\f0e8";
}
.fa-umbrella:before {
  content: "\f0e9";
}
.fa-paste:before,
.fa-clipboard:before {
  content: "\f0ea";
}
.fa-lightbulb-o:before {
  content: "\f0eb";
}
.fa-exchange:before {
  content: "\f0ec";
}
.fa-cloud-download:before {
  content: "\f0ed";
}
.fa-cloud-upload:before {
  content: "\f0ee";
}
.fa-user-md:before {
  content: "\f0f0";
}
.fa-stethoscope:before {
  content: "\f0f1";
}
.fa-suitcase:before {
  content: "\f0f2";
}
.fa-bell-o:before {
  content: "\f0a2";
}
.fa-coffee:before {
  content: "\f0f4";
}
.fa-cutlery:before {
  content: "\f0f5";
}
.fa-file-text-o:before {
  content: "\f0f6";
}
.fa-building-o:before {
  content: "\f0f7";
}
.fa-hospital-o:before {
  content: "\f0f8";
}
.fa-ambulance:before {
  content: "\f0f9";
}
.fa-medkit:before {
  content: "\f0fa";
}
.fa-fighter-jet:before {
  content: "\f0fb";
}
.fa-beer:before {
  content: "\f0fc";
}
.fa-h-square:before {
  content: "\f0fd";
}
.fa-plus-square:before {
  content: "\f0fe";
}
.fa-angle-double-left:before {
  content: "\f100";
}
.fa-angle-double-right:before {
  content: "\f101";
}
.fa-angle-double-up:before {
  content: "\f102";
}
.fa-angle-double-down:before {
  content: "\f103";
}
.fa-angle-left:before {
  content: "\f104";
}
.fa-angle-right:before {
  content: "\f105";
}
.fa-angle-up:before {
  content: "\f106";
}
.fa-angle-down:before {
  content: "\f107";
}
.fa-desktop:before {
  content: "\f108";
}
.fa-laptop:before {
  content: "\f109";
}
.fa-tablet:before {
  content: "\f10a";
}
.fa-mobile-phone:before,
.fa-mobile:before {
  content: "\f10b";
}
.fa-circle-o:before {
  content: "\f10c";
}
.fa-quote-left:before {
  content: "\f10d";
}
.fa-quote-right:before {
  content: "\f10e";
}
.fa-spinner:before {
  content: "\f110";
}
.fa-circle:before {
  content: "\f111";
}
.fa-mail-reply:before,
.fa-reply:before {
  content: "\f112";
}
.fa-github-alt:before {
  content: "\f113";
}
.fa-folder-o:before {
  content: "\f114";
}
.fa-folder-open-o:before {
  content: "\f115";
}
.fa-smile-o:before {
  content: "\f118";
}
.fa-frown-o:before {
  content: "\f119";
}
.fa-meh-o:before {
  content: "\f11a";
}
.fa-gamepad:before {
  content: "\f11b";
}
.fa-keyboard-o:before {
  content: "\f11c";
}
.fa-flag-o:before {
  content: "\f11d";
}
.fa-flag-checkered:before {
  content: "\f11e";
}
.fa-terminal:before {
  content: "\f120";
}
.fa-code:before {
  content: "\f121";
}
.fa-mail-reply-all:before,
.fa-reply-all:before {
  content: "\f122";
}
.fa-star-half-empty:before,
.fa-star-half-full:before,
.fa-star-half-o:before {
  content: "\f123";
}
.fa-location-arrow:before {
  content: "\f124";
}
.fa-crop:before {
  content: "\f125";
}
.fa-code-fork:before {
  content: "\f126";
}
.fa-unlink:before,
.fa-chain-broken:before {
  content: "\f127";
}
.fa-question:before {
  content: "\f128";
}
.fa-info:before {
  content: "\f129";
}
.fa-exclamation:before {
  content: "\f12a";
}
.fa-superscript:before {
  content: "\f12b";
}
.fa-subscript:before {
  content: "\f12c";
}
.fa-eraser:before {
  content: "\f12d";
}
.fa-puzzle-piece:before {
  content: "\f12e";
}
.fa-microphone:before {
  content: "\f130";
}
.fa-microphone-slash:before {
  content: "\f131";
}
.fa-shield:before {
  content: "\f132";
}
.fa-calendar-o:before {
  content: "\f133";
}
.fa-fire-extinguisher:before {
  content: "\f134";
}
.fa-rocket:before {
  content: "\f135";
}
.fa-maxcdn:before {
  content: "\f136";
}
.fa-chevron-circle-left:before {
  content: "\f137";
}
.fa-chevron-circle-right:before {
  content: "\f138";
}
.fa-chevron-circle-up:before {
  content: "\f139";
}
.fa-chevron-circle-down:before {
  content: "\f13a";
}
.fa-html5:before {
  content: "\f13b";
}
.fa-css3:before {
  content: "\f13c";
}
.fa-anchor:before {
  content: "\f13d";
}
.fa-unlock-alt:before {
  content: "\f13e";
}
.fa-bullseye:before {
  content: "\f140";
}
.fa-ellipsis-h:before {
  content: "\f141";
}
.fa-ellipsis-v:before {
  content: "\f142";
}
.fa-rss-square:before {
  content: "\f143";
}
.fa-play-circle:before {
  content: "\f144";
}
.fa-ticket:before {
  content: "\f145";
}
.fa-minus-square:before {
  content: "\f146";
}
.fa-minus-square-o:before {
  content: "\f147";
}
.fa-level-up:before {
  content: "\f148";
}
.fa-level-down:before {
  content: "\f149";
}
.fa-check-square:before {
  content: "\f14a";
}
.fa-pencil-square:before {
  content: "\f14b";
}
.fa-external-link-square:before {
  content: "\f14c";
}
.fa-share-square:before {
  content: "\f14d";
}
.fa-compass:before {
  content: "\f14e";
}
.fa-toggle-down:before,
.fa-caret-square-o-down:before {
  content: "\f150";
}
.fa-toggle-up:before,
.fa-caret-square-o-up:before {
  content: "\f151";
}
.fa-toggle-right:before,
.fa-caret-square-o-right:before {
  content: "\f152";
}
.fa-euro:before,
.fa-eur:before {
  content: "\f153";
}
.fa-gbp:before {
  content: "\f154";
}
.fa-dollar:before,
.fa-usd:before {
  content: "\f155";
}
.fa-rupee:before,
.fa-inr:before {
  content: "\f156";
}
.fa-cny:before,
.fa-rmb:before,
.fa-yen:before,
.fa-jpy:before {
  content: "\f157";
}
.fa-ruble:before,
.fa-rouble:before,
.fa-rub:before {
  content: "\f158";
}
.fa-won:before,
.fa-krw:before {
  content: "\f159";
}
.fa-bitcoin:before,
.fa-btc:before {
  content: "\f15a";
}
.fa-file:before {
  content: "\f15b";
}
.fa-file-text:before {
  content: "\f15c";
}
.fa-sort-alpha-asc:before {
  content: "\f15d";
}
.fa-sort-alpha-desc:before {
  content: "\f15e";
}
.fa-sort-amount-asc:before {
  content: "\f160";
}
.fa-sort-amount-desc:before {
  content: "\f161";
}
.fa-sort-numeric-asc:before {
  content: "\f162";
}
.fa-sort-numeric-desc:before {
  content: "\f163";
}
.fa-thumbs-up:before {
  content: "\f164";
}
.fa-thumbs-down:before {
  content: "\f165";
}
.fa-youtube-square:before {
  content: "\f166";
}
.fa-youtube:before {
  content: "\f167";
}
.fa-xing:before {
  content: "\f168";
}
.fa-xing-square:before {
  content: "\f169";
}
.fa-youtube-play:before {
  content: "\f16a";
}
.fa-dropbox:before {
  content: "\f16b";
}
.fa-stack-overflow:before {
  content: "\f16c";
}
.fa-instagram:before {
  content: "\f16d";
}
.fa-flickr:before {
  content: "\f16e";
}
.fa-adn:before {
  content: "\f170";
}
.fa-bitbucket:before {
  content: "\f171";
}
.fa-bitbucket-square:before {
  content: "\f172";
}
.fa-tumblr:before {
  content: "\f173";
}
.fa-tumblr-square:before {
  content: "\f174";
}
.fa-long-arrow-down:before {
  content: "\f175";
}
.fa-long-arrow-up:before {
  content: "\f176";
}
.fa-long-arrow-left:before {
  content: "\f177";
}
.fa-long-arrow-right:before {
  content: "\f178";
}
.fa-apple:before {
  content: "\f179";
}
.fa-windows:before {
  content: "\f17a";
}
.fa-android:before {
  content: "\f17b";
}
.fa-linux:before {
  content: "\f17c";
}
.fa-dribbble:before {
  content: "\f17d";
}
.fa-skype:before {
  content: "\f17e";
}
.fa-foursquare:before {
  content: "\f180";
}
.fa-trello:before {
  content: "\f181";
}
.fa-female:before {
  content: "\f182";
}
.fa-male:before {
  content: "\f183";
}
.fa-gittip:before {
  content: "\f184";
}
.fa-sun-o:before {
  content: "\f185";
}
.fa-moon-o:before {
  content: "\f186";
}
.fa-archive:before {
  content: "\f187";
}
.fa-bug:before {
  content: "\f188";
}
.fa-vk:before {
  content: "\f189";
}
.fa-weibo:before {
  content: "\f18a";
}
.fa-renren:before {
  content: "\f18b";
}
.fa-pagelines:before {
  content: "\f18c";
}
.fa-stack-exchange:before {
  content: "\f18d";
}
.fa-arrow-circle-o-right:before {
  content: "\f18e";
}
.fa-arrow-circle-o-left:before {
  content: "\f190";
}
.fa-toggle-left:before,
.fa-caret-square-o-left:before {
  content: "\f191";
}
.fa-dot-circle-o:before {
  content: "\f192";
}
.fa-wheelchair:before {
  content: "\f193";
}
.fa-vimeo-square:before {
  content: "\f194";
}
.fa-turkish-lira:before,
.fa-try:before {
  content: "\f195";
}
.fa-plus-square-o:before {
  content: "\f196";
}
.fa-space-shuttle:before {
  content: "\f197";
}
.fa-slack:before {
  content: "\f198";
}
.fa-envelope-square:before {
  content: "\f199";
}
.fa-wordpress:before {
  content: "\f19a";
}
.fa-openid:before {
  content: "\f19b";
}
.fa-institution:before,
.fa-bank:before,
.fa-university:before {
  content: "\f19c";
}
.fa-mortar-board:before,
.fa-graduation-cap:before {
  content: "\f19d";
}
.fa-yahoo:before {
  content: "\f19e";
}
.fa-google:before {
  content: "\f1a0";
}
.fa-reddit:before {
  content: "\f1a1";
}
.fa-reddit-square:before {
  content: "\f1a2";
}
.fa-stumbleupon-circle:before {
  content: "\f1a3";
}
.fa-stumbleupon:before {
  content: "\f1a4";
}
.fa-delicious:before {
  content: "\f1a5";
}
.fa-digg:before {
  content: "\f1a6";
}
.fa-pied-piper:before {
  content: "\f1a7";
}
.fa-pied-piper-alt:before {
  content: "\f1a8";
}
.fa-drupal:before {
  content: "\f1a9";
}
.fa-joomla:before {
  content: "\f1aa";
}
.fa-language:before {
  content: "\f1ab";
}
.fa-fax:before {
  content: "\f1ac";
}
.fa-building:before {
  content: "\f1ad";
}
.fa-child:before {
  content: "\f1ae";
}
.fa-paw:before {
  content: "\f1b0";
}
.fa-spoon:before {
  content: "\f1b1";
}
.fa-cube:before {
  content: "\f1b2";
}
.fa-cubes:before {
  content: "\f1b3";
}
.fa-behance:before {
  content: "\f1b4";
}
.fa-behance-square:before {
  content: "\f1b5";
}
.fa-steam:before {
  content: "\f1b6";
}
.fa-steam-square:before {
  content: "\f1b7";
}
.fa-recycle:before {
  content: "\f1b8";
}
.fa-automobile:before,
.fa-car:before {
  content: "\f1b9";
}
.fa-cab:before,
.fa-taxi:before {
  content: "\f1ba";
}
.fa-tree:before {
  content: "\f1bb";
}
.fa-spotify:before {
  content: "\f1bc";
}
.fa-deviantart:before {
  content: "\f1bd";
}
.fa-soundcloud:before {
  content: "\f1be";
}
.fa-database:before {
  content: "\f1c0";
}
.fa-file-pdf-o:before {
  content: "\f1c1";
}
.fa-file-word-o:before {
  content: "\f1c2";
}
.fa-file-excel-o:before {
  content: "\f1c3";
}
.fa-file-powerpoint-o:before {
  content: "\f1c4";
}
.fa-file-photo-o:before,
.fa-file-picture-o:before,
.fa-file-image-o:before {
  content: "\f1c5";
}
.fa-file-zip-o:before,
.fa-file-archive-o:before {
  content: "\f1c6";
}
.fa-file-sound-o:before,
.fa-file-audio-o:before {
  content: "\f1c7";
}
.fa-file-movie-o:before,
.fa-file-video-o:before {
  content: "\f1c8";
}
.fa-file-code-o:before {
  content: "\f1c9";
}
.fa-vine:before {
  content: "\f1ca";
}
.fa-codepen:before {
  content: "\f1cb";
}
.fa-jsfiddle:before {
  content: "\f1cc";
}
.fa-life-bouy:before,
.fa-life-buoy:before,
.fa-life-saver:before,
.fa-support:before,
.fa-life-ring:before {
  content: "\f1cd";
}
.fa-circle-o-notch:before {
  content: "\f1ce";
}
.fa-ra:before,
.fa-rebel:before {
  content: "\f1d0";
}
.fa-ge:before,
.fa-empire:before {
  content: "\f1d1";
}
.fa-git-square:before {
  content: "\f1d2";
}
.fa-git:before {
  content: "\f1d3";
}
.fa-hacker-news:before {
  content: "\f1d4";
}
.fa-tencent-weibo:before {
  content: "\f1d5";
}
.fa-qq:before {
  content: "\f1d6";
}
.fa-wechat:before,
.fa-weixin:before {
  content: "\f1d7";
}
.fa-send:before,
.fa-paper-plane:before {
  content: "\f1d8";
}
.fa-send-o:before,
.fa-paper-plane-o:before {
  content: "\f1d9";
}
.fa-history:before {
  content: "\f1da";
}
.fa-circle-thin:before {
  content: "\f1db";
}
.fa-header:before {
  content: "\f1dc";
}
.fa-paragraph:before {
  content: "\f1dd";
}
.fa-sliders:before {
  content: "\f1de";
}
.fa-share-alt:before {
  content: "\f1e0";
}
.fa-share-alt-square:before {
  content: "\f1e1";
}
.fa-bomb:before {
  content: "\f1e2";
}
.fa-soccer-ball-o:before,
.fa-futbol-o:before {
  content: "\f1e3";
}
.fa-tty:before {
  content: "\f1e4";
}
.fa-binoculars:before {
  content: "\f1e5";
}
.fa-plug:before {
  content: "\f1e6";
}
.fa-slideshare:before {
  content: "\f1e7";
}
.fa-twitch:before {
  content: "\f1e8";
}
.fa-yelp:before {
  content: "\f1e9";
}
.fa-newspaper-o:before {
  content: "\f1ea";
}
.fa-wifi:before {
  content: "\f1eb";
}
.fa-calculator:before {
  content: "\f1ec";
}
.fa-paypal:before {
  content: "\f1ed";
}
.fa-google-wallet:before {
  content: "\f1ee";
}
.fa-cc-visa:before {
  content: "\f1f0";
}
.fa-cc-mastercard:before {
  content: "\f1f1";
}
.fa-cc-discover:before {
  content: "\f1f2";
}
.fa-cc-amex:before {
  content: "\f1f3";
}
.fa-cc-paypal:before {
  content: "\f1f4";
}
.fa-cc-stripe:before {
  content: "\f1f5";
}
.fa-bell-slash:before {
  content: "\f1f6";
}
.fa-bell-slash-o:before {
  content: "\f1f7";
}
.fa-trash:before {
  content: "\f1f8";
}
.fa-copyright:before {
  content: "\f1f9";
}
.fa-at:before {
  content: "\f1fa";
}
.fa-eyedropper:before {
  content: "\f1fb";
}
.fa-paint-brush:before {
  content: "\f1fc";
}
.fa-birthday-cake:before {
  content: "\f1fd";
}
.fa-area-chart:before {
  content: "\f1fe";
}
.fa-pie-chart:before {
  content: "\f200";
}
.fa-line-chart:before {
  content: "\f201";
}
.fa-lastfm:before {
  content: "\f202";
}
.fa-lastfm-square:before {
  content: "\f203";
}
.fa-toggle-off:before {
  content: "\f204";
}
.fa-toggle-on:before {
  content: "\f205";
}
.fa-bicycle:before {
  content: "\f206";
}
.fa-bus:before {
  content: "\f207";
}
.fa-ioxhost:before {
  content: "\f208";
}
.fa-angellist:before {
  content: "\f209";
}
.fa-cc:before {
  content: "\f20a";
}
.fa-shekel:before,
.fa-sheqel:before,
.fa-ils:before {
  content: "\f20b";
}
.fa-meanpath:before {
  content: "\f20c";
}
/*!
*
* IPython base
*
*/
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
code {
  color: #000;
}
pre {
  font-size: inherit;
  line-height: inherit;
}
label {
  font-weight: normal;
}
/* Make the page background atleast 100% the height of the view port */
/* Make the page itself atleast 70% the height of the view port */
.border-box-sizing {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.corner-all {
  border-radius: 2px;
}
.no-padding {
  padding: 0px;
}
/* Flexible box model classes */
/* Taken from Alex Russell http://infrequently.org/2009/08/css-3-progress/ */
/* This file is a compatability layer.  It allows the usage of flexible box 
model layouts accross multiple browsers, including older browsers.  The newest,
universal implementation of the flexible box model is used when available (see
`Modern browsers` comments below).  Browsers that are known to implement this 
new spec completely include:

    Firefox 28.0+
    Chrome 29.0+
    Internet Explorer 11+ 
    Opera 17.0+

Browsers not listed, including Safari, are supported via the styling under the
`Old browsers` comments below.
*/
.hbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
.hbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.vbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
.vbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.hbox.reverse,
.vbox.reverse,
.reverse {
  /* Old browsers */
  -webkit-box-direction: reverse;
  -moz-box-direction: reverse;
  box-direction: reverse;
  /* Modern browsers */
  flex-direction: row-reverse;
}
.hbox.box-flex0,
.vbox.box-flex0,
.box-flex0 {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
  width: auto;
}
.hbox.box-flex1,
.vbox.box-flex1,
.box-flex1 {
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex,
.vbox.box-flex,
.box-flex {
  /* Old browsers */
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex2,
.vbox.box-flex2,
.box-flex2 {
  /* Old browsers */
  -webkit-box-flex: 2;
  -moz-box-flex: 2;
  box-flex: 2;
  /* Modern browsers */
  flex: 2;
}
.box-group1 {
  /*  Deprecated */
  -webkit-box-flex-group: 1;
  -moz-box-flex-group: 1;
  box-flex-group: 1;
}
.box-group2 {
  /* Deprecated */
  -webkit-box-flex-group: 2;
  -moz-box-flex-group: 2;
  box-flex-group: 2;
}
.hbox.start,
.vbox.start,
.start {
  /* Old browsers */
  -webkit-box-pack: start;
  -moz-box-pack: start;
  box-pack: start;
  /* Modern browsers */
  justify-content: flex-start;
}
.hbox.end,
.vbox.end,
.end {
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
}
.hbox.center,
.vbox.center,
.center {
  /* Old browsers */
  -webkit-box-pack: center;
  -moz-box-pack: center;
  box-pack: center;
  /* Modern browsers */
  justify-content: center;
}
.hbox.baseline,
.vbox.baseline,
.baseline {
  /* Old browsers */
  -webkit-box-pack: baseline;
  -moz-box-pack: baseline;
  box-pack: baseline;
  /* Modern browsers */
  justify-content: baseline;
}
.hbox.stretch,
.vbox.stretch,
.stretch {
  /* Old browsers */
  -webkit-box-pack: stretch;
  -moz-box-pack: stretch;
  box-pack: stretch;
  /* Modern browsers */
  justify-content: stretch;
}
.hbox.align-start,
.vbox.align-start,
.align-start {
  /* Old browsers */
  -webkit-box-align: start;
  -moz-box-align: start;
  box-align: start;
  /* Modern browsers */
  align-items: flex-start;
}
.hbox.align-end,
.vbox.align-end,
.align-end {
  /* Old browsers */
  -webkit-box-align: end;
  -moz-box-align: end;
  box-align: end;
  /* Modern browsers */
  align-items: flex-end;
}
.hbox.align-center,
.vbox.align-center,
.align-center {
  /* Old browsers */
  -webkit-box-align: center;
  -moz-box-align: center;
  box-align: center;
  /* Modern browsers */
  align-items: center;
}
.hbox.align-baseline,
.vbox.align-baseline,
.align-baseline {
  /* Old browsers */
  -webkit-box-align: baseline;
  -moz-box-align: baseline;
  box-align: baseline;
  /* Modern browsers */
  align-items: baseline;
}
.hbox.align-stretch,
.vbox.align-stretch,
.align-stretch {
  /* Old browsers */
  -webkit-box-align: stretch;
  -moz-box-align: stretch;
  box-align: stretch;
  /* Modern browsers */
  align-items: stretch;
}
div.error {
  margin: 2em;
  text-align: center;
}
div.error > h1 {
  font-size: 500%;
  line-height: normal;
}
div.error > p {
  font-size: 200%;
  line-height: normal;
}
div.traceback-wrapper {
  text-align: left;
  max-width: 800px;
  margin: auto;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
body {
  background-color: #fff;
  /* This makes sure that the body covers the entire window and needs to
       be in a different element than the display: box in wrapper below */
  position: absolute;
  left: 0px;
  right: 0px;
  top: 0px;
  bottom: 0px;
  overflow: visible;
}
body > #header {
  /* Initially hidden to prevent FLOUC */
  display: none;
  background-color: #fff;
  /* Display over codemirror */
  position: relative;
  z-index: 100;
}
body > #header #header-container {
  padding-bottom: 5px;
  padding-top: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
body > #header .header-bar {
  width: 100%;
  height: 1px;
  background: #e7e7e7;
  margin-bottom: -1px;
}
@media print {
  body > #header {
    display: none !important;
  }
}
#header-spacer {
  width: 100%;
  visibility: hidden;
}
@media print {
  #header-spacer {
    display: none;
  }
}
#ipython_notebook {
  padding-left: 0px;
  padding-top: 1px;
  padding-bottom: 1px;
}
@media (max-width: 991px) {
  #ipython_notebook {
    margin-left: 10px;
  }
}
[dir="rtl"] #ipython_notebook {
  float: right !important;
}
#noscript {
  width: auto;
  padding-top: 16px;
  padding-bottom: 16px;
  text-align: center;
  font-size: 22px;
  color: red;
  font-weight: bold;
}
#ipython_notebook img {
  height: 28px;
}
#site {
  width: 100%;
  display: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  overflow: auto;
}
@media print {
  #site {
    height: auto !important;
  }
}
/* Smaller buttons */
.ui-button .ui-button-text {
  padding: 0.2em 0.8em;
  font-size: 77%;
}
input.ui-button {
  padding: 0.3em 0.9em;
}
span#login_widget {
  float: right;
}
span#login_widget > .button,
#logout {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button:focus,
#logout:focus,
span#login_widget > .button.focus,
#logout.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
span#login_widget > .button:hover,
#logout:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active:hover,
#logout:active:hover,
span#login_widget > .button.active:hover,
#logout.active:hover,
.open > .dropdown-togglespan#login_widget > .button:hover,
.open > .dropdown-toggle#logout:hover,
span#login_widget > .button:active:focus,
#logout:active:focus,
span#login_widget > .button.active:focus,
#logout.active:focus,
.open > .dropdown-togglespan#login_widget > .button:focus,
.open > .dropdown-toggle#logout:focus,
span#login_widget > .button:active.focus,
#logout:active.focus,
span#login_widget > .button.active.focus,
#logout.active.focus,
.open > .dropdown-togglespan#login_widget > .button.focus,
.open > .dropdown-toggle#logout.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  background-image: none;
}
span#login_widget > .button.disabled:hover,
#logout.disabled:hover,
span#login_widget > .button[disabled]:hover,
#logout[disabled]:hover,
fieldset[disabled] span#login_widget > .button:hover,
fieldset[disabled] #logout:hover,
span#login_widget > .button.disabled:focus,
#logout.disabled:focus,
span#login_widget > .button[disabled]:focus,
#logout[disabled]:focus,
fieldset[disabled] span#login_widget > .button:focus,
fieldset[disabled] #logout:focus,
span#login_widget > .button.disabled.focus,
#logout.disabled.focus,
span#login_widget > .button[disabled].focus,
#logout[disabled].focus,
fieldset[disabled] span#login_widget > .button.focus,
fieldset[disabled] #logout.focus {
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button .badge,
#logout .badge {
  color: #fff;
  background-color: #333;
}
.nav-header {
  text-transform: none;
}
#header > span {
  margin-top: 10px;
}
.modal_stretch .modal-dialog {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  min-height: 80vh;
}
.modal_stretch .modal-dialog .modal-body {
  max-height: calc(100vh - 200px);
  overflow: auto;
  flex: 1;
}
@media (min-width: 768px) {
  .modal .modal-dialog {
    width: 700px;
  }
}
@media (min-width: 768px) {
  select.form-control {
    margin-left: 12px;
    margin-right: 12px;
  }
}
/*!
*
* IPython auth
*
*/
.center-nav {
  display: inline-block;
  margin-bottom: -4px;
}
/*!
*
* IPython tree view
*
*/
/* We need an invisible input field on top of the sentense*/
/* "Drag file onto the list ..." */
.alternate_upload {
  background-color: none;
  display: inline;
}
.alternate_upload.form {
  padding: 0;
  margin: 0;
}
.alternate_upload input.fileinput {
  text-align: center;
  vertical-align: middle;
  display: inline;
  opacity: 0;
  z-index: 2;
  width: 12ex;
  margin-right: -12ex;
}
.alternate_upload .btn-upload {
  height: 22px;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
[dir="rtl"] #tabs li {
  float: right;
}
ul#tabs {
  margin-bottom: 4px;
}
[dir="rtl"] ul#tabs {
  margin-right: 0px;
}
ul#tabs a {
  padding-top: 6px;
  padding-bottom: 4px;
}
ul.breadcrumb a:focus,
ul.breadcrumb a:hover {
  text-decoration: none;
}
ul.breadcrumb i.icon-home {
  font-size: 16px;
  margin-right: 4px;
}
ul.breadcrumb span {
  color: #5e5e5e;
}
.list_toolbar {
  padding: 4px 0 4px 0;
  vertical-align: middle;
}
.list_toolbar .tree-buttons {
  padding-top: 1px;
}
[dir="rtl"] .list_toolbar .tree-buttons {
  float: left !important;
}
[dir="rtl"] .list_toolbar .pull-right {
  padding-top: 1px;
  float: left !important;
}
[dir="rtl"] .list_toolbar .pull-left {
  float: right !important;
}
.dynamic-buttons {
  padding-top: 3px;
  display: inline-block;
}
.list_toolbar [class*="span"] {
  min-height: 24px;
}
.list_header {
  font-weight: bold;
  background-color: #EEE;
}
.list_placeholder {
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
}
.list_container {
  margin-top: 4px;
  margin-bottom: 20px;
  border: 1px solid #ddd;
  border-radius: 2px;
}
.list_container > div {
  border-bottom: 1px solid #ddd;
}
.list_container > div:hover .list-item {
  background-color: red;
}
.list_container > div:last-child {
  border: none;
}
.list_item:hover .list_item {
  background-color: #ddd;
}
.list_item a {
  text-decoration: none;
}
.list_item:hover {
  background-color: #fafafa;
}
.list_header > div,
.list_item > div {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
.list_header > div input,
.list_item > div input {
  margin-right: 7px;
  margin-left: 14px;
  vertical-align: baseline;
  line-height: 22px;
  position: relative;
  top: -1px;
}
.list_header > div .item_link,
.list_item > div .item_link {
  margin-left: -1px;
  vertical-align: baseline;
  line-height: 22px;
}
.new-file input[type=checkbox] {
  visibility: hidden;
}
.item_name {
  line-height: 22px;
  height: 24px;
}
.item_icon {
  font-size: 14px;
  color: #5e5e5e;
  margin-right: 7px;
  margin-left: 7px;
  line-height: 22px;
  vertical-align: baseline;
}
.item_buttons {
  line-height: 1em;
  margin-left: -5px;
}
.item_buttons .btn,
.item_buttons .btn-group,
.item_buttons .input-group {
  float: left;
}
.item_buttons > .btn,
.item_buttons > .btn-group,
.item_buttons > .input-group {
  margin-left: 5px;
}
.item_buttons .btn {
  min-width: 13ex;
}
.item_buttons .running-indicator {
  padding-top: 4px;
  color: #5cb85c;
}
.item_buttons .kernel-name {
  padding-top: 4px;
  color: #5bc0de;
  margin-right: 7px;
  float: left;
}
.toolbar_info {
  height: 24px;
  line-height: 24px;
}
.list_item input:not([type=checkbox]) {
  padding-top: 3px;
  padding-bottom: 3px;
  height: 22px;
  line-height: 14px;
  margin: 0px;
}
.highlight_text {
  color: blue;
}
#project_name {
  display: inline-block;
  padding-left: 7px;
  margin-left: -2px;
}
#project_name > .breadcrumb {
  padding: 0px;
  margin-bottom: 0px;
  background-color: transparent;
  font-weight: bold;
}
#tree-selector {
  padding-right: 0px;
}
[dir="rtl"] #tree-selector a {
  float: right;
}
#button-select-all {
  min-width: 50px;
}
#select-all {
  margin-left: 7px;
  margin-right: 2px;
}
.menu_icon {
  margin-right: 2px;
}
.tab-content .row {
  margin-left: 0px;
  margin-right: 0px;
}
.folder_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f114";
}
.folder_icon:before.pull-left {
  margin-right: .3em;
}
.folder_icon:before.pull-right {
  margin-left: .3em;
}
.notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
}
.notebook_icon:before.pull-left {
  margin-right: .3em;
}
.notebook_icon:before.pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
  color: #5cb85c;
}
.running_notebook_icon:before.pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.pull-right {
  margin-left: .3em;
}
.file_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f016";
  position: relative;
  top: -2px;
}
.file_icon:before.pull-left {
  margin-right: .3em;
}
.file_icon:before.pull-right {
  margin-left: .3em;
}
#notebook_toolbar .pull-right {
  padding-top: 0px;
  margin-right: -1px;
}
ul#new-menu {
  left: auto;
  right: 0;
}
[dir="rtl"] #new-menu {
  text-align: right;
}
.kernel-menu-icon {
  padding-right: 12px;
  width: 24px;
  content: "\f096";
}
.kernel-menu-icon:before {
  content: "\f096";
}
.kernel-menu-icon-current:before {
  content: "\f00c";
}
#tab_content {
  padding-top: 20px;
}
#running .panel-group .panel {
  margin-top: 3px;
  margin-bottom: 1em;
}
#running .panel-group .panel .panel-heading {
  background-color: #EEE;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
#running .panel-group .panel .panel-heading a:focus,
#running .panel-group .panel .panel-heading a:hover {
  text-decoration: none;
}
#running .panel-group .panel .panel-body {
  padding: 0px;
}
#running .panel-group .panel .panel-body .list_container {
  margin-top: 0px;
  margin-bottom: 0px;
  border: 0px;
  border-radius: 0px;
}
#running .panel-group .panel .panel-body .list_container .list_item {
  border-bottom: 1px solid #ddd;
}
#running .panel-group .panel .panel-body .list_container .list_item:last-child {
  border-bottom: 0px;
}
[dir="rtl"] #running .col-sm-8 {
  float: right !important;
}
.delete-button {
  display: none;
}
.duplicate-button {
  display: none;
}
.rename-button {
  display: none;
}
.shutdown-button {
  display: none;
}
.dynamic-instructions {
  display: inline-block;
  padding-top: 4px;
}
/*!
*
* IPython text editor webapp
*
*/
.selected-keymap i.fa {
  padding: 0px 5px;
}
.selected-keymap i.fa:before {
  content: "\f00c";
}
#mode-menu {
  overflow: auto;
  max-height: 20em;
}
.edit_app #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.edit_app #menubar .navbar {
  /* Use a negative 1 bottom margin, so the border overlaps the border of the
    header */
  margin-bottom: -1px;
}
.dirty-indicator {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator.pull-left {
  margin-right: .3em;
}
.dirty-indicator.pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-dirty.pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-clean.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f00c";
}
.dirty-indicator-clean:before.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.pull-right {
  margin-left: .3em;
}
#filename {
  font-size: 16pt;
  display: table;
  padding: 0px 5px;
}
#current-mode {
  padding-left: 5px;
  padding-right: 5px;
}
#texteditor-backdrop {
  padding-top: 20px;
  padding-bottom: 20px;
}
@media not print {
  #texteditor-backdrop {
    background-color: #EEE;
  }
}
@media print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container {
    padding: 0px;
    background-color: #fff;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area .rendered_html table {
  margin-left: 0;
  margin-right: 0;
}
div.output_area .rendered_html img {
  margin-left: 0;
  margin-right: 0;
}
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}
.rendered_html em {
  font-style: italic;
}
.rendered_html strong {
  font-weight: bold;
}
.rendered_html u {
  text-decoration: underline;
}
.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}
.rendered_html h1 {
  font-size: 185.7%;
  margin: 1.08em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h2 {
  font-size: 157.1%;
  margin: 1.27em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h3 {
  font-size: 128.6%;
  margin: 1.55em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h4 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h5 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h6 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul {
  list-style: disc;
  margin: 0em 2em;
  padding-left: 0px;
}
.rendered_html ul ul {
  list-style: square;
  margin: 0em 2em;
}
.rendered_html ul ul ul {
  list-style: circle;
  margin: 0em 2em;
}
.rendered_html ol {
  list-style: decimal;
  margin: 0em 2em;
  padding-left: 0px;
}
.rendered_html ol ol {
  list-style: upper-alpha;
  margin: 0em 2em;
}
.rendered_html ol ol ol {
  list-style: lower-alpha;
  margin: 0em 2em;
}
.rendered_html ol ol ol ol {
  list-style: lower-roman;
  margin: 0em 2em;
}
.rendered_html ol ol ol ol ol {
  list-style: decimal;
  margin: 0em 2em;
}
.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}
.rendered_html hr {
  color: black;
  background-color: black;
}
.rendered_html pre {
  margin: 1em 2em;
}
.rendered_html pre,
.rendered_html code {
  border: 0;
  background-color: #fff;
  color: #000;
  font-size: 100%;
  padding: 0px;
}
.rendered_html blockquote {
  margin: 1em 2em;
}
.rendered_html table {
  margin-left: auto;
  margin-right: auto;
  border: 1px solid black;
  border-collapse: collapse;
}
.rendered_html tr,
.rendered_html th,
.rendered_html td {
  border: 1px solid black;
  border-collapse: collapse;
  margin: 1em 2em;
}
.rendered_html td,
.rendered_html th {
  text-align: left;
  vertical-align: middle;
  padding: 4px;
}
.rendered_html th {
  font-weight: bold;
}
.rendered_html * + table {
  margin-top: 1em;
}
.rendered_html p {
  text-align: left;
}
.rendered_html * + p {
  margin-top: 1em;
}
.rendered_html img {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,
.rendered_html svg {
  max-width: 100%;
  height: auto;
}
.rendered_html img.unconfined,
.rendered_html svg.unconfined {
  max-width: none;
}
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered .rendered_html {
  overflow-x: auto;
  overflow-y: hidden;
}
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
/*!
*
* IPython notebook webapp
*
*/
@media (max-width: 767px) {
  .notebook_app {
    padding-left: 0px;
    padding-right: 0px;
  }
}
#ipython-main-app {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook_panel {
  margin: 0px;
  padding: 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook {
  font-size: 14px;
  line-height: 20px;
  overflow-y: hidden;
  overflow-x: auto;
  width: 100%;
  /* This spaces the page away from the edge of the notebook area */
  padding-top: 20px;
  margin: 0px;
  outline: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  min-height: 100%;
}
@media not print {
  #notebook-container {
    padding: 15px;
    background-color: #fff;
    min-height: 0;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
@media print {
  #notebook-container {
    width: 100%;
  }
}
div.ui-widget-content {
  border: 1px solid #ababab;
  outline: none;
}
pre.dialog {
  background-color: #f7f7f7;
  border: 1px solid #ddd;
  border-radius: 2px;
  padding: 0.4em;
  padding-left: 2em;
}
p.dialog {
  padding: 0.2em;
}
/* Word-wrap output correctly.  This is the CSS3 spelling, though Firefox seems
   to not honor it correctly.  Webkit browsers (Chrome, rekonq, Safari) do.
 */
pre,
code,
kbd,
samp {
  white-space: pre-wrap;
}
#fonttest {
  font-family: monospace;
}
p {
  margin-bottom: 0;
}
.end_space {
  min-height: 100px;
  transition: height .2s ease;
}
.notebook_app > #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
@media not print {
  .notebook_app {
    background-color: #EEE;
  }
}
kbd {
  border-style: solid;
  border-width: 1px;
  box-shadow: none;
  margin: 2px;
  padding-left: 2px;
  padding-right: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
/* CSS for the cell toolbar */
.celltoolbar {
  border: thin solid #CFCFCF;
  border-bottom: none;
  background: #EEE;
  border-radius: 2px 2px 0px 0px;
  width: 100%;
  height: 29px;
  padding-right: 4px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
  display: -webkit-flex;
}
@media print {
  .celltoolbar {
    display: none;
  }
}
.ctb_hideshow {
  display: none;
  vertical-align: bottom;
}
/* ctb_show is added to the ctb_hideshow div to show the cell toolbar.
   Cell toolbars are only shown when the ctb_global_show class is also set.
*/
.ctb_global_show .ctb_show.ctb_hideshow {
  display: block;
}
.ctb_global_show .ctb_show + .input_area,
.ctb_global_show .ctb_show + div.text_cell_input,
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border-top-right-radius: 0px;
  border-top-left-radius: 0px;
}
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border: 1px solid #cfcfcf;
}
.celltoolbar {
  font-size: 87%;
  padding-top: 3px;
}
.celltoolbar select {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  width: inherit;
  font-size: inherit;
  height: 22px;
  padding: 0px;
  display: inline-block;
}
.celltoolbar select:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.celltoolbar select::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.celltoolbar select:-ms-input-placeholder {
  color: #999;
}
.celltoolbar select::-webkit-input-placeholder {
  color: #999;
}
.celltoolbar select::-ms-expand {
  border: 0;
  background-color: transparent;
}
.celltoolbar select[disabled],
.celltoolbar select[readonly],
fieldset[disabled] .celltoolbar select {
  background-color: #eeeeee;
  opacity: 1;
}
.celltoolbar select[disabled],
fieldset[disabled] .celltoolbar select {
  cursor: not-allowed;
}
textarea.celltoolbar select {
  height: auto;
}
select.celltoolbar select {
  height: 30px;
  line-height: 30px;
}
textarea.celltoolbar select,
select[multiple].celltoolbar select {
  height: auto;
}
.celltoolbar label {
  margin-left: 5px;
  margin-right: 5px;
}
.completions {
  position: absolute;
  z-index: 110;
  overflow: hidden;
  border: 1px solid #ababab;
  border-radius: 2px;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  line-height: 1;
}
.completions select {
  background: white;
  outline: none;
  border: none;
  padding: 0px;
  margin: 0px;
  overflow: auto;
  font-family: monospace;
  font-size: 110%;
  color: #000;
  width: auto;
}
.completions select option.context {
  color: #286090;
}
#kernel_logo_widget {
  float: right !important;
  float: right;
}
#kernel_logo_widget .current_kernel_logo {
  display: none;
  margin-top: -1px;
  margin-bottom: -1px;
  width: 32px;
  height: 32px;
}
#menubar {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  margin-top: 1px;
}
#menubar .navbar {
  border-top: 1px;
  border-radius: 0px 0px 2px 2px;
  margin-bottom: 0px;
}
#menubar .navbar-toggle {
  float: left;
  padding-top: 7px;
  padding-bottom: 7px;
  border: none;
}
#menubar .navbar-collapse {
  clear: left;
}
.nav-wrapper {
  border-bottom: 1px solid #e7e7e7;
}
i.menu-icon {
  padding-top: 4px;
}
ul#help_menu li a {
  overflow: hidden;
  padding-right: 2.2em;
}
ul#help_menu li a i {
  margin-right: -1.2em;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu > .dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
}
.dropdown-submenu:hover > .dropdown-menu {
  display: block;
}
.dropdown-submenu > a:after {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: block;
  content: "\f0da";
  float: right;
  color: #333333;
  margin-top: 2px;
  margin-right: -10px;
}
.dropdown-submenu > a:after.pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.pull-right {
  margin-left: .3em;
}
.dropdown-submenu:hover > a:after {
  color: #262626;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left > .dropdown-menu {
  left: -100%;
  margin-left: 10px;
}
#notification_area {
  float: right !important;
  float: right;
  z-index: 10;
}
.indicator_area {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
#kernel_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  border-left: 1px solid;
}
#kernel_indicator .kernel_indicator_name {
  padding-left: 5px;
  padding-right: 5px;
}
#modal_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
#readonly-indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  margin-top: 2px;
  margin-bottom: 0px;
  margin-left: 0px;
  margin-right: 0px;
  display: none;
}
.modal_indicator:before {
  width: 1.28571429em;
  text-align: center;
}
.edit_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f040";
}
.edit_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: ' ';
}
.command_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f10c";
}
.kernel_idle_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f111";
}
.kernel_busy_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f1e2";
}
.kernel_dead_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f127";
}
.kernel_disconnected_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.pull-right {
  margin-left: .3em;
}
.notification_widget {
  color: #777;
  z-index: 10;
  background: rgba(240, 240, 240, 0.5);
  margin-right: 4px;
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget:focus,
.notification_widget.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.notification_widget:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active:hover,
.notification_widget.active:hover,
.open > .dropdown-toggle.notification_widget:hover,
.notification_widget:active:focus,
.notification_widget.active:focus,
.open > .dropdown-toggle.notification_widget:focus,
.notification_widget:active.focus,
.notification_widget.active.focus,
.open > .dropdown-toggle.notification_widget.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  background-image: none;
}
.notification_widget.disabled:hover,
.notification_widget[disabled]:hover,
fieldset[disabled] .notification_widget:hover,
.notification_widget.disabled:focus,
.notification_widget[disabled]:focus,
fieldset[disabled] .notification_widget:focus,
.notification_widget.disabled.focus,
.notification_widget[disabled].focus,
fieldset[disabled] .notification_widget.focus {
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget .badge {
  color: #fff;
  background-color: #333;
}
.notification_widget.warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning:focus,
.notification_widget.warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.notification_widget.warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active:hover,
.notification_widget.warning.active:hover,
.open > .dropdown-toggle.notification_widget.warning:hover,
.notification_widget.warning:active:focus,
.notification_widget.warning.active:focus,
.open > .dropdown-toggle.notification_widget.warning:focus,
.notification_widget.warning:active.focus,
.notification_widget.warning.active.focus,
.open > .dropdown-toggle.notification_widget.warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  background-image: none;
}
.notification_widget.warning.disabled:hover,
.notification_widget.warning[disabled]:hover,
fieldset[disabled] .notification_widget.warning:hover,
.notification_widget.warning.disabled:focus,
.notification_widget.warning[disabled]:focus,
fieldset[disabled] .notification_widget.warning:focus,
.notification_widget.warning.disabled.focus,
.notification_widget.warning[disabled].focus,
fieldset[disabled] .notification_widget.warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.notification_widget.success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success:focus,
.notification_widget.success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.notification_widget.success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active:hover,
.notification_widget.success.active:hover,
.open > .dropdown-toggle.notification_widget.success:hover,
.notification_widget.success:active:focus,
.notification_widget.success.active:focus,
.open > .dropdown-toggle.notification_widget.success:focus,
.notification_widget.success:active.focus,
.notification_widget.success.active.focus,
.open > .dropdown-toggle.notification_widget.success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  background-image: none;
}
.notification_widget.success.disabled:hover,
.notification_widget.success[disabled]:hover,
fieldset[disabled] .notification_widget.success:hover,
.notification_widget.success.disabled:focus,
.notification_widget.success[disabled]:focus,
fieldset[disabled] .notification_widget.success:focus,
.notification_widget.success.disabled.focus,
.notification_widget.success[disabled].focus,
fieldset[disabled] .notification_widget.success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.notification_widget.info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info:focus,
.notification_widget.info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.notification_widget.info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active:hover,
.notification_widget.info.active:hover,
.open > .dropdown-toggle.notification_widget.info:hover,
.notification_widget.info:active:focus,
.notification_widget.info.active:focus,
.open > .dropdown-toggle.notification_widget.info:focus,
.notification_widget.info:active.focus,
.notification_widget.info.active.focus,
.open > .dropdown-toggle.notification_widget.info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  background-image: none;
}
.notification_widget.info.disabled:hover,
.notification_widget.info[disabled]:hover,
fieldset[disabled] .notification_widget.info:hover,
.notification_widget.info.disabled:focus,
.notification_widget.info[disabled]:focus,
fieldset[disabled] .notification_widget.info:focus,
.notification_widget.info.disabled.focus,
.notification_widget.info[disabled].focus,
fieldset[disabled] .notification_widget.info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.notification_widget.danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger:focus,
.notification_widget.danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.notification_widget.danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active:hover,
.notification_widget.danger.active:hover,
.open > .dropdown-toggle.notification_widget.danger:hover,
.notification_widget.danger:active:focus,
.notification_widget.danger.active:focus,
.open > .dropdown-toggle.notification_widget.danger:focus,
.notification_widget.danger:active.focus,
.notification_widget.danger.active.focus,
.open > .dropdown-toggle.notification_widget.danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  background-image: none;
}
.notification_widget.danger.disabled:hover,
.notification_widget.danger[disabled]:hover,
fieldset[disabled] .notification_widget.danger:hover,
.notification_widget.danger.disabled:focus,
.notification_widget.danger[disabled]:focus,
fieldset[disabled] .notification_widget.danger:focus,
.notification_widget.danger.disabled.focus,
.notification_widget.danger[disabled].focus,
fieldset[disabled] .notification_widget.danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger .badge {
  color: #d9534f;
  background-color: #fff;
}
div#pager {
  background-color: #fff;
  font-size: 14px;
  line-height: 20px;
  overflow: hidden;
  display: none;
  position: fixed;
  bottom: 0px;
  width: 100%;
  max-height: 50%;
  padding-top: 8px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  /* Display over codemirror */
  z-index: 100;
  /* Hack which prevents jquery ui resizable from changing top. */
  top: auto !important;
}
div#pager pre {
  line-height: 1.21429em;
  color: #000;
  background-color: #f7f7f7;
  padding: 0.4em;
}
div#pager #pager-button-area {
  position: absolute;
  top: 8px;
  right: 20px;
}
div#pager #pager-contents {
  position: relative;
  overflow: auto;
  width: 100%;
  height: 100%;
}
div#pager #pager-contents #pager-container {
  position: relative;
  padding: 15px 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
div#pager .ui-resizable-handle {
  top: 0px;
  height: 8px;
  background: #f7f7f7;
  border-top: 1px solid #cfcfcf;
  border-bottom: 1px solid #cfcfcf;
  /* This injects handle bars (a short, wide = symbol) for 
        the resize handle. */
}
div#pager .ui-resizable-handle::after {
  content: '';
  top: 2px;
  left: 50%;
  height: 3px;
  width: 30px;
  margin-left: -15px;
  position: absolute;
  border-top: 1px solid #cfcfcf;
}
.quickhelp {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  line-height: 1.8em;
}
.shortcut_key {
  display: inline-block;
  width: 21ex;
  text-align: right;
  font-family: monospace;
}
.shortcut_descr {
  display: inline-block;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
span.save_widget {
  margin-top: 6px;
}
span.save_widget span.filename {
  height: 1em;
  line-height: 1em;
  padding: 3px;
  margin-left: 16px;
  border: none;
  font-size: 146.5%;
  border-radius: 2px;
}
span.save_widget span.filename:hover {
  background-color: #e6e6e6;
}
span.checkpoint_status,
span.autosave_status {
  font-size: small;
}
@media (max-width: 767px) {
  span.save_widget {
    font-size: small;
  }
  span.checkpoint_status,
  span.autosave_status {
    display: none;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  span.checkpoint_status {
    display: none;
  }
  span.autosave_status {
    font-size: x-small;
  }
}
.toolbar {
  padding: 0px;
  margin-left: -5px;
  margin-top: 2px;
  margin-bottom: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.toolbar select,
.toolbar label {
  width: auto;
  vertical-align: middle;
  margin-right: 2px;
  margin-bottom: 0px;
  display: inline;
  font-size: 92%;
  margin-left: 0.3em;
  margin-right: 0.3em;
  padding: 0px;
  padding-top: 3px;
}
.toolbar .btn {
  padding: 2px 8px;
}
.toolbar .btn-group {
  margin-top: 0px;
  margin-left: 5px;
}
#maintoolbar {
  margin-bottom: -3px;
  margin-top: -8px;
  border: 0px;
  min-height: 27px;
  margin-left: 0px;
  padding-top: 11px;
  padding-bottom: 3px;
}
#maintoolbar .navbar-text {
  float: none;
  vertical-align: middle;
  text-align: right;
  margin-left: 5px;
  margin-right: 0px;
  margin-top: 0px;
}
.select-xs {
  height: 24px;
}
.pulse,
.dropdown-menu > li > a.pulse,
li.pulse > a.dropdown-toggle,
li.pulse.open > a.dropdown-toggle {
  background-color: #F37626;
  color: white;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
/** WARNING IF YOU ARE EDITTING THIS FILE, if this is a .css file, It has a lot
 * of chance of beeing generated from the ../less/[samename].less file, you can
 * try to get back the less file by reverting somme commit in history
 **/
/*
 * We'll try to get something pretty, so we
 * have some strange css to have the scroll bar on
 * the left with fix button on the top right of the tooltip
 */
@-moz-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-webkit-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-moz-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
/*properties of tooltip after "expand"*/
.bigtooltip {
  overflow: auto;
  height: 200px;
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
}
/*properties of tooltip before "expand"*/
.smalltooltip {
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
  text-overflow: ellipsis;
  overflow: hidden;
  height: 80px;
}
.tooltipbuttons {
  position: absolute;
  padding-right: 15px;
  top: 0px;
  right: 0px;
}
.tooltiptext {
  /*avoid the button to overlap on some docstring*/
  padding-right: 30px;
}
.ipython_tooltip {
  max-width: 700px;
  /*fade-in animation when inserted*/
  -webkit-animation: fadeOut 400ms;
  -moz-animation: fadeOut 400ms;
  animation: fadeOut 400ms;
  -webkit-animation: fadeIn 400ms;
  -moz-animation: fadeIn 400ms;
  animation: fadeIn 400ms;
  vertical-align: middle;
  background-color: #f7f7f7;
  overflow: visible;
  border: #ababab 1px solid;
  outline: none;
  padding: 3px;
  margin: 0px;
  padding-left: 7px;
  font-family: monospace;
  min-height: 50px;
  -moz-box-shadow: 0px 6px 10px -1px #adadad;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
}
.ipython_tooltip a {
  float: right;
}
.ipython_tooltip .tooltiptext pre {
  border: 0;
  border-radius: 0;
  font-size: 100%;
  background-color: #f7f7f7;
}
.pretooltiparrow {
  left: 0px;
  margin: 0px;
  top: -16px;
  width: 40px;
  height: 16px;
  overflow: hidden;
  position: absolute;
}
.pretooltiparrow:before {
  background-color: #f7f7f7;
  border: 1px #ababab solid;
  z-index: 11;
  content: "";
  position: absolute;
  left: 15px;
  top: 10px;
  width: 25px;
  height: 25px;
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  -o-transform: rotate(45deg);
}
ul.typeahead-list i {
  margin-left: -10px;
  width: 18px;
}
ul.typeahead-list {
  max-height: 80vh;
  overflow: auto;
}
ul.typeahead-list > li > a {
  /** Firefox bug **/
  /* see https://github.com/jupyter/notebook/issues/559 */
  white-space: normal;
}
.cmd-palette .modal-body {
  padding: 7px;
}
.cmd-palette form {
  background: white;
}
.cmd-palette input {
  outline: none;
}
.no-shortcut {
  display: none;
}
.command-shortcut:before {
  content: "(command)";
  padding-right: 3px;
  color: #777777;
}
.edit-shortcut:before {
  content: "(edit)";
  padding-right: 3px;
  color: #777777;
}
#find-and-replace #replace-preview .match,
#find-and-replace #replace-preview .insert {
  background-color: #BBDEFB;
  border-color: #90CAF9;
  border-style: solid;
  border-width: 1px;
  border-radius: 0px;
}
#find-and-replace #replace-preview .replace .match {
  background-color: #FFCDD2;
  border-color: #EF9A9A;
  border-radius: 0px;
}
#find-and-replace #replace-preview .replace .insert {
  background-color: #C8E6C9;
  border-color: #A5D6A7;
  border-radius: 0px;
}
#find-and-replace #replace-preview {
  max-height: 60vh;
  overflow: auto;
}
#find-and-replace #replace-preview pre {
  padding: 5px 10px;
}
.terminal-app {
  background: #EEE;
}
.terminal-app #header {
  background: #fff;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.terminal-app .terminal {
  width: 100%;
  float: left;
  font-family: monospace;
  color: white;
  background: black;
  padding: 0.4em;
  border-radius: 2px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
}
.terminal-app .terminal,
.terminal-app .terminal dummy-screen {
  line-height: 1em;
  font-size: 14px;
}
.terminal-app .terminal .xterm-rows {
  padding: 10px;
}
.terminal-app .terminal-cursor {
  color: black;
  background: white;
}
.terminal-app #terminado-container {
  margin-top: 20px;
}
/*# sourceMappingURL=style.min.css.map */
    </style>
<style type="text/css">
    .highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
<style type="text/css">
    
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

    </style>


<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>

 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.css">

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>

<link rel="stylesheet" type="text/css" href="https://rawgit.com/ipython-contrib/jupyter_contrib_nbextensions/master/src/jupyter_contrib_nbextensions/nbextensions/toc2/main.css">

<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<script src="https://rawgit.com/ipython-contrib/jupyter_contrib_nbextensions/master/src/jupyter_contrib_nbextensions/nbextensions/toc2/toc2.js"></script>

<script>
$( document ).ready(function(){

            var cfg = {"base_numbering": 1, "nav_menu": {}, "number_sections": true, "sideBar": true, "skip_h1_title": true, "title_cell": "Table of Contents", "title_sidebar": "Contents", "toc_cell": true, "toc_position": {}, "toc_section_display": true, "toc_window_display": false};

            // fire the main function with these parameters
            require(['nbextensions/toc2/toc2'], function (toc2) {
                toc2.table_of_contents(cfg);
            });
    });
</script>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Titanic:-Machine-Learning-from-Disaster---Kaggle-Copetitions">Titanic: Machine Learning from Disaster - Kaggle Copetitions<a class="anchor-link" href="#Titanic:-Machine-Learning-from-Disaster---Kaggle-Copetitions">&#182;</a></h1><p><a href="https://chroniclingamerica.loc.gov/lccn/sn83030214/1912-04-16/ed-1/seq-1/"><img height="5" width="800" src=http://www.loc.gov/teachers/classroommaterials/lessons/titanic/images/section_header.jpg></a></p>
<p><strong>Introduction</strong>:</p>
<p>Kaggle challenges us to learn data analysis and machine learning from the data the <a href="https://youtu.be/zKoLEfgn4LI">Titanic shipwreck</a>, and try predict survival and get familiar with ML basics.</p>
<p>So, this material is intended to cover most of the techniques of data analysis and ML in Python, than to properly compete in Kaggle. That is why it following the natural flow of ML and contains many texts and links regarding the techniques, made your conference and references easy. as it can be extended over time.</p>
<p>In this way the material can be used for consultation and apply the methods to other similar classification cases, but for its application in the competition, or even to a real case, it will be necessary to make some choices and changes.</p>
<p><strong>Competition Description</strong>:</p>
<p>The sinking of the RMS Titanic is one of the most infamous shipwrecks in history.  On April 15, 1912, during her maiden voyage, the Titanic sank after colliding with an iceberg, killing 1502 out of 2224 passengers and crew. This sensational tragedy shocked the international community and led to better safety regulations for ships.</p>
<p>One of the reasons that the shipwreck led to such loss of life was that there were not enough lifeboats for the passengers and crew. Although there was some element of luck involved in surviving the sinking, some groups of people were more likely to survive than others, such as women, children, and the upper-class.</p>
<p>In this challenge, <a href="https://www.kaggle.com/c/titanic">Kaggle</a> ask you to complete the analysis of what sorts of people were likely to survive. In particular, they ask you to apply the tools of machine learning to predict which passengers survived the tragedy.</p>
<p><a href="https://www.youtube.com/watch?v=05o7sOAjtXE"><img src=https://www.tricurioso.com/wp-content/uploads/2018/06/historia-real-amor-titanic-tricurioso-1-655x400.jpg></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h1>Table of Contents<span class="tocSkip"></span></h1></p>
<div class="toc"><ul class="toc-item"><li><span><a href="#Preparing-environment-and-uploading-data" data-toc-modified-id="Preparing-environment-and-uploading-data-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Preparing environment and uploading data</a></span><ul class="toc-item"><li><span><a href="#Import-Packages" data-toc-modified-id="Import-Packages-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Import Packages</a></span></li><li><span><a href="#Load-Datastes" data-toc-modified-id="Load-Datastes-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Load Datastes</a></span></li></ul></li><li><span><a href="#Exploratory-Data-Analysis-(EDA)-&amp;-Feature-Engeniring" data-toc-modified-id="Exploratory-Data-Analysis-(EDA)-&amp;-Feature-Engeniring-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Exploratory Data Analysis (EDA) &amp; Feature Engeniring</a></span><ul class="toc-item"><li><span><a href="#Take-a-First-Look-of-our-Data:" data-toc-modified-id="Take-a-First-Look-of-our-Data:-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>Take a First Look of our Data:</a></span></li><li><span><a href="#First-see-of-some-stats-of-Numeric-Data" data-toc-modified-id="First-see-of-some-stats-of-Numeric-Data-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>First see of some stats of Numeric Data</a></span></li><li><span><a href="#EDA-and-Feature-Enginiring-by-Feature" data-toc-modified-id="EDA-and-Feature-Enginiring-by-Feature-2.3"><span class="toc-item-num">2.3&nbsp;&nbsp;</span>EDA and Feature Enginiring by Feature</a></span><ul class="toc-item"><li><span><a href="#Standard-Data-Visualization-for-Discret-or-Bining-Data" data-toc-modified-id="Standard-Data-Visualization-for-Discret-or-Bining-Data-2.3.1"><span class="toc-item-num">2.3.1&nbsp;&nbsp;</span>Standard Data Visualization for Discret or Bining Data</a></span></li><li><span><a href="#Tikect" data-toc-modified-id="Tikect-2.3.2"><span class="toc-item-num">2.3.2&nbsp;&nbsp;</span>Tikect</a></span></li><li><span><a href="#Fare" data-toc-modified-id="Fare-2.3.3"><span class="toc-item-num">2.3.3&nbsp;&nbsp;</span>Fare</a></span></li><li><span><a href="#Pclass" data-toc-modified-id="Pclass-2.3.4"><span class="toc-item-num">2.3.4&nbsp;&nbsp;</span>Pclass</a></span></li><li><span><a href="#SibSp" data-toc-modified-id="SibSp-2.3.5"><span class="toc-item-num">2.3.5&nbsp;&nbsp;</span>SibSp</a></span></li><li><span><a href="#Parch" data-toc-modified-id="Parch-2.3.6"><span class="toc-item-num">2.3.6&nbsp;&nbsp;</span>Parch</a></span></li><li><span><a href="#Family-and-non-relatives" data-toc-modified-id="Family-and-non-relatives-2.3.7"><span class="toc-item-num">2.3.7&nbsp;&nbsp;</span>Family and non-relatives</a></span></li><li><span><a href="#Sex" data-toc-modified-id="Sex-2.3.8"><span class="toc-item-num">2.3.8&nbsp;&nbsp;</span>Sex</a></span></li><li><span><a href="#Embarked" data-toc-modified-id="Embarked-2.3.9"><span class="toc-item-num">2.3.9&nbsp;&nbsp;</span>Embarked</a></span></li><li><span><a href="#Name" data-toc-modified-id="Name-2.3.10"><span class="toc-item-num">2.3.10&nbsp;&nbsp;</span>Name</a></span></li><li><span><a href="#Cabin" data-toc-modified-id="Cabin-2.3.11"><span class="toc-item-num">2.3.11&nbsp;&nbsp;</span>Cabin</a></span></li><li><span><a href="#Rescue-of-family-relationships" data-toc-modified-id="Rescue-of-family-relationships-2.3.12"><span class="toc-item-num">2.3.12&nbsp;&nbsp;</span>Rescue of family relationships</a></span></li><li><span><a href="#Age" data-toc-modified-id="Age-2.3.13"><span class="toc-item-num">2.3.13&nbsp;&nbsp;</span>Age</a></span></li></ul></li><li><span><a href="#One-hot-encode-and-drop-provisory-and-unseless-features" data-toc-modified-id="One-hot-encode-and-drop-provisory-and-unseless-features-2.4"><span class="toc-item-num">2.4&nbsp;&nbsp;</span>One hot encode and drop provisory and unseless features</a></span></li></ul></li><li><span><a href="#Select-Features" data-toc-modified-id="Select-Features-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Select Features</a></span><ul class="toc-item"><li><span><a href="#First-check-for-any-correlations-between-features" data-toc-modified-id="First-check-for-any-correlations-between-features-3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span>First check for any correlations between features</a></span><ul class="toc-item"><li><span><a href="#Drop-the-features-with-highest-correlations-to-other-Features:" data-toc-modified-id="Drop-the-features-with-highest-correlations-to-other-Features:-3.1.1"><span class="toc-item-num">3.1.1&nbsp;&nbsp;</span>Drop the features with highest correlations to other Features:</a></span></li><li><span><a href="#Identify--and-treat-Multicolinearity:" data-toc-modified-id="Identify--and-treat-Multicolinearity:-3.1.2"><span class="toc-item-num">3.1.2&nbsp;&nbsp;</span>Identify  and treat Multicolinearity:</a></span></li></ul></li><li><span><a href="#Feature-Selection-by-Filter-Methods" data-toc-modified-id="Feature-Selection-by-Filter-Methods-3.2"><span class="toc-item-num">3.2&nbsp;&nbsp;</span>Feature Selection by Filter Methods</a></span><ul class="toc-item"><li><span><a href="#Feature-Selection-by-Model-based-ranking" data-toc-modified-id="Feature-Selection-by-Model-based-ranking-3.2.1"><span class="toc-item-num">3.2.1&nbsp;&nbsp;</span>Feature Selection by Model based ranking</a></span></li><li><span><a href="#Feature-Selection-by-SelectKBest:" data-toc-modified-id="Feature-Selection-by-SelectKBest:-3.2.2"><span class="toc-item-num">3.2.2&nbsp;&nbsp;</span>Feature Selection by <a href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectKBest.html" target="_blank">SelectKBest</a>:</a></span></li></ul></li><li><span><a href="#Wrapper-Methods" data-toc-modified-id="Wrapper-Methods-3.3"><span class="toc-item-num">3.3&nbsp;&nbsp;</span>Wrapper Methods</a></span><ul class="toc-item"><li><span><a href="#Backward-Elimination" data-toc-modified-id="Backward-Elimination-3.3.1"><span class="toc-item-num">3.3.1&nbsp;&nbsp;</span>Backward Elimination</a></span><ul class="toc-item"><li><span><a href="#Backward-Elimination-By-P-values" data-toc-modified-id="Backward-Elimination-By-P-values-3.3.1.1"><span class="toc-item-num">3.3.1.1&nbsp;&nbsp;</span>Backward Elimination By P-values</a></span></li><li><span><a href="#Backward-Elimination-By-Accuracy---A-Sequential-Backward-Selection" data-toc-modified-id="Backward-Elimination-By-Accuracy---A-Sequential-Backward-Selection-3.3.1.2"><span class="toc-item-num">3.3.1.2&nbsp;&nbsp;</span>Backward Elimination By Accuracy - A Sequential Backward Selection</a></span></li></ul></li><li><span><a href="#Select-Features-by-Recursive-Feature-Elimination" data-toc-modified-id="Select-Features-by-Recursive-Feature-Elimination-3.3.2"><span class="toc-item-num">3.3.2&nbsp;&nbsp;</span>Select Features by Recursive Feature Elimination</a></span></li></ul></li><li><span><a href="#Select-Features-by-Embedded-Methods" data-toc-modified-id="Select-Features-by-Embedded-Methods-3.4"><span class="toc-item-num">3.4&nbsp;&nbsp;</span>Select Features by Embedded Methods</a></span><ul class="toc-item"><li><span><a href="#Feature-Selection-by-Mean-Decrease-Impurity" data-toc-modified-id="Feature-Selection-by-Mean-Decrease-Impurity-3.4.1"><span class="toc-item-num">3.4.1&nbsp;&nbsp;</span>Feature Selection by Mean Decrease Impurity</a></span></li><li><span><a href="#Feature-Selection-by-Mean-Decrease-Accuracy" data-toc-modified-id="Feature-Selection-by-Mean-Decrease-Accuracy-3.4.2"><span class="toc-item-num">3.4.2&nbsp;&nbsp;</span>Feature Selection by Mean Decrease Accuracy</a></span></li><li><span><a href="#Feature-Selection-by-Permutation-with-Shadow-Features" data-toc-modified-id="Feature-Selection-by-Permutation-with-Shadow-Features-3.4.3"><span class="toc-item-num">3.4.3&nbsp;&nbsp;</span>Feature Selection by Permutation with Shadow Features</a></span></li><li><span><a href="#Feature-Selection-by-Gradient-Boosting" data-toc-modified-id="Feature-Selection-by-Gradient-Boosting-3.4.4"><span class="toc-item-num">3.4.4&nbsp;&nbsp;</span>Feature Selection by Gradient Boosting</a></span></li><li><span><a href="#Feature-Selection-by-Regularized-Models" data-toc-modified-id="Feature-Selection-by-Regularized-Models-3.4.5"><span class="toc-item-num">3.4.5&nbsp;&nbsp;</span>Feature Selection by Regularized Models</a></span></li></ul></li><li><span><a href="#Combine-Features-Selection-Methods" data-toc-modified-id="Combine-Features-Selection-Methods-3.5"><span class="toc-item-num">3.5&nbsp;&nbsp;</span>Combine Features Selection Methods</a></span></li><li><span><a href="#Chose-The-Features-From-The-Selection-Methods" data-toc-modified-id="Chose-The-Features-From-The-Selection-Methods-3.6"><span class="toc-item-num">3.6&nbsp;&nbsp;</span>Chose The Features From The Selection Methods</a></span></li></ul></li><li><span><a href="#Additional-Feature-Engineering:-Feature-transformation" data-toc-modified-id="Additional-Feature-Engineering:-Feature-transformation-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Additional Feature Engineering: Feature transformation</a></span><ul class="toc-item"><li><span><a href="#Polynomial-Features---Create-Degree-3-of-some-Features" data-toc-modified-id="Polynomial-Features---Create-Degree-3-of-some-Features-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span><a href="http://scikit-learn.org/stable/modules/preprocessing.html#generating-polynomial-features" target="_blank">Polynomial Features</a> - Create Degree 3 of some Features</a></span></li><li><span><a href="#Defining-Categorical-Data-as-Category" data-toc-modified-id="Defining-Categorical-Data-as-Category-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>Defining Categorical Data as Category</a></span></li><li><span><a href="#Box-cox-transformation-of-highly-skewed-features" data-toc-modified-id="Box-cox-transformation-of-highly-skewed-features-4.3"><span class="toc-item-num">4.3&nbsp;&nbsp;</span>Box cox transformation of highly skewed features</a></span></li><li><span><a href="#Compressing-Data-via-Dimensionality-Reduction" data-toc-modified-id="Compressing-Data-via-Dimensionality-Reduction-4.4"><span class="toc-item-num">4.4&nbsp;&nbsp;</span>Compressing Data via Dimensionality Reduction</a></span><ul class="toc-item"><li><span><a href="#PCA-evaluetion" data-toc-modified-id="PCA-evaluetion-4.4.1"><span class="toc-item-num">4.4.1&nbsp;&nbsp;</span>PCA evaluetion</a></span></li><li><span><a href="#Linear-Discriminant-Analysis-(LDA)" data-toc-modified-id="Linear-Discriminant-Analysis-(LDA)-4.4.2"><span class="toc-item-num">4.4.2&nbsp;&nbsp;</span>Linear Discriminant Analysis (LDA)</a></span></li><li><span><a href="#Nonlinear-dimensionality-reduction-via-kernel-principal-component-analysis" data-toc-modified-id="Nonlinear-dimensionality-reduction-via-kernel-principal-component-analysis-4.4.3"><span class="toc-item-num">4.4.3&nbsp;&nbsp;</span>Nonlinear dimensionality reduction via kernel principal component analysis</a></span></li></ul></li><li><span><a href="#Feature-Selection-into-the-Pipeline" data-toc-modified-id="Feature-Selection-into-the-Pipeline-4.5"><span class="toc-item-num">4.5&nbsp;&nbsp;</span>Feature Selection into the Pipeline</a></span></li></ul></li><li><span><a href="#Modeling---Hiperparametrization" data-toc-modified-id="Modeling---Hiperparametrization-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>Modeling - Hiperparametrization</a></span><ul class="toc-item"><li><span><a href="#Simplify-Get-Results" data-toc-modified-id="Simplify-Get-Results-5.1"><span class="toc-item-num">5.1&nbsp;&nbsp;</span>Simplify Get Results</a></span></li><li><span><a href="#Logistic-Regression" data-toc-modified-id="Logistic-Regression-5.2"><span class="toc-item-num">5.2&nbsp;&nbsp;</span><a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html" target="_blank">Logistic Regression</a></a></span></li><li><span><a href="#SGDClassifier" data-toc-modified-id="SGDClassifier-5.3"><span class="toc-item-num">5.3&nbsp;&nbsp;</span><a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html#sklearn.linear_model.SGDClassifier" target="_blank">SGDClassifier</a></a></span></li><li><span><a href="#Linear-Support-Vector-Classification" data-toc-modified-id="Linear-Support-Vector-Classification-5.4"><span class="toc-item-num">5.4&nbsp;&nbsp;</span><a href="http://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html#sklearn.svm.LinearSVC" target="_blank">Linear Support Vector Classification</a></a></span></li><li><span><a href="#Gaussian-Process-Classifier-(GPC)" data-toc-modified-id="Gaussian-Process-Classifier-(GPC)-5.5"><span class="toc-item-num">5.5&nbsp;&nbsp;</span><a href="http://scikit-learn.org/stable/modules/generated/sklearn.gaussian_process.GaussianProcessClassifier.html#sklearn.gaussian_process.GaussianProcessClassifier" target="_blank">Gaussian Process Classifier (GPC)</a></a></span></li><li><span><a href="#Random-Forest-Classifier" data-toc-modified-id="Random-Forest-Classifier-5.6"><span class="toc-item-num">5.6&nbsp;&nbsp;</span><a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier" target="_blank">Random Forest Classifier</a></a></span></li><li><span><a href="#AdaBoost-classifier" data-toc-modified-id="AdaBoost-classifier-5.7"><span class="toc-item-num">5.7&nbsp;&nbsp;</span><a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.AdaBoostClassifier.html#sklearn.ensemble.AdaBoostClassifier" target="_blank">AdaBoost classifier</a></a></span></li><li><span><a href="#K-Nearest-Neighbors" data-toc-modified-id="K-Nearest-Neighbors-5.8"><span class="toc-item-num">5.8&nbsp;&nbsp;</span><a href="http://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html#sklearn.neighbors.KNeighborsClassifier" target="_blank">K-Nearest Neighbors</a></a></span></li><li><span><a href="#Multi-layer-Perceptron-classifier" data-toc-modified-id="Multi-layer-Perceptron-classifier-5.9"><span class="toc-item-num">5.9&nbsp;&nbsp;</span><a href="http://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier" target="_blank">Multi-layer Perceptron classifier</a></a></span></li><li><span><a href="#Gradient-Boosting-for-Classification" data-toc-modified-id="Gradient-Boosting-for-Classification-5.10"><span class="toc-item-num">5.10&nbsp;&nbsp;</span><a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html" target="_blank">Gradient Boosting for Classification</a></a></span></li><li><span><a href="#XGBoost-(eXtreme-Gradient-Boosting)" data-toc-modified-id="XGBoost-(eXtreme-Gradient-Boosting)-5.11"><span class="toc-item-num">5.11&nbsp;&nbsp;</span><a href="https://xgboost.readthedocs.io/en/latest/" target="_blank">XGBoost (eXtreme Gradient Boosting)</a></a></span></li></ul></li><li><span><a href="#Finalize-The-Model:-Stacking-the-Models" data-toc-modified-id="Finalize-The-Model:-Stacking-the-Models-6"><span class="toc-item-num">6&nbsp;&nbsp;</span>Finalize The Model: Stacking the Models</a></span><ul class="toc-item"><li><span><a href="#Check-the-best-results-from-the-models-hiperparametrization" data-toc-modified-id="Check-the-best-results-from-the-models-hiperparametrization-6.1"><span class="toc-item-num">6.1&nbsp;&nbsp;</span>Check the best results from the models hiperparametrization</a></span></li><li><span><a href="#Validation-Function" data-toc-modified-id="Validation-Function-6.2"><span class="toc-item-num">6.2&nbsp;&nbsp;</span>Validation Function</a></span></li><li><span><a href="#Make-Staked-Classifier" data-toc-modified-id="Make-Staked-Classifier-6.3"><span class="toc-item-num">6.3&nbsp;&nbsp;</span>Make Staked Classifier</a></span></li></ul></li><li><span><a href="#Conclusion" data-toc-modified-id="Conclusion-7"><span class="toc-item-num">7&nbsp;&nbsp;</span>Conclusion</a></span></li></ul></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preparing-environment-and-uploading-data">Preparing environment and uploading data<a class="anchor-link" href="#Preparing-environment-and-uploading-data">&#182;</a></h2><p>You can dowload the data from my github repository or sig in/up on Kaggle <a href="https://www.kaggle.com/c/3136/download-all">here</a>.</p>
<h3 id="Import-Packages">Import Packages<a class="anchor-link" href="#Import-Packages">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span> <span class="o">=</span> <span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">ignore_warn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span> <span class="o">=</span> <span class="n">ignore_warn</span> <span class="c1">#ignore annoying warning (from sklearn and seaborn)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pylab</span> 
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="n">color_codes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="k">import</span> <span class="n">FormatStrFormatter</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="k">import</span> <span class="n">ListedColormap</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">mpl_toolkits</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="kn">import</span> <span class="nn">model_evaluation_utils</span> <span class="k">as</span> <span class="nn">meu</span>

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="k">import</span> <span class="n">skew</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">probplot</span><span class="p">,</span> <span class="n">boxcox</span>
<span class="kn">from</span> <span class="nn">patsy</span> <span class="k">import</span> <span class="n">dmatrices</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="k">import</span> <span class="n">variance_inflation_factor</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="k">import</span> <span class="n">f_classif</span><span class="p">,</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">SelectKBest</span><span class="p">,</span> <span class="n">SelectFromModel</span>
<span class="kn">from</span> <span class="nn">boruta</span> <span class="k">import</span> <span class="n">BorutaPy</span>
<span class="kn">from</span> <span class="nn">rfpimp</span> <span class="k">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="k">import</span> <span class="n">PCA</span><span class="p">,</span> <span class="n">KernelPCA</span>
<span class="kn">from</span> <span class="nn">sklearn.discriminant_analysis</span> <span class="k">import</span> <span class="n">LinearDiscriminantAnalysis</span> <span class="k">as</span> <span class="n">LDA</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">,</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">Pipeline</span><span class="p">,</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">GridSearchCV</span><span class="p">,</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">KFold</span><span class="p">,</span> <span class="n">cross_val_predict</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span><span class="p">,</span> <span class="n">SGDClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="k">import</span> <span class="n">SVC</span><span class="p">,</span> <span class="n">LinearSVC</span>
<span class="kn">from</span> <span class="nn">sklearn.gaussian_process</span> <span class="k">import</span> <span class="n">GaussianProcessClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.gaussian_process.kernels</span> <span class="k">import</span> <span class="n">RBF</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">AdaBoostClassifier</span><span class="p">,</span> <span class="n">ExtraTreesClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble.gradient_boosting</span> <span class="k">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="k">import</span> <span class="n">MLPClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="k">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="k">import</span> <span class="n">XGBClassifier</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="k">import</span> <span class="n">plot_importance</span>

<span class="c1">#from sklearn.base import BaseEstimator, TransformerMixin, clone, ClassifierMixin</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">VotingClassifier</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">combinations</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-Datastes">Load Datastes<a class="anchor-link" href="#Load-Datastes">&#182;</a></h3><p>I start with load the datasets with pandas, and concatenade them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;train.csv&#39;</span><span class="p">)</span> 

<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;test.csv&#39;</span><span class="p">)</span> 
<span class="n">Test_ID</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">PassengerId</span>
<span class="n">test</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Exploratory-Data-Analysis-(EDA)-&amp;-Feature-Engeniring">Exploratory Data Analysis (EDA) &amp; Feature Engeniring<a class="anchor-link" href="#Exploratory-Data-Analysis-(EDA)-&amp;-Feature-Engeniring">&#182;</a></h2><h3 id="Take-a-First-Look-of-our-Data:">Take a First Look of our Data:<a class="anchor-link" href="#Take-a-First-Look-of-our-Data:">&#182;</a></h3><p>I created the function below to simplify the analysis of general characteristics of the data. Inspired on the str function of R, this function returns the types, counts, distinct, count nulls, missing ratio and uniques values of each field/feature.</p>
<p>If the study involve some supervised learning, this function can return the study of the correlation, for this we just need provide the independent variable to the pred parameter.</p>
<p>Also, if your return is stored in a variable you can evaluate it in more detail, specific of a field, or sort them from different perspectives</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rstr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pred</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
    <span class="n">obs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">types</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
    <span class="n">uniques</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">unique</span><span class="p">()])</span>
    <span class="n">nulls</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">distincts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">missing_ration</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span> <span class="n">obs</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">skewness</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span>
    <span class="n">kurtosis</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">kurt</span><span class="p">()</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Data shape:&#39;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">pred</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;types&#39;</span><span class="p">,</span> <span class="s1">&#39;counts&#39;</span><span class="p">,</span> <span class="s1">&#39;distincts&#39;</span><span class="p">,</span> <span class="s1">&#39;nulls&#39;</span><span class="p">,</span> <span class="s1">&#39;missing ration&#39;</span><span class="p">,</span> <span class="s1">&#39;uniques&#39;</span><span class="p">,</span> <span class="s1">&#39;skewness&#39;</span><span class="p">,</span> <span class="s1">&#39;kurtosis&#39;</span><span class="p">]</span>
        <span class="nb">str</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">types</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">distincts</span><span class="p">,</span> <span class="n">nulls</span><span class="p">,</span> <span class="n">missing_ration</span><span class="p">,</span> <span class="n">uniques</span><span class="p">,</span> <span class="n">skewness</span><span class="p">,</span> <span class="n">kurtosis</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()[</span><span class="n">pred</span><span class="p">]</span>
        <span class="nb">str</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">types</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">distincts</span><span class="p">,</span> <span class="n">nulls</span><span class="p">,</span> <span class="n">missing_ration</span><span class="p">,</span> <span class="n">uniques</span><span class="p">,</span> <span class="n">skewness</span><span class="p">,</span> <span class="n">kurtosis</span><span class="p">,</span> <span class="n">corr</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">corr_col</span> <span class="o">=</span> <span class="s1">&#39;corr &#39;</span>  <span class="o">+</span> <span class="n">pred</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;types&#39;</span><span class="p">,</span> <span class="s1">&#39;counts&#39;</span><span class="p">,</span> <span class="s1">&#39;distincts&#39;</span><span class="p">,</span> <span class="s1">&#39;nulls&#39;</span><span class="p">,</span> <span class="s1">&#39;missing_ration&#39;</span><span class="p">,</span> <span class="s1">&#39;uniques&#39;</span><span class="p">,</span> <span class="s1">&#39;skewness&#39;</span><span class="p">,</span> <span class="s1">&#39;kurtosis&#39;</span><span class="p">,</span> <span class="n">corr_col</span> <span class="p">]</span>
    
    <span class="nb">str</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cols</span>
    <span class="n">dtypes</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;___________________________</span><span class="se">\n</span><span class="s1">Data types:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="nb">str</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;___________________________&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">details</span> <span class="o">=</span> <span class="n">rstr</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span> <span class="p">,</span><span class="s1">&#39;Survived&#39;</span> <span class="p">:</span> <span class="s1">&#39;Embarked&#39;</span><span class="p">],</span> <span class="s1">&#39;Survived&#39;</span><span class="p">)</span>
<span class="n">details</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;corr Survived&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Data shape: (1309, 11)
___________________________
Data types:
 object     5
int64      4
float64    2
Name: types, dtype: int64
___________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt output_prompt">Out[4]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>types</th>
      <th>counts</th>
      <th>distincts</th>
      <th>nulls</th>
      <th>missing_ration</th>
      <th>uniques</th>
      <th>skewness</th>
      <th>kurtosis</th>
      <th>corr Survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Survived</th>
      <td>int64</td>
      <td>1309</td>
      <td>3</td>
      <td>0</td>
      <td>0.000000</td>
      <td>[[0, 1, -1]]</td>
      <td>0.097425</td>
      <td>-1.263022</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>Fare</th>
      <td>float64</td>
      <td>1308</td>
      <td>282</td>
      <td>1</td>
      <td>0.076394</td>
      <td>[[7.25, 71.2833, 7.925, 53.1, 8.05, 8.4583, 51...</td>
      <td>4.367709</td>
      <td>27.027986</td>
      <td>0.081545</td>
    </tr>
    <tr>
      <th>Parch</th>
      <td>int64</td>
      <td>1309</td>
      <td>8</td>
      <td>0</td>
      <td>0.000000</td>
      <td>[[0, 1, 2, 5, 3, 4, 6, 9]]</td>
      <td>3.669078</td>
      <td>21.541079</td>
      <td>0.028196</td>
    </tr>
    <tr>
      <th>SibSp</th>
      <td>int64</td>
      <td>1309</td>
      <td>7</td>
      <td>0</td>
      <td>0.000000</td>
      <td>[[1, 0, 3, 4, 2, 5, 8]]</td>
      <td>3.844220</td>
      <td>20.043251</td>
      <td>0.012470</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>float64</td>
      <td>1046</td>
      <td>99</td>
      <td>263</td>
      <td>20.091673</td>
      <td>[[22.0, 38.0, 26.0, 35.0, nan, 54.0, 2.0, 27.0...</td>
      <td>0.407675</td>
      <td>0.146948</td>
      <td>-0.049620</td>
    </tr>
    <tr>
      <th>Pclass</th>
      <td>int64</td>
      <td>1309</td>
      <td>3</td>
      <td>0</td>
      <td>0.000000</td>
      <td>[[3, 1, 2]]</td>
      <td>-0.598647</td>
      <td>-1.315079</td>
      <td>-0.126769</td>
    </tr>
    <tr>
      <th>Name</th>
      <td>object</td>
      <td>1309</td>
      <td>1307</td>
      <td>0</td>
      <td>0.000000</td>
      <td>[[Braund, Mr. Owen Harris, Cumings, Mrs. John ...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Sex</th>
      <td>object</td>
      <td>1309</td>
      <td>2</td>
      <td>0</td>
      <td>0.000000</td>
      <td>[[male, female]]</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Ticket</th>
      <td>object</td>
      <td>1309</td>
      <td>929</td>
      <td>0</td>
      <td>0.000000</td>
      <td>[[A/5 21171, PC 17599, STON/O2. 3101282, 11380...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Cabin</th>
      <td>object</td>
      <td>295</td>
      <td>187</td>
      <td>1014</td>
      <td>77.463713</td>
      <td>[[nan, C85, C123, E46, G6, C103, D56, A6, C23 ...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Embarked</th>
      <td>object</td>
      <td>1307</td>
      <td>4</td>
      <td>2</td>
      <td>0.152788</td>
      <td>[[S, C, Q, nan]]</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Data Dictionary</strong></p>
<ul>
<li>Survived: 0 = No, 1 = Yes. I use -1 to can separate test data from training data.</li>
<li>Fare:     The passenger fare</li>
<li>Parch:    # of parents / children aboard the Titanic          </li>
<li>SibSp:    # of siblings / spouses aboard the Titanic</li>
<li>Age:      Age in years</li>
<li>Pclass:   Ticket class    1 = 1st, 2 = 2nd, 3 = 3rd   </li>
<li>Name:     Name of the passenger</li>
<li>Sex:      Sex of the passenger male and female</li>
<li>Ticket:   Ticket number</li>
<li>Cabin:    Cabin number    </li>
<li>Embarked: Port of Embarkation C = Cherbourg, Q = Queenstown, S = Southampton  </li>
</ul>
<p><strong>The points of attention we have here are:</strong></p>
<ul>
<li><strong>Fare</strong>: Kaggle affirm that is the passenger fare, but with some data inspection in group of Tickets we discover that is the total amount fare paid for a ticket, and the existence of tickets for a group of passengers.</li>
<li><strong>Parch</strong>: The dataset defines family relations in this way...<ul>
<li>Parent = mother, father</li>
<li>Child = daughter, son, stepdaughter, stepson</li>
<li>Some children travelled only with a nanny, therefore parch=0 for them.</li>
</ul>
</li>
<li><strong>SibSP</strong>: The dataset defines family relations in this way...<ul>
<li>Sibling = brother, sister, stepbrother, stepsister</li>
<li>Spouse = husband, wife (mistresses and fiancs were ignored)</li>
</ul>
</li>
<li><strong>Age</strong>: Have 20% of nulls, so we have to find a more efficient way of filling them out with just a single value, like the median for example.</li>
<li><strong>Name</strong>: is a categorical data with a high distincts values as expect. The first reaction is drop this column, but we can use it to training differents data engineering techniques, to see if we can get some valuable data. Besides that, notice that has two pairs of passengers with the same name?  </li>
<li><strong>Ticket</strong> Other categorical data, but in this case it have only 71% of distinct values and don't have nulls. So, it is possible that some passenger voyage in groups and use the same ticket. Beyond that, we can check to if we can extract other interesting thought form it.</li>
<li><strong>Cabin</strong>: the high number of disticnt values (187) and nulls (77.5%). 
   This is a categorical data of which I use to train different techniques to extract some information of value and null input, but with given the high rate of null the recommended would be to simplify the filling or even to exclude this attribute.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="First-see-of-some-stats-of-Numeric-Data">First see of some stats of Numeric Data<a class="anchor-link" href="#First-see-of-some-stats-of-Numeric-Data">&#182;</a></h3><p>So, for the main statistics of our numeric data describe the function (like the summary of R)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Data is not balanced! Has </span><span class="si">{:2.2%}</span><span class="s1"> survives&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">Survived</span><span class="o">.</span><span class="n">describe</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span> <span class="p">,</span><span class="s1">&#39;Pclass&#39;</span> <span class="p">:</span> <span class="s1">&#39;Embarked&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Survived: [1] Survived; [0] Died; [-1] Test Data set:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Data is not balanced! Has 38.38% survives
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Pclass</th>
      <td>1309.0</td>
      <td>2.294882</td>
      <td>0.837836</td>
      <td>1.00</td>
      <td>2.0000</td>
      <td>3.0000</td>
      <td>3.000</td>
      <td>3.0000</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>1046.0</td>
      <td>29.881138</td>
      <td>14.413493</td>
      <td>0.17</td>
      <td>21.0000</td>
      <td>28.0000</td>
      <td>39.000</td>
      <td>80.0000</td>
    </tr>
    <tr>
      <th>SibSp</th>
      <td>1309.0</td>
      <td>0.498854</td>
      <td>1.041658</td>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>1.000</td>
      <td>8.0000</td>
    </tr>
    <tr>
      <th>Parch</th>
      <td>1309.0</td>
      <td>0.385027</td>
      <td>0.865560</td>
      <td>0.00</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.000</td>
      <td>9.0000</td>
    </tr>
    <tr>
      <th>Fare</th>
      <td>1308.0</td>
      <td>33.295479</td>
      <td>51.758668</td>
      <td>0.00</td>
      <td>7.8958</td>
      <td>14.4542</td>
      <td>31.275</td>
      <td>512.3292</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Survived: [1] Survived; [0] Died; [-1] Test Data set:
  0    549
-1    418
 1    342
Name: Survived, dtype: int64
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="EDA-and-Feature-Enginiring-by-Feature">EDA and Feature Enginiring by Feature<a class="anchor-link" href="#EDA-and-Feature-Enginiring-by-Feature">&#182;</a></h3><h4 id="Standard-Data-Visualization-for-Discret-or-Bining-Data">Standard Data Visualization for Discret or Bining Data<a class="anchor-link" href="#Standard-Data-Visualization-for-Discret-or-Bining-Data">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">charts</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">           ____________________________ Plots of&#39;</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="s1">&#39;per Survived and Dead: ____________________________&#39;</span><span class="p">)</span>
    <span class="c1"># Pie of all Data</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">cnt</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    
    <span class="c1"># Count Plot By Survived and Dead</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="n">hue_order</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>

    <span class="c1"># Percent stacked Plot</span>
    <span class="n">survived</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">dead</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">survived</span><span class="p">,</span><span class="n">dead</span><span class="p">])</span>
    <span class="n">df2</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">,</span><span class="s1">&#39;Dead&#39;</span><span class="p">]</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">T</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">Survived</span> <span class="o">+</span> <span class="n">df2</span><span class="o">.</span><span class="n">Dead</span>
    <span class="n">df2</span><span class="o">.</span><span class="n">Survived</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">Survived</span><span class="o">/</span><span class="n">df2</span><span class="o">.</span><span class="n">Total</span>
    <span class="n">df2</span><span class="o">.</span><span class="n">Dead</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">Dead</span><span class="o">/</span><span class="n">df2</span><span class="o">.</span><span class="n">Total</span>
    <span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Total&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
    <span class="n">df2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">df2</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">dead</span><span class="p">,</span> <span class="n">fig</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Tikect">Tikect<a class="anchor-link" href="#Tikect">&#182;</a></h4><p><img align='right' width='300' src=https://cdn-03.belfasttelegraph.co.uk/news/northern-ireland/article36800435.ece/7f250/AUTOCROP/w620h342/bpanews_3761aca3-0819-42ed-8f9d-6698d826d0ff_1></p>
<p>Since Ticket is a transaction and categorical data, the first insight is drop  this feature, but we may note that it has some hidden value information. At first look, safe few cases, we could affirms that:</p>
<ul>
<li>families and group of persons that traveled together bought the same ticket.</li>
<li>People with alphanumerics Tickets has some special treatment (crew family, employees, VIP, free tickets, etc.) </li>
</ul>
<p>So, we start by a new feature creation to quantify the <strong>number of passengers by ticket</strong>, and associente this<br>
quantity to each passenger with the same ticket.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">same_ticket</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Ticket</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;qtd_same_ticket&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Ticket</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">same_ticket</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="k">del</span> <span class="n">same_ticket</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;qtd_same_ticket&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of qtd_same_ticket per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_15_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see above:</p>
<ul>
<li>the majority (54%) bought only one ticket per passenger, and have lower survival rate than passengers that bought tickets for 2, 3, 4, 5 and 8 people.</li>
<li>the survival rate is growing between 1 and 4, dropped a lot at 5. From the bar chart we can see that after 5 the number of samples is too low (84 out of 891, 9.4%, 1/4 of this is 5), and this data is skewed with a long tail to right. We can reduce this tail by bining all data after 4 in the same ordinal, its better to prevent overfitig, but we lose some others interesting case, see the next bollet. As alternative we can apply a box cox at this mesure.</li>
<li>The case of 11 people with same tikect probably is a huge family that all samples on the training data died. Let's ckek this below.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">qtd_same_ticket</span><span class="o">==</span><span class="mi">11</span><span class="p">)]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[8]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>qtd_same_ticket</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>159</th>
      <td>160</td>
      <td>0</td>
      <td>3</td>
      <td>Sage, Master. Thomas Henry</td>
      <td>male</td>
      <td>NaN</td>
      <td>8</td>
      <td>2</td>
      <td>CA. 2343</td>
      <td>69.55</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
    </tr>
    <tr>
      <th>180</th>
      <td>181</td>
      <td>0</td>
      <td>3</td>
      <td>Sage, Miss. Constance Gladys</td>
      <td>female</td>
      <td>NaN</td>
      <td>8</td>
      <td>2</td>
      <td>CA. 2343</td>
      <td>69.55</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
    </tr>
    <tr>
      <th>201</th>
      <td>202</td>
      <td>0</td>
      <td>3</td>
      <td>Sage, Mr. Frederick</td>
      <td>male</td>
      <td>NaN</td>
      <td>8</td>
      <td>2</td>
      <td>CA. 2343</td>
      <td>69.55</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
    </tr>
    <tr>
      <th>324</th>
      <td>325</td>
      <td>0</td>
      <td>3</td>
      <td>Sage, Mr. George John Jr</td>
      <td>male</td>
      <td>NaN</td>
      <td>8</td>
      <td>2</td>
      <td>CA. 2343</td>
      <td>69.55</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
    </tr>
    <tr>
      <th>792</th>
      <td>793</td>
      <td>0</td>
      <td>3</td>
      <td>Sage, Miss. Stella Anna</td>
      <td>female</td>
      <td>NaN</td>
      <td>8</td>
      <td>2</td>
      <td>CA. 2343</td>
      <td>69.55</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
    </tr>
    <tr>
      <th>846</th>
      <td>847</td>
      <td>0</td>
      <td>3</td>
      <td>Sage, Mr. Douglas Bullen</td>
      <td>male</td>
      <td>NaN</td>
      <td>8</td>
      <td>2</td>
      <td>CA. 2343</td>
      <td>69.55</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
    </tr>
    <tr>
      <th>863</th>
      <td>864</td>
      <td>0</td>
      <td>3</td>
      <td>Sage, Miss. Dorothy Edith "Dolly"</td>
      <td>female</td>
      <td>NaN</td>
      <td>8</td>
      <td>2</td>
      <td>CA. 2343</td>
      <td>69.55</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
    </tr>
    <tr>
      <th>1079</th>
      <td>1080</td>
      <td>-1</td>
      <td>3</td>
      <td>Sage, Miss. Ada</td>
      <td>female</td>
      <td>NaN</td>
      <td>8</td>
      <td>2</td>
      <td>CA. 2343</td>
      <td>69.55</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
    </tr>
    <tr>
      <th>1233</th>
      <td>1234</td>
      <td>-1</td>
      <td>3</td>
      <td>Sage, Mr. John George</td>
      <td>male</td>
      <td>NaN</td>
      <td>1</td>
      <td>9</td>
      <td>CA. 2343</td>
      <td>69.55</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
    </tr>
    <tr>
      <th>1251</th>
      <td>1252</td>
      <td>-1</td>
      <td>3</td>
      <td>Sage, Master. William Henry</td>
      <td>male</td>
      <td>14.5</td>
      <td>8</td>
      <td>2</td>
      <td>CA. 2343</td>
      <td>69.55</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
    </tr>
    <tr>
      <th>1256</th>
      <td>1257</td>
      <td>-1</td>
      <td>3</td>
      <td>Sage, Mrs. John (Annie Bullen)</td>
      <td>female</td>
      <td>NaN</td>
      <td>1</td>
      <td>9</td>
      <td>CA. 2343</td>
      <td>69.55</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We confirm our hypothesis, and we notice that Fare is not the price of each passenger, but the price of each ticket, its total amount. Since our data is per passenger, this information has some distortion, becouse only one passenger that bought a ticket alone of 69.55 pounds is different from 11 passenger that bought a special tiket, with discount for group, by 6.32 pounds per passenger. It sugest to create a new feature that represents the real fare by passenger.</p>
<p>Back to the quantity of persons with same ticket, if we keep this and the model can capture this pattern, you'll probably predict that the respective test samples also died! However, even if true, can be a sign of overfiting, because we only have 1.2% of these cases in the training samples.</p>
<p>In order to increase representativeness and lose the minimum of information, since we have only 44 (4.9%) training samples that bought tickets for 4 people and 101 (11.3%) of 3, we binning the quantity of 3 and 4 together as 3 (16,3%, ouver than 5 as 5 (84 samples). Let's see the results below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;qtd_same_ticket_bin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">qtd_same_ticket</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="mi">5</span> <span class="k">if</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">4</span> <span class="k">else</span> <span class="n">x</span><span class="p">))</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;qtd_same_ticket_bin&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of qtd_same_ticket_bin per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_19_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Other option, is create a binary feature that indicates if the passenger use a same ticket or not (not share his ticket)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Percent. survived from unique ticket: </span><span class="si">{:3.2%}</span><span class="s1">&#39;</span><span class="o">.</span>\
      <span class="nb">format</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">qtd_same_ticket</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span>
             <span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">qtd_same_ticket</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">count</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Percent. survived from same tickets: </span><span class="si">{:3.2%}</span><span class="s1">&#39;</span><span class="o">.</span>\
      <span class="nb">format</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">qtd_same_ticket</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span>
             <span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">qtd_same_ticket</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">count</span><span class="p">()))</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;same_tckt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">qtd_same_ticket</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;same_tckt&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Percent. survived from unique ticket: 27.03%
Percent. survived from same tickets: 51.71%

           ____________________________ Plots of same_tckt per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_21_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this case we lose information that the chances of survival increase from 1 to 4, and fall from 5. In addition, cases 1 and 0 of the two measures are exactly the same. Then we will not use this option, and go work on Fare.</p>
<p>Finnaly, we have one more information to extract directly from Ticket, and check the possible special treatment!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">Ticket</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[A-z]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">)))</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>           957
PC          92
CA          68
A           39
SOTONOQ     24
STONO       21
WC          15
Name: Ticket, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;distinction_in_tikect&#39;</span><span class="p">]</span> <span class="o">=</span>\
   <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Ticket</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[A-z]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">)))</span>

<span class="n">data</span><span class="o">.</span><span class="n">distinction_in_tikect</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">distinction_in_tikect</span><span class="o">.</span>\
  <span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="s1">&#39;Without&#39;</span> <span class="k">if</span> <span class="n">y</span><span class="o">==</span><span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="n">y</span> <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PC&#39;</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;SOTONOQ&#39;</span><span class="p">,</span> <span class="s1">&#39;STONO&#39;</span><span class="p">,</span> <span class="s1">&#39;WC&#39;</span><span class="p">,</span> <span class="s1">&#39;SCPARIS&#39;</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;Others&#39;</span><span class="p">)</span>

<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;distinction_in_tikect&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of distinction_in_tikect per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_24_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By the results, passengers with PC distinction in their tickets had best survival rate. Without, Others and CA is preat equal and can be grouped in one category and the we can do the same between STONO and SCAPARIS, and between A, SOTONOQ and WC.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">distinction_in_tikect</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">distinction_in_tikect</span><span class="o">.</span>\
  <span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="s1">&#39;Others&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Without&#39;</span><span class="p">,</span> <span class="s1">&#39;Others&#39;</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">])</span> <span class="k">else</span>\
        <span class="s1">&#39;Low&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;SOTONOQ&#39;</span><span class="p">,</span> <span class="s1">&#39;WC&#39;</span><span class="p">])</span> <span class="k">else</span>\
        <span class="s1">&#39;High&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;STONO&#39;</span><span class="p">,</span> <span class="s1">&#39;SCPARIS&#39;</span><span class="p">])</span> <span class="k">else</span> <span class="n">y</span><span class="p">)</span>

<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;distinction_in_tikect&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of distinction_in_tikect per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_26_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Fare">Fare<a class="anchor-link" href="#Fare">&#182;</a></h4><p>First, we treat the unique null fare case, then we take a look of the distribution of Fare (remember that is the total amount Fare of the Ticket).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Fill null with median of most likely type passenger</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Fare</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="s1">&#39;Fare&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Fare</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">qtd_same_ticket</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;</span><span class="mi">60</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">Fare</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Fare&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span> <span class="n">notch</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_28_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's take a look at how the fare per passenger is and how much it differs from the total</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;passenger_fare&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Fare</span> <span class="o">/</span> <span class="n">data</span><span class="o">.</span><span class="n">qtd_same_ticket</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">141</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">passenger_fare</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">142</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;passenger_fare&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span> <span class="n">notch</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">143</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Fare</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">==</span><span class="mi">0</span><span class="p">)],</span> <span class="n">q</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">50</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">])</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Died&#39;</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">144</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Fare</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)],</span> <span class="n">q</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">50</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">])</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Survived&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_30_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img align='right' width='500' src=https://i2.wp.com/www.hoaxorfact.com/wp-content/uploads/2015/06/Titanic-Ticket.jpg>
From the comparison, we can see that:</p>
<ul>
<li>the distributions are not exactly the same, with two spouts slightly apart on passager fare.</li>
<li>Class and how much paid per passager make differences!<p>
Although the number of survivors among the quartiles is approximately the same as expected, when we look at passenger fares, it is more apparent that the mortality rate is higher in the lower Fares, since the top of Q4 died is at the same height as the median plus a confidence interval of the fare paid by survivors. </li>
<li>the number of outliers is lower in the fare per passenger, especially among survivors.<p>
We can not rule out these outliers if there are cases of the same type in the test data set. In addition, these differences in values may be due to probably first class with additional fees for certain exclusives and cargo. </li>
</ul>
<p>Below, you can see that the largest outlier all survival in the train data set, and has one case (1235 Passenger Id, 
the matriarch of one son and two companions) to predict. Among all outlier cases of survivors, we see that all cases are first class, and different from the largets outlier, 27% actually died, and we have 18 cases to predict.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Passengers with higets passenger fare:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">120</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Surivived of passenger fare more than 50:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">50</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">]],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">,</span> 
                       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">]))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Passengers with higets passenger fare:
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>qtd_same_ticket</th>
      <th>qtd_same_ticket_bin</th>
      <th>same_tckt</th>
      <th>distinction_in_tikect</th>
      <th>passenger_fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>258</th>
      <td>259</td>
      <td>1</td>
      <td>1</td>
      <td>Ward, Miss. Anna</td>
      <td>female</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>PC 17755</td>
      <td>512.3292</td>
      <td>NaN</td>
      <td>C</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>PC</td>
      <td>128.0823</td>
    </tr>
    <tr>
      <th>679</th>
      <td>680</td>
      <td>1</td>
      <td>1</td>
      <td>Cardeza, Mr. Thomas Drake Martinez</td>
      <td>male</td>
      <td>36.0</td>
      <td>0</td>
      <td>1</td>
      <td>PC 17755</td>
      <td>512.3292</td>
      <td>B51 B53 B55</td>
      <td>C</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>PC</td>
      <td>128.0823</td>
    </tr>
    <tr>
      <th>737</th>
      <td>738</td>
      <td>1</td>
      <td>1</td>
      <td>Lesurer, Mr. Gustave J</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>PC 17755</td>
      <td>512.3292</td>
      <td>B101</td>
      <td>C</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>PC</td>
      <td>128.0823</td>
    </tr>
    <tr>
      <th>1234</th>
      <td>1235</td>
      <td>-1</td>
      <td>1</td>
      <td>Cardeza, Mrs. James Warburton Martinez (Charlo...</td>
      <td>female</td>
      <td>58.0</td>
      <td>0</td>
      <td>1</td>
      <td>PC 17755</td>
      <td>512.3292</td>
      <td>B51 B53 B55</td>
      <td>C</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>PC</td>
      <td>128.0823</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Surivived of passenger fare more than 50:
 Survived  -1   0   1
Pclass              
1         18   4  22
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that if we leave this way, if the model succeeds in capturing this pattern of largest outlier we are again thinking of a model that is at risk of ouverfiting (0.03% of cases).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Pclass">Pclass<a class="anchor-link" href="#Pclass">&#182;</a></h4><p><img align='left' width='500' src=https://www.encyclopedia-titanica.org/files/1/figure-one-side-view.gif></p>
<p>Notwithstanding the fact that class 3 presents greater magnitude, as we see with Fare by passenger, we notice that survival rate is greater with greater fare by passenger. Its make to think that has some social economic discriminal. It is confirmed when we saw the data distribution over the classes, and see the percent bar has a clearer aggressive decreasing survival rate through the first to the third classes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">charts</span><span class="p">(</span><span class="s1">&#39;Pclass&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of Pclass per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_35_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="SibSp">SibSp<a class="anchor-link" href="#SibSp">&#182;</a></h4><p><img src=https://www.encyclopedia-titanica.org/files/titanic_relatives/images/titanic-xl.jpg></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">charts</span><span class="p">(</span><span class="s1">&#39;SibSp&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of SibSp per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_37_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since more than 2 siblings has too few cases and lowest survival rate, we can aggreagate all this case into unique bin in order to increase representativeness and lose the minimum of information.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SibSp_bin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">SibSp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">6</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;SibSp_bin&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of SibSp_bin per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_39_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Parch">Parch<a class="anchor-link" href="#Parch">&#182;</a></h4><p><img src=http://2.bp.blogspot.com/-X2iJcXp0bUY/U6yg71B6wjI/AAAAAAAAAYc/npacw-Zm_c8/s1600/titanic+anderssons.jpg></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">charts</span><span class="p">(</span><span class="s1">&#39;Parch&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of Parch per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_41_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we did with siblings, we will aggregate the Parchs cases with more than 3, even with the highest survival rate with 3 Parchs.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Parch_bin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Parch</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span><span class="o">&lt;</span> <span class="mi">3</span> <span class="k">else</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;Parch_bin&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of Parch_bin per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_43_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Family-and-non-relatives">Family and non-relatives<a class="anchor-link" href="#Family-and-non-relatives">&#182;</a></h4><p>If you investigate the data, you will notice that total family members can be obten by the sum of Parch and SibSp plus 1 (1 for the person of respective record). So, let's create the Family and see what we get.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">SibSp</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">Parch</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;family&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of family per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_45_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, family groups of up to 4 people were more likely to survive than people without relatives on board. 
However from 5 family members we see a drastic fall and the leveling of the 7-member cases with the unfamiliar ones. 
You may be led to think that this distortion clearly has some relation to the social condition. Better see the right data!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">charts</span><span class="p">(</span><span class="s1">&#39;Pclass&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">family</span><span class="o">&gt;</span><span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of Pclass per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_47_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img align='right' width='400' src=https://www.cruiselinehistory.com/wp-content/uploads/2016/02/CLH005.png>
Yes, we have more cases in the third class, but on the other hand, what we see is that the numbers of cases with more than 4 relatives were rarer. n a more careful look, you will see that from 6 family members we only have third class (25 in training, 10 in test). So we confirmed that a large number of family members made a difference, yes, if you were from upper classes</p>
<p>You must have a feeling of dejavu, and yes, this metric is very similar to the one we have already created, the amount of passengers with the same ticket.</p>
<p>So what's the difference. At first you have only the amount of people aboard with family kinship plus herself, in the previous you have people reportedly grouped, family members or not.  So,  in cases where relatives bought tickets separately we see the family considering them, but the ticket separating them. On the other hand, as a family we do not consider travelers with their non-family companions, employees or friends, while in the other yes.</p>
<p>With this, we can now obtain the number of felows or companions per passenger. This is the number of non-relatives who traveled with the passenger</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;non_relatives&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">qtd_same_ticket</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">family</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;non_relatives&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of non_relatives per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_49_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here you see negative numbers because there are groups of travelers with the number of unrelated members larger than those with kinship.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Sex">Sex<a class="anchor-link" href="#Sex">&#182;</a></h4><p>As everybody knows, in that case women has more significant survival rate than men.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">charts</span><span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of Sex per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_52_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Embarked">Embarked<a class="anchor-link" href="#Embarked">&#182;</a></h4><p><img  align='left' width="350" src=http://www.paullee.com/titanic/jf2012goof_pics/pt1vlcsnap-00007.jpg></p>
<p>First, we check the 2 embarked null cases to find the most likely pattern to considerate to fill with the respective mode.</p>
<p>In sequence, we take a look at the Embarked data.  As we can see, the passengers that embarked from Cherbourg had best survival rates and most of the passengers embarked from Southampton and had the worst survival rate.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Embarked</span><span class="o">.</span><span class="n">isnull</span><span class="p">()])</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Embarked</span><span class="o">==</span><span class="s1">&#39;NA&#39;</span><span class="p">,</span> <span class="s1">&#39;Embarked&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">Embarked</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;Embarked&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>...</th>
      <th>Embarked</th>
      <th>qtd_same_ticket</th>
      <th>qtd_same_ticket_bin</th>
      <th>same_tckt</th>
      <th>distinction_in_tikect</th>
      <th>passenger_fare</th>
      <th>SibSp_bin</th>
      <th>Parch_bin</th>
      <th>family</th>
      <th>non_relatives</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>61</th>
      <td>62</td>
      <td>1</td>
      <td>1</td>
      <td>Icard, Miss. Amelie</td>
      <td>female</td>
      <td>38.0</td>
      <td>0</td>
      <td>0</td>
      <td>113572</td>
      <td>80.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>Others</td>
      <td>40.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>829</th>
      <td>830</td>
      <td>1</td>
      <td>1</td>
      <td>Stone, Mrs. George Nelson (Martha Evelyn)</td>
      <td>female</td>
      <td>62.0</td>
      <td>0</td>
      <td>0</td>
      <td>113572</td>
      <td>80.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>Others</td>
      <td>40.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>2 rows  21 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of Embarked per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_54_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Name">Name<a class="anchor-link" href="#Name">&#182;</a></h4><p><img height="5" width="800" src=http://www.titanic.ie/images/banner-img1.jpg>
Name feature has too much variance and is not significant, but has some value information to extracts and checks, like:</p>
<ul>
<li>Personal Titles</li>
<li>Existence of nicknames</li>
<li>Existence of references to another person</li>
<li>Family names</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">Personal_Titles</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Personal_Titles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;Mrs\.|Mr\.|Miss\.|Maste[r]|Dr\.|Lady\.|Countess\.|&#39;</span>
                                                <span class="o">+</span><span class="s1">&#39;Sir\.|Rev\.|Don\.|Major\.|Col\.|Jonkheer\.|&#39;</span>
                                                <span class="o">+</span> <span class="s1">&#39;Capt\.|Ms\.|Mme\.|Mlle\.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">))</span>

    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mrs.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Mrs&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mr.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Mr&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Miss.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Miss&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Sex</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;Mr&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="s1">&#39;male&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;Mrs&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mme.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Mrs&#39;</span> 
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Ms.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Mrs&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Lady.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Royalty&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mlle.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Miss&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Miss.&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">15</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;Kid&#39;</span> 
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Master&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Kid&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Don.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Royalty&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Jonkheer.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Royalty&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Capt.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Technical&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Rev.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Technical&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Sir.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Royalty&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Countess.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Royalty&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Major.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Technical&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Col.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Technical&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Dr.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Technical&#39;</span>

<span class="n">Personal_Titles</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Personal_Titles&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">]],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">,</span> 
                       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Personal_Titles&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;Personal_Titles&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Personal_Titles</th>
      <th>Kid</th>
      <th>Miss</th>
      <th>Mr</th>
      <th>Mrs</th>
      <th>Royalty</th>
      <th>Technical</th>
    </tr>
    <tr>
      <th>Survived</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-1</th>
      <td>42.0</td>
      <td>156.0</td>
      <td>480.0</td>
      <td>148.0</td>
      <td>NaN</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>17.0</td>
      <td>55.0</td>
      <td>436.0</td>
      <td>26.0</td>
      <td>2.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46.0</td>
      <td>258.0</td>
      <td>162.0</td>
      <td>202.0</td>
      <td>6.0</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of Personal_Titles per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_56_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see above, I opted to add some titles, but at first keep 2 small sets (Technical and Royalty), Because there are interesting survival rate variations.</p>
<p>Next, we identify the names with mentions to other people or with nicknames and create a boolean feature.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;distinction_in_name&#39;</span><span class="p">]</span> <span class="o">=</span>\
   <span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;\(&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">))</span><span class="o">==</span><span class="s1">&#39;(&#39;</span><span class="p">)</span>
    <span class="o">|</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&quot;[A-z&quot;]*&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&quot;&#39;</span><span class="p">))</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">))</span>

<span class="n">data</span><span class="o">.</span><span class="n">distinction_in_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">distinction_in_name</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;distinction_in_name&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of distinction_in_name per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_58_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is interesting to note that those who have some type of reference or distinction in their names had a higher survival rate.</p>
<p>Next, we find 872 surnames in this dataset. Even adding loners in a single category, we have 229 with more than one member. It's a hauge categoriacal data to work, and it is to much sparse. The most of then has too few samples to really has significates to allmost of algoritimes, whiout risk to occours overfiting. In addition, there are 18 surnames cases with more than one member exclusively in the test data set.</p>
<p>So, we create this feature with aggregation of unique member into one category and use this at models that could work on it to ckeck if we get better results. Alternatively, we can use dimensionality reduction methods.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total of differents surnames aboard:&#39;</span><span class="p">,</span>
      <span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[A-z]*\,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;More then one persons aboard with smae surnames:&#39;</span><span class="p">,</span>
      <span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[A-z]*\,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="n">surnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[A-z]*\,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;surname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[A-z]*\,&#39;</span><span class="p">)</span><span class="o">.</span>\
 <span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">surnames</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;Alone&#39;</span><span class="p">)</span>

<span class="n">test_surnames</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">surname</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Surnames with more than one member aboard that happens only in the test data set:&#39;</span><span class="p">,</span> 
      <span class="mi">240</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">test_surnames</span><span class="p">))</span>

<span class="n">train_surnames</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">surname</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Surnames with more than one member aboard that happens only in the train data set:&#39;</span><span class="p">,</span> 
      <span class="mi">240</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">train_surnames</span><span class="p">))</span>

<span class="n">both_surnames</span> <span class="o">=</span> <span class="n">test_surnames</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">train_surnames</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">surname</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">test_surnames</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">]))</span> <span class="k">else</span> <span class="s1">&#39;Exclude&#39;</span><span class="p">)</span>

<span class="k">del</span> <span class="n">surnames</span><span class="p">,</span> <span class="n">both_surnames</span><span class="p">,</span> <span class="n">test_surnames</span><span class="p">,</span> <span class="n">train_surnames</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Total of differents surnames aboard: 872
More then one persons aboard with smae surnames: 239
Surnames with more than one member aboard that happens only in the test data set: 18
Surnames with more than one member aboard that happens only in the train data set: 76
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Cabin">Cabin<a class="anchor-link" href="#Cabin">&#182;</a></h4><p>This information has to many nulls, but when it exist we can know what is the <a href="https://www.encyclopedia-titanica.org/titanic-deckplans/">deck</a> of the passenger, and some distinguish passengers from the same class.
<img height="5" width="800" src=http://www.paullee.com/titanic/flood_pics/Titanic_side_d_deck.PNG>
Let's start applying the same cabin to null cases where there are samples with cabins for the same ticket.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">CabinByTicket</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;Ticket&#39;</span><span class="p">,</span> <span class="s1">&#39;Cabin&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Ticket&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">min</span><span class="p">)</span>
<span class="n">before</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="s1">&#39;Cabin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="s1">&#39;Ticket&#39;</span><span class="p">]</span><span class="o">.</span>\
   <span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">CabinByTicket</span><span class="p">[</span><span class="n">CabinByTicket</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cabin nulls reduced:&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">before</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="k">del</span> <span class="n">CabinByTicket</span><span class="p">,</span> <span class="n">before</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Cabin nulls reduced: 16
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span> <span class="o">=</span> <span class="s1">&#39;N999&#39;</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[^a-z]\d\d*&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Cabin</span><span class="p">))</span><span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Cabin</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Cabin</span><span class="p">))</span><span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">x</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Fare&#39;</span><span class="p">,</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">]))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="5" halign="left">Fare</th>
    </tr>
    <tr>
      <th></th>
      <th>median</th>
      <th>mean</th>
      <th>count_nonzero</th>
      <th>amax</th>
      <th>amin</th>
    </tr>
    <tr>
      <th>Cabin_Letter</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>35.07710</td>
      <td>41.244314</td>
      <td>21.0</td>
      <td>81.8583</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>B</th>
      <td>84.38335</td>
      <td>131.484438</td>
      <td>65.0</td>
      <td>512.3292</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>C</th>
      <td>90.00000</td>
      <td>112.161300</td>
      <td>104.0</td>
      <td>263.0000</td>
      <td>25.7000</td>
    </tr>
    <tr>
      <th>D</th>
      <td>52.55420</td>
      <td>53.007339</td>
      <td>46.0</td>
      <td>113.2750</td>
      <td>12.8750</td>
    </tr>
    <tr>
      <th>E</th>
      <td>51.86250</td>
      <td>49.557091</td>
      <td>47.0</td>
      <td>134.5000</td>
      <td>7.2292</td>
    </tr>
    <tr>
      <th>F</th>
      <td>19.50000</td>
      <td>22.303571</td>
      <td>14.0</td>
      <td>39.0000</td>
      <td>7.7500</td>
    </tr>
    <tr>
      <th>G</th>
      <td>10.46250</td>
      <td>11.291667</td>
      <td>9.0</td>
      <td>16.7000</td>
      <td>7.6500</td>
    </tr>
    <tr>
      <th>N</th>
      <td>10.50000</td>
      <td>16.861973</td>
      <td>985.0</td>
      <td>133.6500</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>T</th>
      <td>35.50000</td>
      <td>35.500000</td>
      <td>1.0</td>
      <td>35.5000</td>
      <td>35.5000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Does't exist Cabin T in test dataset. This passenger is from first class and his passenger fare is the same from others 5 first class passengers. So, changed to 'C' to made same distribution between the six.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;T&#39;</span><span class="p">])</span>

<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">==</span><span class="mf">35.5</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">==</span><span class="s1">&#39;T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>...</th>
      <th>passenger_fare</th>
      <th>SibSp_bin</th>
      <th>Parch_bin</th>
      <th>family</th>
      <th>non_relatives</th>
      <th>Personal_Titles</th>
      <th>distinction_in_name</th>
      <th>surname</th>
      <th>Cabin_Letter</th>
      <th>Cabin_Number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>339</th>
      <td>340</td>
      <td>0</td>
      <td>1</td>
      <td>Blackwell, Mr. Stephen Weart</td>
      <td>male</td>
      <td>45.0</td>
      <td>0</td>
      <td>0</td>
      <td>113784</td>
      <td>35.5</td>
      <td>...</td>
      <td>35.5</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>Mr</td>
      <td>0</td>
      <td>Alone</td>
      <td>T</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1 rows  26 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>B    2
A    2
C    1
T    1
Name: Cabin_Letter, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Fill Cabins letters NAs of third class with most common patterns of the same passenger fare range with one or lessen possible cases.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">6.237</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
  <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">6.237</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">6.237</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
  <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">6.237</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">7.225</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">6.237</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
  <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">7.225</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">6.237</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">7.225</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">6.237</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
  <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">7.225</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">6.237</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">7.65</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">7.225</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
  <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">7.65</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">7.225</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">7.65</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">7.225</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
  <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">7.65</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">7.225</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">7.75</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">7.65</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
  <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">7.75</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">7.65</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">7.75</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">7.65</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
  <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">7.75</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">7.65</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">8.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">7.75</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
  <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">8.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">7.75</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">8.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">7.75</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
  <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">8.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">7.75</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">8.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
  <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">8.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">8.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
  <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">8.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Fill Cabins letters NAs of second class with most common patterns of the same passanger fare range with one or lessen possible cases.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">8.59</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">8.59</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">8.59</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">8.59</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">8.59</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">10.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">8.59</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">10.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">8.59</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">10.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">8.59</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">10.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">10.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">10.501</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">10.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">10.501</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">10.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">10.501</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">10.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">10.501</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">10.501</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">12.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">10.501</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">12.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">10.501</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">12.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">10.501</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">12.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">12.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">13.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">12.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">13.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">12.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">13.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">12.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">13.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">13.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">13.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">13.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">13.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">13.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">13.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">13.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;</span><span class="mf">13.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">13.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">13.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">13.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;=</span><span class="mf">13.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Fill Cabins letters NAs of first class with most common patterns of the same passanger fare range with one or lessen possible cases.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">19.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">19.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">19.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">19.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">19.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">23.374</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">19.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">23.374</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">19.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">23.374</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">19.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">23.374</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">23.374</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">25.25</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">23.374</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">25.25</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">23.374</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">25.25</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">23.374</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">25.25</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">25.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">25.929</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">25.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">25.929</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">25.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">25.929</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">25.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">25.929</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">25.99</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">26.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">25.99</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">26.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">25.99</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">26.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">25.99</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">26.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">26.549</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">26.55</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">26.549</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">26.55</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">26.549</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">26.55</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">26.549</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">26.55</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">27.4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">27.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">27.4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">27.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">27.4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">27.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">27.4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">27.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">27.7207</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">27.7208</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">27.7207</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">27.7208</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">27.7207</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">27.7208</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">27.7207</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">27.7208</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">29.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">29.7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">29.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">29.7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">29.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">29.7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">29.69</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">29.7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">30.49</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">30.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">30.49</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">30.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">30.49</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">30.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">30.49</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">30.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">30.6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">30.7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">30.6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">30.7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">30.6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">30.7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">30.6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">30.7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">31.67</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">31.684</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">31.67</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">31.684</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">31.67</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">31.684</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">31.67</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">31.684</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">39.599</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">39.6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">39.599</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">39.6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">39.599</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">39.6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">39.599</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">39.6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">41</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">41.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">41</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">41.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">41</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">41.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">41</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">41.2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">45.49</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">45.51</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">45.49</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">45.51</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">45.49</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">45.51</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">45.49</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">45.51</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">49.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">49.51</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">49.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">49.51</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">49.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">49.51</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mf">49.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mf">49.51</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">65</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mi">70</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">65</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mi">70</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Letter</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">65</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mi">70</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">==</span><span class="s1">&#39;N999&#39;</span><span class="p">),</span> <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">]</span> <span class="o">=</span>\
    <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&gt;</span><span class="mi">65</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">&lt;=</span><span class="mi">70</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Cabin</span><span class="o">!=</span><span class="s1">&#39;N999&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">Cabin_Number</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>See below that we conquist a good results after filling nulls, but we need attention since they have too many nulls originally. In addition, the cabin may actually have made more difference in the deaths caused by the impact and not so much among those who drowned.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">charts</span><span class="p">(</span><span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of Cabin_Letter per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_73_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Rescue-of-family-relationships">Rescue of family relationships<a class="anchor-link" href="#Rescue-of-family-relationships">&#182;</a></h4><p><img  align='right' width="350" src=http://www3.sympatico.ca/rmmayette/images/FamillePC.jpg></p>
<p>After some work, we notice that is difficult to understand SibSp and Patch isolated, and is difficult to extract directly families relationships from this data without a closer look.</p>
<p>So, in that configuration we not have clearly families relationships, and this information is primary to use for apply ages to ages with null with better distribution and accuracy.</p>
<p>Let's start to rescue:</p>
<p>The first treatment, I discovered when check the results and noticed that I didn't apply any relationship to a one case. Look the details below, we can see that is a case of a family with more than one ticket and the son has no age. So, I just manually applied this one case as a son, since the others menber the father and the mother, and the son has the pattern 0 in SibSp and Parch 2</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;Bourke&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">))</span><span class="o">==</span><span class="s1">&#39;Bourke&#39;</span><span class="p">])</span>
<span class="n">family_w_age</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Ticket</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Parch</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">SibSp</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">==-</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Ticket</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">family_w_age</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Ticket&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>...</th>
      <th>passenger_fare</th>
      <th>SibSp_bin</th>
      <th>Parch_bin</th>
      <th>family</th>
      <th>non_relatives</th>
      <th>Personal_Titles</th>
      <th>distinction_in_name</th>
      <th>surname</th>
      <th>Cabin_Letter</th>
      <th>Cabin_Number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>188</th>
      <td>189</td>
      <td>0</td>
      <td>3</td>
      <td>Bourke, Mr. John</td>
      <td>male</td>
      <td>40.0</td>
      <td>1</td>
      <td>1</td>
      <td>364849</td>
      <td>15.50</td>
      <td>...</td>
      <td>7.75</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>-1</td>
      <td>Mr</td>
      <td>0</td>
      <td>Bourke</td>
      <td>F</td>
      <td>3</td>
    </tr>
    <tr>
      <th>593</th>
      <td>594</td>
      <td>0</td>
      <td>3</td>
      <td>Bourke, Miss. Mary</td>
      <td>female</td>
      <td>NaN</td>
      <td>0</td>
      <td>2</td>
      <td>364848</td>
      <td>7.75</td>
      <td>...</td>
      <td>7.75</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>-2</td>
      <td>Miss</td>
      <td>0</td>
      <td>Bourke</td>
      <td>F</td>
      <td>3</td>
    </tr>
    <tr>
      <th>657</th>
      <td>658</td>
      <td>0</td>
      <td>3</td>
      <td>Bourke, Mrs. John (Catherine)</td>
      <td>female</td>
      <td>32.0</td>
      <td>1</td>
      <td>1</td>
      <td>364849</td>
      <td>15.50</td>
      <td>...</td>
      <td>7.75</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>-1</td>
      <td>Mrs</td>
      <td>1</td>
      <td>Bourke</td>
      <td>F</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>3 rows  26 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt output_prompt">Out[37]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>...</th>
      <th>passenger_fare</th>
      <th>SibSp_bin</th>
      <th>Parch_bin</th>
      <th>family</th>
      <th>non_relatives</th>
      <th>Personal_Titles</th>
      <th>distinction_in_name</th>
      <th>surname</th>
      <th>Cabin_Letter</th>
      <th>Cabin_Number</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows  26 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sons&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> \
                          <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">Ticket</span> <span class="ow">in</span> <span class="p">([</span><span class="s1">&#39;2661&#39;</span><span class="p">,</span> <span class="s1">&#39;2668&#39;</span><span class="p">,</span> <span class="s1">&#39;A/5. 851&#39;</span><span class="p">,</span> <span class="s1">&#39;4133&#39;</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">SibSp</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">))</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">sons</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> \
                        <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">Ticket</span> <span class="ow">in</span> <span class="p">([</span><span class="s1">&#39;CA. 2343&#39;</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">SibSp</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">))</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="n">data</span><span class="o">.</span><span class="n">sons</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> \
                        <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">Ticket</span> <span class="ow">in</span> <span class="p">([</span><span class="s1">&#39;W./C. 6607&#39;</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Personal_Titles</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">([</span><span class="s1">&#39;Mr&#39;</span><span class="p">,</span> <span class="s1">&#39;Mrs&#39;</span><span class="p">])))</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">sons</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">Parch</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">))</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">594</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Sun with diferente pattern (family with two tickets)</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">1252</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Case of &#39;CA. 2343&#39; and last rule</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">1084</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Case of &#39;A/5. 851&#39; and last rule</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">1231</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Case of &#39;A/5. 851&#39; and last rule</span>

<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;sons&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of sons per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_76_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We observe that has only 12.1% of sons, and their had better survival rate than others.</p>
<p>Next, we rescue the parents, and check cases where we have both (mother and father), and cases where we have only one aboard.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;parents&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> \
                              <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">Ticket</span> <span class="ow">in</span> <span class="p">([</span><span class="s1">&#39;2661&#39;</span><span class="p">,</span> <span class="s1">&#39;2668&#39;</span><span class="p">,</span> <span class="s1">&#39;A/5. 851&#39;</span><span class="p">,</span> <span class="s1">&#39;4133&#39;</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">SibSp</span><span class="o">==</span><span class="mi">0</span><span class="p">))</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">parents</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> \
                              <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">Ticket</span> <span class="ow">in</span> <span class="p">([</span><span class="s1">&#39;CA. 2343&#39;</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">SibSp</span><span class="o">==</span><span class="mi">1</span><span class="p">))</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">parents</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">Ticket</span> <span class="ow">in</span> <span class="p">([</span><span class="s1">&#39;W./C. 6607&#39;</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Personal_Titles</span> <span class="ow">in</span> <span class="p">([</span><span class="s1">&#39;Mr&#39;</span><span class="p">,</span> <span class="s1">&#39;Mrs&#39;</span><span class="p">])))</span> \
                                <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Identify parents and care nulls ages</span>
<span class="n">data</span><span class="o">.</span><span class="n">parents</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">Parch</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">SibSp</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;</span><span class="mi">19</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;=</span><span class="mi">45</span><span class="p">)</span> <span class="p">)</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;parents&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of parents per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_78_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;parent_alone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">Parch</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">SibSp</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;</span><span class="mi">19</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;=</span><span class="mi">45</span><span class="p">)</span> <span class="p">)</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;parent_alone&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of parent_alone per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_79_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can notice that the both cases are to similar and it is not significant to has this two information separately.</p>
<p>Before I put them together, as I had learned in assembling the sons, I made a visual inspection and discovered some cases os sons and parents that required different rules for assigning them. As I did visually and this is not a rule for a pipeline, I proceeded with the settings manually.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t_p_alone</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Ticket</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Ticket</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">t_p_alone</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Ticket&#39;</span><span class="p">)[</span><span class="mi">96</span><span class="p">:]</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">141</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">541</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">541</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">1078</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">1078</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">98</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">98</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">680</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">680</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">915</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">915</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">333</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">333</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">119</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">119</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">319</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">319</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">103</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">103</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parents</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">154</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">1084</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parents</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">581</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">581</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">881</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">881</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">1294</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">1294</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">378</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">378</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">167</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">357</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">357</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">918</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">918</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">1042</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">1042</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">540</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="o">==</span><span class="mi">540</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span><span class="o">.</span><span class="n">parents</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">parent_alone</span> 
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;parents&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of parents per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_81_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we rescue the grandparents and grandparents alone. We found the same situations with less cases and decided put all parents and grandparents in one feature and leave to age distinguish them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;grandparents&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">Parch</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">SibSp</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;</span><span class="mi">19</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;</span><span class="mi">45</span><span class="p">)</span> <span class="p">)</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;grandparents&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of grandparents per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_83_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;grandparent_alone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">Parch</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">SibSp</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;</span><span class="mi">45</span><span class="p">)</span> <span class="p">)</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;grandparent_alone&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of grandparent_alone per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_84_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">parents</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">grandparent_alone</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">grandparents</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;parents&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of parents per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_85_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we indetify the relatives aboard</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;relatives&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">SibSp</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Parch</span><span class="o">==</span><span class="mi">0</span><span class="p">))</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;relatives&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of relatives per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_87_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And then, the companions, persons who traveled with a family but do not have family relationship with them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;companions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">SibSp</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Parch</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">same_tckt</span><span class="o">==</span><span class="mi">1</span><span class="p">))</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;companions&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of companions per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_89_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we rescue the passengers that traveled alone.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;alone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">SibSp</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Parch</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">same_tckt</span><span class="o">==</span><span class="mi">0</span><span class="p">))</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">charts</span><span class="p">(</span><span class="s1">&#39;alone&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of alone per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_91_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, people with a family relationship, even if only as companions, had better survival rates and very close, than people who traveled alone.</p>
<p>Now we can work on issues of nulls ages and then on own information of age.</p>
<h4 id="Age">Age<a class="anchor-link" href="#Age">&#182;</a></h4><p><img width='300' align='right' src=https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/Titanic_lifeboat.jpg/250px-Titanic_lifeboat.jpg></p>
<p>We start with the numbers of nulls case by survived to remenber that is too high.</p>
<p>Then, we polt the distributions of Ages, to check how is fit into the normal and see the distortions when apply a unique value (zero) to the nulls cases.</p>
<p>Next, we made the scatter plot of Ages and siblings, and see hat age decreases with the increase in the number of siblings, but with a great range</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">fig1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">fit</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nulls as Zero&#39;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">Age</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Withou Nulls&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Survived without Age:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">Survived</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="n">fig2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">isnull</span><span class="p">())],</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;SibSp&#39;</span><span class="p">,</span>  <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Survived&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Survived without Age:
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_text output_subarea ">
<pre> 0    125
-1     86
 1     52
Name: Survived, dtype: int64</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_93_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From the tables below, we can see that our eforce to get Personal Titles and rescue family relationships produce better medians to apply on nulls ages.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean and median ages by siblings:&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;SibSp&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;SibSp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Median ages by Personal_Titles:&#39;</span><span class="p">)</span>
<span class="n">Ages</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;Age&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;median&#39;</span><span class="p">}}</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">][[</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Personal_Titles&#39;</span><span class="p">,</span> <span class="s1">&#39;parents&#39;</span><span class="p">,</span> <span class="s1">&#39;grandparents&#39;</span><span class="p">,</span> <span class="s1">&#39;sons&#39;</span><span class="p">,</span> <span class="s1">&#39;relatives&#39;</span><span class="p">,</span> <span class="s1">&#39;companions&#39;</span><span class="p">,</span> <span class="s1">&#39;alone&#39;</span><span class="p">]]</span><span class="o">.</span>\
        <span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Personal_Titles&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Ages</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Median ages by Personal Titles and Family Relationships:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">][[</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Personal_Titles&#39;</span><span class="p">,</span> <span class="s1">&#39;parents&#39;</span><span class="p">,</span> <span class="s1">&#39;grandparents&#39;</span><span class="p">,</span> 
                                          <span class="s1">&#39;sons&#39;</span><span class="p">,</span> <span class="s1">&#39;relatives&#39;</span><span class="p">,</span> <span class="s1">&#39;companions&#39;</span><span class="p">,</span><span class="s1">&#39;alone&#39;</span><span class="p">]],</span>
                       <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">,</span> 
                       <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;parents&#39;</span><span class="p">,</span> <span class="s1">&#39;grandparents&#39;</span><span class="p">,</span> <span class="s1">&#39;sons&#39;</span><span class="p">,</span> <span class="s1">&#39;relatives&#39;</span><span class="p">,</span> <span class="s1">&#39;companions&#39;</span><span class="p">,</span> <span class="s1">&#39;alone&#39;</span><span class="p">]</span> <span class="p">,</span> 
                       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Personal_Titles&#39;</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Nulls ages by Personal Titles and Family Relationships:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">][[</span><span class="s1">&#39;Personal_Titles&#39;</span><span class="p">,</span> <span class="s1">&#39;parents&#39;</span><span class="p">,</span> <span class="s1">&#39;grandparents&#39;</span><span class="p">,</span> <span class="s1">&#39;sons&#39;</span><span class="p">,</span> <span class="s1">&#39;relatives&#39;</span><span class="p">,</span> <span class="s1">&#39;companions&#39;</span><span class="p">,</span> <span class="s1">&#39;alone&#39;</span><span class="p">]]</span><span class="o">.</span>\
        <span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Personal_Titles&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="nb">sum</span><span class="p">]))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean and median ages by siblings:
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SibSp</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Age</th>
      <th>mean</th>
      <td>30.921766</td>
      <td>31.058071</td>
      <td>23.569444</td>
      <td>16.3125</td>
      <td>8.772727</td>
      <td>10.166667</td>
      <td>14.5</td>
    </tr>
    <tr>
      <th>median</th>
      <td>28.000000</td>
      <td>30.000000</td>
      <td>21.500000</td>
      <td>14.5000</td>
      <td>7.000000</td>
      <td>10.500000</td>
      <td>14.5</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Median ages by Personal_Titles:
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Personal_Titles</th>
      <th>Kid</th>
      <th>Miss</th>
      <th>Mr</th>
      <th>Mrs</th>
      <th>Royalty</th>
      <th>Technical</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Age</th>
      <th>median</th>
      <td>4.0</td>
      <td>22.0</td>
      <td>29.0</td>
      <td>35.0</td>
      <td>40.0</td>
      <td>49.5</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Median ages by Personal Titles and Family Relationships:
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="6" halign="left">Age</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>Personal_Titles</th>
      <th>Kid</th>
      <th>Miss</th>
      <th>Mr</th>
      <th>Mrs</th>
      <th>Royalty</th>
      <th>Technical</th>
    </tr>
    <tr>
      <th>parents</th>
      <th>grandparents</th>
      <th>sons</th>
      <th>relatives</th>
      <th>companions</th>
      <th>alone</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">0</th>
      <th rowspan="4" valign="top">0</th>
      <th rowspan="3" valign="top">0</th>
      <th rowspan="2" valign="top">0</th>
      <th>0</th>
      <th>1</th>
      <td>NaN</td>
      <td>23.0</td>
      <td>28.75</td>
      <td>36.0</td>
      <td>39.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <td>NaN</td>
      <td>30.0</td>
      <td>28.00</td>
      <td>40.0</td>
      <td>33.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <th>0</th>
      <td>12.0</td>
      <td>23.0</td>
      <td>30.00</td>
      <td>33.0</td>
      <td>48.5</td>
      <td>48.5</td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <th>0</th>
      <th>0</th>
      <td>4.0</td>
      <td>8.5</td>
      <td>18.00</td>
      <td>19.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>0</th>
      <th>0</th>
      <th>0</th>
      <th>0</th>
      <th>0</th>
      <td>NaN</td>
      <td>24.0</td>
      <td>38.00</td>
      <td>35.5</td>
      <td>NaN</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <th>0</th>
      <th>0</th>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>56.00</td>
      <td>50.0</td>
      <td>NaN</td>
      <td>61.5</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Nulls ages by Personal Titles and Family Relationships:
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>parents</th>
      <th>grandparents</th>
      <th>sons</th>
      <th>relatives</th>
      <th>companions</th>
      <th>alone</th>
    </tr>
    <tr>
      <th></th>
      <th>sum</th>
      <th>sum</th>
      <th>sum</th>
      <th>sum</th>
      <th>sum</th>
      <th>sum</th>
    </tr>
    <tr>
      <th>Personal_Titles</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Kid</th>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Miss</th>
      <td>0</td>
      <td>0</td>
      <td>10</td>
      <td>7</td>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>Mr</th>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>16</td>
      <td>20</td>
      <td>135</td>
    </tr>
    <tr>
      <th>Mrs</th>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>11</td>
      <td>3</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Technical</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, we apply to the nulls ages the respectively median of same personal title and same family relationship, but before,  we create a binary feature to maintain the information of the presence of nulls.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Without_Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">companions</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Miss&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">companions</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Miss&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">companions</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mr&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">companions</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mr&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">companions</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mrs&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">companions</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mrs&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">alone</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Kid&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">alone</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Kid&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">alone</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Technical&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">alone</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Technical&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">alone</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Miss&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">alone</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Miss&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">alone</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mr&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">alone</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mr&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">alone</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mrs&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">alone</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mrs&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">parents</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mr&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">parents</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mr&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">parents</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mrs&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">parents</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mrs&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Kid&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Kid&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Kid&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Kid&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Miss&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Miss&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mr&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mr&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mrs&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mrs&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">relatives</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Miss&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">relatives</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Miss&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">relatives</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mr&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mr&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">relatives</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mrs&#39;</span><span class="p">)]</span> <span class="o">=</span> \
   <span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">relatives</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles</span><span class="o">==</span><span class="s1">&#39;Mrs&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we check how age distribution lines after fill the nulls.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Age correlation with survived:&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">corr</span><span class="p">()[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Age</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;With nulls filled&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Age correlation with survived: -0.04046792444732172
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_99_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To have better understanding of age, its proportion and its relation to survival ration, we binin it as follow</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">binningAge</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="c1"># Binning Age based on custom ranges</span>
    <span class="n">bin_ranges</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span> 
    <span class="n">bin_names</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age_bin_custom_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Age</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="n">bin_ranges</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age_bin_custom_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Age</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="n">bin_ranges</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">bin_names</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">binningAge</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Age_bin_custom_range&#39;</span><span class="p">,</span> <span class="s1">&#39;Age_bin_custom_label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Age_bin_custom_range&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">]],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">,</span> 
                       <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Age_bin_custom_range&#39;</span><span class="p">]))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Age_bin_custom_range</th>
      <th>Age_bin_custom_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>485</th>
      <td>8.50</td>
      <td>(8.0, 15.0]</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1077</th>
      <td>21.00</td>
      <td>(18.0, 25.0]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>754</th>
      <td>48.00</td>
      <td>(25.0, 55.0]</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1282</th>
      <td>51.00</td>
      <td>(25.0, 55.0]</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1275</th>
      <td>28.75</td>
      <td>(25.0, 55.0]</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Age_bin_custom_range</th>
      <th>(0.0, 1.7]</th>
      <th>(1.7, 8.0]</th>
      <th>(8.0, 15.0]</th>
      <th>(15.0, 18.0]</th>
      <th>(18.0, 25.0]</th>
      <th>(25.0, 55.0]</th>
      <th>(55.0, 65.0]</th>
      <th>(65.0, 100.0]</th>
    </tr>
    <tr>
      <th>Survived</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-1</th>
      <td>16</td>
      <td>28</td>
      <td>30</td>
      <td>58</td>
      <td>200</td>
      <td>466</td>
      <td>34</td>
      <td>4</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>18</td>
      <td>24</td>
      <td>46</td>
      <td>114</td>
      <td>317</td>
      <td>21</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>24</td>
      <td>52</td>
      <td>28</td>
      <td>44</td>
      <td>146</td>
      <td>366</td>
      <td>22</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">charts</span><span class="p">(</span><span class="s1">&#39;Age_bin_custom_label&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
           ____________________________ Plots of Age_bin_custom_label per Survived and Dead: ____________________________
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_102_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="One-hot-encode-and-drop-provisory-and-unseless-features">One hot encode and drop provisory and unseless features<a class="anchor-link" href="#One-hot-encode-and-drop-provisory-and-unseless-features">&#182;</a></h3><p>One hot encode categorical and non ordinal data and drop useless features.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[54]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Sex</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="s1">&#39;male&#39;</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Cabin&#39;</span><span class="p">,</span> <span class="s1">&#39;Ticket&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;same_tckt&#39;</span><span class="p">,</span> <span class="s1">&#39;qtd_same_ticket&#39;</span><span class="p">,</span> <span class="s1">&#39;parent_alone&#39;</span><span class="p">,</span> <span class="s1">&#39;grandparents&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;grandparent_alone&#39;</span><span class="p">,</span> <span class="s1">&#39;Age_bin_custom_range&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># , &#39;Age&#39;, &#39;Parch&#39;, &#39;SibSp&#39;,</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Cabin_Letter&#39;</span><span class="p">,</span> <span class="s1">&#39;Personal_Titles&#39;</span><span class="p">,</span> <span class="s1">&#39;Embarked&#39;</span><span class="p">,</span> <span class="s1">&#39;distinction_in_tikect&#39;</span><span class="p">])</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;surname&#39;</span><span class="p">])</span> <span class="c1"># &#39;Age_bin_custom_label&#39;</span>
<span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;surname_Exclude&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Scipys pearsonr method computes both the correlation and p-value for the correlation, roughly showing the probability of an uncorrelated system creating a correlation value of this magnitude.
import numpy as np
from scipy.stats import pearsonr
pearsonr(data.loc[:, 'Pclass'], data.Survived)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Select-Features">Select Features<a class="anchor-link" href="#Select-Features">&#182;</a></h2><p>All of the features we find in the dataset might not be useful in building a machine learning model to make the necessary prediction. Using some of the features might even make the predictions worse. 
<img src="attachment:image.png" alt="image.png">
Often in data science we have hundreds or even millions of features and we want a way to create a model that only includes the most important features. This has three benefits.</p>
<ol>
<li>It reduces the variance of the model, and therefore overfitting. </li>
<li>It reduces the complexity of a model and makes it easier to interpret.</li>
<li>It improves the accuracy of a model if the right subset is chosen.</li>
<li>Finally, it reduces the computational cost (and time) of training a model. </li>
</ol>
<p>So, an alternative way to reduce the complexity of the model and avoid overftting is dimensionality reduction via feature selection, which is especially useful for unregularized models. There are two main categories of dimensionality reduction techniques: feature selection and feature extraction. Using feature selection, we select a subset of the original features. In feature extraction, we derive information from the feature set to construct a new feature subspace.</p>
<p>Exist various methodologies and techniques that you can use to subset your feature space and help your models perform better and efficiently. So, lets get started.</p>
<h3 id="First-check-for-any-correlations-between-features">First check for any correlations between features<a class="anchor-link" href="#First-check-for-any-correlations-between-features">&#182;</a></h3><p>Correlation is a statistical term which in common usage refers to how close two features are to having a linear relationship with each other. The  Pearson's correlation which measures linear correlation between two features, the resulting value lies in [-1;1], with -1 meaning perfect negative correlation (as one feature increases, the other decreases), +1 meaning perfect positive correlation and 0 meaning no linear correlation between the two features.</p>
<p>Features with high correlation are more linearly dependent and hence have almost the same effect on the dependent variable. So, <strong><em>when two features have high correlation, we can drop one of the two features</em></strong>.</p>
<p>There are five assumptions that are made with respect to Pearson's correlation:</p>
<ul>
<li>The feature must be either interval or ratio measurements.</li>
<li>The variables must be approximately normally distributed.</li>
<li>There is a linear relationship between the two variables.</li>
<li>Outliers are either kept to a minimum or are removed entirely</li>
<li>There is homoscedasticity of the data. Homoscedasticity basically means that the variances along the line of best fit remain similar as you move along the line.</li>
</ul>
<p>One obvious drawback of Pearson correlation as a feature ranking mechanism is that it is only sensitive to a linear relationship. If the relation is non-linear, Pearson correlation can be close to zero even if there is a 1-1 correspondence between the two variables. For example, correlation between x and x2 is zero, when x is centered on 0.</p>
<p>Furthermore, relying only on the correlation value on interpreting the relationship of two variables can be highly misleading, so it is always worth plotting the data as we did on the EDA phase.</p>
<p>The following guidelines interpreting Pearson's correlation coefficient (r):</p>
<table>
<thead><tr>
<th>Strength of Association</th>
<th>r Positive</th>
<th>r Negative</th>
</tr>
</thead>
<tbody>
<tr>
<td>Small</td>
<td>.1 to  .3</td>
<td>-0.1 to -0.3</td>
</tr>
<tr>
<td>Medium</td>
<td>.3 to  .5</td>
<td>-0.3 to -0.5</td>
</tr>
<tr>
<td>Large</td>
<td>.5 to 1.0</td>
<td>-0.5 to -1.0</td>
</tr>
</tbody>
</table>
<p>The correlation matrix is identical to a covariance matrix computed from standardized data. The correlation matrix is a square matrix that contains the Pearson product-moment correlation coefficients (often abbreviated as Pearson's r), which measure the linear dependence between pairs of features. Pearson's correlation coefficient can simply be calculated as the covariance between two features x and y (numerator) divided by the product of their standard deviations (denominator):</p>
<p>The covariance between standardized features is in fact equal to their linear correlation coefficient.</p>
<p>Let's check what are the highest correlations with survived, I will now create a correlation matrix to quantify the linear relationship between the features. To do this I use NumPy's corrcoef and seaborn's heatmap function to plot the correlation matrix array as a heat map.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[55]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">corr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">:]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">top_corr_cols</span> <span class="o">=</span> <span class="n">corr</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">corr</span><span class="o">.</span><span class="n">Survived</span><span class="p">)</span><span class="o">&gt;=</span><span class="mf">0.06</span><span class="p">]</span><span class="o">.</span><span class="n">Survived</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="n">top_corr</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">top_corr_cols</span><span class="p">,</span> <span class="n">top_corr_cols</span><span class="p">]</span>
<span class="n">dropSelf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">top_corr</span><span class="p">)</span>
<span class="n">dropSelf</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">dropSelf</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">top_corr</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">diverging_palette</span><span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">dropSelf</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_107_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see we have more surnames between 0.05 and 0.06 of correlation wit Survived.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">corr</span><span class="p">[(</span><span class="nb">abs</span><span class="p">(</span><span class="n">corr</span><span class="o">.</span><span class="n">Survived</span><span class="p">)</span><span class="o">&gt;=</span><span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">corr</span><span class="o">.</span><span class="n">Survived</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.06</span><span class="p">)]</span><span class="o">.</span><span class="n">Survived</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="k">del</span> <span class="n">corr</span><span class="p">,</span> <span class="n">dropSelf</span><span class="p">,</span> <span class="n">top_corr</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>Index([&#39;surname_Harper&#39;, &#39;surname_Beckwith&#39;, &#39;surname_Goldenberg&#39;,
       &#39;surname_Moor&#39;, &#39;surname_Chambers&#39;, &#39;surname_Hamalainen&#39;,
       &#39;surname_Dick&#39;, &#39;surname_Taylor&#39;, &#39;surname_Doling&#39;, &#39;surname_Gordon&#39;,
       &#39;surname_Beane&#39;, &#39;surname_Hippach&#39;, &#39;surname_Bishop&#39;,
       &#39;surname_Mellinger&#39;, &#39;surname_Yarred&#39;, &#39;Personal_Titles_Royalty&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Drop-the-features-with-highest-correlations-to-other-Features:">Drop the features with highest correlations to other Features:<a class="anchor-link" href="#Drop-the-features-with-highest-correlations-to-other-Features:">&#182;</a></h4><p><strong>Colinearity</strong> is the state where two variables are highly correlated and contain similiar information about the variance within a given dataset. And as you see above, it is easy to find <strong><em>higest colinearities</em></strong> (<strong><em>Personal_Titles_Mrs</em></strong>, <strong><em>Personal_Titles_Mr</em></strong> and <strong><em>Fare</em></strong>.</p>
<p>You should always be concerned about the collinearity, regardless of the model/method being linear or not, or the main task being prediction or classification.</p>
<p>Assume a number of linearly correlated covariates/features present in the data set and Random Forest as the method. Obviously, random selection per node may pick only (or mostly) collinear features which may/will result in a poor split, and this can happen repeatedly, thus negatively affecting the performance.</p>
<p>Now, the collinear features may be less informative of the outcome than the other (non-collinear) features and as such they should be considered for elimination from the feature set anyway. However, assume that the features are ranked high in the 'feature importance' list produced by RF. As such they would be kept in the data set unnecessarily increasing the dimensionality. So, in practice, I'd always, as an exploratory step (out of many related) check the pairwise association of the features, including linear correlation.</p>
<h4 id="Identify--and-treat-Multicolinearity:">Identify  and treat Multicolinearity:<a class="anchor-link" href="#Identify--and-treat-Multicolinearity:">&#182;</a></h4><p><strong>Multicolinearity</strong> is more troublesome to detect because it emerges when three or more variables, which are highly correlated, are included within a model, leading to unreliable and unstable estimates of regression coefficients. To make matters worst multicolinearity can emerge even when isolated pairs of variables are not colinear.</p>
<p>To identify, we need start with the coefficient of determination, r<sup>2</sup>, is the square of the Pearson correlation coefficient r. The coefficient of determination, with respect to correlation, is the proportion of the variance that is shared by both variables. It gives a measure of the amount of variation that can be explained by the model (the correlation is the model). It is sometimes expressed as a percentage (e.g., 36% instead of 0.36) when we discuss the proportion of variance explained by the correlation. However, you should not write r2 = 36%, or any other percentage. You should write it as a proportion (e.g., r2 = 0.36).</p>
<p>Already the <strong>Variance Inflation Factor</strong> (<strong>VIF</strong>) is a measure of colinearity among predictor variables within a multiple regression.  It is may be calculated for each predictor by doing a linear regression of that predictor on all the other predictors, and then obtaining the R<sup>2</sup> from that regression.  It is calculated by taking the the ratio of the variance of all a given model's betas divide by the variane of a single beta if it were fit alone [1/(1-R<sup>2</sup>)]. Thus, a VIF of 1.8 tells us that the variance (the square of the standard error) of a particular coefficient is 80% larger than it would be if that predictor was completely uncorrelated with all the other predictors. The VIF has a lower bound of 1 but no upper bound. Authorities differ on how high the VIF has to be to constitute a problem (e.g.: 2.50 (R<sup>2</sup> equal to 0.6), sometimes 5 (R<sup>2</sup> equal to .8), or greater than 10 (R<sup>2</sup> equal to 0.9) and so on).</p>
<p>But there are several situations in which multicollinearity can be safely ignored:</p>
<ul>
<li><strong><em>Interaction terms</em></strong> and <strong><em>higher-order terms</em></strong> (e.g., <strong><em>squared</em></strong> and <strong><em>cubed predictors</em></strong>) <strong><em>are correlated</em></strong> with main effect terms because they include the main effects terms. <strong>Ops!</strong> Sometimes we use <strong><em>polynomials</em></strong> to solve problems, <strong>indeed!</strong> But keep calm, in these cases,  <strong>standardizing</strong> the predictors can <strong>removed the multicollinearity</strong>. </li>
<li><strong><em>Indicator</em></strong>, like <strong><em>dummy</em></strong> or <strong><em>onde-hot-encode</em></strong>, that represent a <strong><em>categorical variable with three or more categories</em></strong>. If the proportion of cases in the reference category is small, the indicator will necessarily have high VIFs, even if the categorical is not associated with other variables in the regression model. But, you need check if some dummy is collinear or has multicollinearity with other features outside of their dummies.</li>
<li><strong>*Control feature</strong> if the <strong><em>feature of interest</em></strong> <strong>do not have high VIFs</strong>. Heres the thing about multicollinearity: its only a problem for the features that are <strong>collinear</strong>. It increases the standard errors of their coefficients, and it may make those coefficients unstable in several ways. But so long as the collinear feature are only used as control feature, and they are not collinear with your feature of interest, theres no problem. The coefficients of the features of interest are not affected, and the performance of the control feature as controls is not impaired.</li>
</ul>
<p>So, generally, we could run the same model twice, once with severe multicollinearity and once with moderate multicollinearity. This provides a great head-to-head comparison and it reveals the classic effects of multicollinearity. However, when standardizing your predictors doesnt work, you can try other solutions such as:</p>
<ul>
<li>removing highly correlated predictors</li>
<li>linearly combining predictors, such as adding them together</li>
<li>running entirely different analyses, such as partial least squares regression or principal components analysis</li>
</ul>
<p>When considering a solution, keep in mind that all remedies have potential drawbacks. If you can live with less precise coefficient estimates, or a model that has a high R-squared but few significant predictors, doing nothing can be the correct decision because it won't impact the fit.</p>
<p>Given the potential for correlation among the predictors, well have display the variance inflation factors (VIF), which indicate the extent to which multicollinearity is present in a regression analysis. Hence such variables need to be removed from the model. Deleting one variable at a time and then again checking the VIF for the model is the best way to do this.</p>
<p>So, I start the analysis removed the 3 features with he higest colinearities and the surnames different from my control surname_Alone and correlation with survived less then 0.05, and run VIF.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[57]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Step 1: Remove the higest correlations and run a multiple regression</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;family&#39;</span><span class="p">,</span>
         <span class="s1">&#39;non_relatives&#39;</span><span class="p">,</span>
         <span class="s1">&#39;surname_Alone&#39;</span><span class="p">,</span>
         <span class="s1">&#39;surname_Baclini&#39;</span><span class="p">,</span>
         <span class="s1">&#39;surname_Carter&#39;</span><span class="p">,</span>
         <span class="s1">&#39;surname_Richards&#39;</span><span class="p">,</span>
         <span class="s1">&#39;surname_Harper&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Beckwith&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Goldenberg&#39;</span><span class="p">,</span>
         <span class="s1">&#39;surname_Moor&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Chambers&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Hamalainen&#39;</span><span class="p">,</span>
         <span class="s1">&#39;surname_Dick&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Taylor&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Doling&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Gordon&#39;</span><span class="p">,</span>
         <span class="s1">&#39;surname_Beane&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Hippach&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Bishop&#39;</span><span class="p">,</span>
         <span class="s1">&#39;surname_Mellinger&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Yarred&#39;</span><span class="p">,</span> 
         <span class="s1">&#39;Pclass&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Age&#39;</span><span class="p">,</span>
         <span class="s1">&#39;SibSp&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Parch&#39;</span><span class="p">,</span>
         <span class="c1">#&#39;Fare&#39;,</span>
         <span class="s1">&#39;qtd_same_ticket_bin&#39;</span><span class="p">,</span>
         <span class="s1">&#39;passenger_fare&#39;</span><span class="p">,</span>
         <span class="c1">#&#39;SibSp_bin&#39;,</span>
         <span class="c1">#&#39;Parch_bin&#39;,</span>
         <span class="s1">&#39;distinction_in_name&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Cabin_Number&#39;</span><span class="p">,</span>
         <span class="s1">&#39;sons&#39;</span><span class="p">,</span>
         <span class="s1">&#39;parents&#39;</span><span class="p">,</span>
         <span class="s1">&#39;relatives&#39;</span><span class="p">,</span>
         <span class="s1">&#39;companions&#39;</span><span class="p">,</span>
         <span class="s1">&#39;alone&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Without_Age&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Age_bin_custom_label&#39;</span><span class="p">,</span>
         <span class="s1">&#39;genre&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Cabin_Letter_A&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Cabin_Letter_B&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Cabin_Letter_C&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Cabin_Letter_D&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Cabin_Letter_E&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Cabin_Letter_F&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Cabin_Letter_G&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Personal_Titles_Kid&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Personal_Titles_Miss&#39;</span><span class="p">,</span>
         <span class="c1">#&#39;Personal_Titles_Mr&#39;,</span>
         <span class="c1">#&#39;Personal_Titles_Mrs&#39;,</span>
         <span class="s1">&#39;Personal_Titles_Royalty&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Personal_Titles_Technical&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Embarked_C&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Embarked_Q&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Embarked_S&#39;</span><span class="p">,</span>
         <span class="s1">&#39;distinction_in_tikect_High&#39;</span><span class="p">,</span>
         <span class="s1">&#39;distinction_in_tikect_Low&#39;</span><span class="p">,</span>
         <span class="s1">&#39;distinction_in_tikect_Others&#39;</span><span class="p">,</span>
         <span class="s1">&#39;distinction_in_tikect_PC&#39;</span>
<span class="p">]</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
<span class="n">scale</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">(</span><span class="n">with_std</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scale</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span> <span class="n">cols</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">y_train</span><span class="p">,</span> <span class="n">df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># get y and X dataframes based on this regression:</span>
<span class="n">y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">dmatrices</span><span class="p">(</span><span class="s1">&#39;Survived ~&#39;</span> <span class="o">+</span> <span class="n">features</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;dataframe&#39;</span><span class="p">)</span>

<span class="c1">#Step 2: Calculate VIF Factors</span>
<span class="c1"># For each X, calculate VIF and save in dataframe</span>
<span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;VIF Factor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>

<span class="c1">#Step 3: Inspect VIF Factors</span>
<span class="n">display</span><span class="p">(</span><span class="n">vif</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;VIF Factor&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VIF Factor</th>
      <th>features</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.000000</td>
      <td>Intercept</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1.027080</td>
      <td>surname_Beane</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.039424</td>
      <td>surname_Mellinger</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1.048763</td>
      <td>surname_Doling</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.056317</td>
      <td>surname_Hamalainen</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.061651</td>
      <td>surname_Taylor</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.063774</td>
      <td>surname_Chambers</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.071730</td>
      <td>surname_Goldenberg</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.072810</td>
      <td>surname_Moor</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.081285</td>
      <td>surname_Beckwith</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1.082148</td>
      <td>surname_Dick</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1.083090</td>
      <td>surname_Hippach</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1.091573</td>
      <td>surname_Bishop</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.091714</td>
      <td>surname_Richards</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.097315</td>
      <td>surname_Harper</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.101053</td>
      <td>surname_Yarred</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.107265</td>
      <td>surname_Carter</td>
    </tr>
    <tr>
      <th>48</th>
      <td>1.121313</td>
      <td>Personal_Titles_Technical</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.133671</td>
      <td>surname_Baclini</td>
    </tr>
    <tr>
      <th>35</th>
      <td>1.382636</td>
      <td>Without_Age</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1.594563</td>
      <td>Cabin_Number</td>
    </tr>
    <tr>
      <th>47</th>
      <td>1.768952</td>
      <td>Personal_Titles_Royalty</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1.865907</td>
      <td>surname_Gordon</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2.156407</td>
      <td>Personal_Titles_Kid</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.201757</td>
      <td>surname_Alone</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2.954703</td>
      <td>distinction_in_name</td>
    </tr>
    <tr>
      <th>27</th>
      <td>3.750101</td>
      <td>passenger_fare</td>
    </tr>
    <tr>
      <th>22</th>
      <td>4.436090</td>
      <td>Pclass</td>
    </tr>
    <tr>
      <th>23</th>
      <td>4.742809</td>
      <td>Age</td>
    </tr>
    <tr>
      <th>46</th>
      <td>5.008117</td>
      <td>Personal_Titles_Miss</td>
    </tr>
    <tr>
      <th>37</th>
      <td>6.403387</td>
      <td>genre</td>
    </tr>
    <tr>
      <th>36</th>
      <td>7.591511</td>
      <td>Age_bin_custom_label</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.644149</td>
      <td>non_relatives</td>
    </tr>
    <tr>
      <th>26</th>
      <td>20.666651</td>
      <td>qtd_same_ticket_bin</td>
    </tr>
    <tr>
      <th>50</th>
      <td>39.868704</td>
      <td>Embarked_Q</td>
    </tr>
    <tr>
      <th>49</th>
      <td>74.967792</td>
      <td>Embarked_C</td>
    </tr>
    <tr>
      <th>51</th>
      <td>97.344161</td>
      <td>Embarked_S</td>
    </tr>
    <tr>
      <th>54</th>
      <td>inf</td>
      <td>distinction_in_tikect_Others</td>
    </tr>
    <tr>
      <th>53</th>
      <td>inf</td>
      <td>distinction_in_tikect_Low</td>
    </tr>
    <tr>
      <th>52</th>
      <td>inf</td>
      <td>distinction_in_tikect_High</td>
    </tr>
    <tr>
      <th>1</th>
      <td>inf</td>
      <td>family</td>
    </tr>
    <tr>
      <th>44</th>
      <td>inf</td>
      <td>Cabin_Letter_G</td>
    </tr>
    <tr>
      <th>43</th>
      <td>inf</td>
      <td>Cabin_Letter_F</td>
    </tr>
    <tr>
      <th>41</th>
      <td>inf</td>
      <td>Cabin_Letter_D</td>
    </tr>
    <tr>
      <th>40</th>
      <td>inf</td>
      <td>Cabin_Letter_C</td>
    </tr>
    <tr>
      <th>39</th>
      <td>inf</td>
      <td>Cabin_Letter_B</td>
    </tr>
    <tr>
      <th>38</th>
      <td>inf</td>
      <td>Cabin_Letter_A</td>
    </tr>
    <tr>
      <th>34</th>
      <td>inf</td>
      <td>alone</td>
    </tr>
    <tr>
      <th>33</th>
      <td>inf</td>
      <td>companions</td>
    </tr>
    <tr>
      <th>32</th>
      <td>inf</td>
      <td>relatives</td>
    </tr>
    <tr>
      <th>31</th>
      <td>inf</td>
      <td>parents</td>
    </tr>
    <tr>
      <th>30</th>
      <td>inf</td>
      <td>sons</td>
    </tr>
    <tr>
      <th>24</th>
      <td>inf</td>
      <td>SibSp</td>
    </tr>
    <tr>
      <th>25</th>
      <td>inf</td>
      <td>Parch</td>
    </tr>
    <tr>
      <th>42</th>
      <td>inf</td>
      <td>Cabin_Letter_E</td>
    </tr>
    <tr>
      <th>55</th>
      <td>inf</td>
      <td>distinction_in_tikect_PC</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From the results, I conclude that can safe maintain the dummies of Embarked, but need work in the remaining features where's the VIF stated as inf. You can see that surname Alone has a VIF of 2.2. We're going to treat it as our baseline and exclude it from our fit. This is done to prevent multicollinearity, or the dummy variable trap caused by including a dummy variable for every single category. lets try remove the dummy alone, that is pretty similar, and check if it solves the other dummies from its category:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[58]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Step 1: Remove one feature with VIF on Inf from the same category and run a multiple regression</span>
<span class="n">cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;alone&#39;</span><span class="p">)</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
<span class="n">scale</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">(</span><span class="n">with_std</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scale</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span> <span class="n">cols</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">y_train</span><span class="p">,</span> <span class="n">df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># get y and X dataframes based on this regression:</span>
<span class="n">y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">dmatrices</span><span class="p">(</span><span class="s1">&#39;Survived ~&#39;</span> <span class="o">+</span> <span class="n">features</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;dataframe&#39;</span><span class="p">)</span>

<span class="c1">#Step 2: Calculate VIF Factors</span>
<span class="c1"># For each X, calculate VIF and save in dataframe</span>
<span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;VIF Factor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>

<span class="c1">#Step 3: Inspect VIF Factors</span>
<span class="n">display</span><span class="p">(</span><span class="n">vif</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;VIF Factor&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VIF Factor</th>
      <th>features</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.000000</td>
      <td>Intercept</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1.027080</td>
      <td>surname_Beane</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.039424</td>
      <td>surname_Mellinger</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1.048763</td>
      <td>surname_Doling</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.056317</td>
      <td>surname_Hamalainen</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.061651</td>
      <td>surname_Taylor</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.063774</td>
      <td>surname_Chambers</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.071730</td>
      <td>surname_Goldenberg</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.072810</td>
      <td>surname_Moor</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.081285</td>
      <td>surname_Beckwith</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1.082148</td>
      <td>surname_Dick</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1.083090</td>
      <td>surname_Hippach</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1.091573</td>
      <td>surname_Bishop</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.091714</td>
      <td>surname_Richards</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.097315</td>
      <td>surname_Harper</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.101053</td>
      <td>surname_Yarred</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.107265</td>
      <td>surname_Carter</td>
    </tr>
    <tr>
      <th>47</th>
      <td>1.121313</td>
      <td>Personal_Titles_Technical</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.133671</td>
      <td>surname_Baclini</td>
    </tr>
    <tr>
      <th>34</th>
      <td>1.382636</td>
      <td>Without_Age</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1.594563</td>
      <td>Cabin_Number</td>
    </tr>
    <tr>
      <th>46</th>
      <td>1.768952</td>
      <td>Personal_Titles_Royalty</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1.865907</td>
      <td>surname_Gordon</td>
    </tr>
    <tr>
      <th>44</th>
      <td>2.156407</td>
      <td>Personal_Titles_Kid</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2.185638</td>
      <td>companions</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.201757</td>
      <td>surname_Alone</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2.954703</td>
      <td>distinction_in_name</td>
    </tr>
    <tr>
      <th>32</th>
      <td>3.021953</td>
      <td>relatives</td>
    </tr>
    <tr>
      <th>27</th>
      <td>3.750101</td>
      <td>passenger_fare</td>
    </tr>
    <tr>
      <th>22</th>
      <td>4.436090</td>
      <td>Pclass</td>
    </tr>
    <tr>
      <th>31</th>
      <td>4.540579</td>
      <td>parents</td>
    </tr>
    <tr>
      <th>23</th>
      <td>4.742809</td>
      <td>Age</td>
    </tr>
    <tr>
      <th>45</th>
      <td>5.008117</td>
      <td>Personal_Titles_Miss</td>
    </tr>
    <tr>
      <th>30</th>
      <td>6.128749</td>
      <td>sons</td>
    </tr>
    <tr>
      <th>36</th>
      <td>6.403387</td>
      <td>genre</td>
    </tr>
    <tr>
      <th>35</th>
      <td>7.591511</td>
      <td>Age_bin_custom_label</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.644149</td>
      <td>non_relatives</td>
    </tr>
    <tr>
      <th>26</th>
      <td>20.666651</td>
      <td>qtd_same_ticket_bin</td>
    </tr>
    <tr>
      <th>49</th>
      <td>39.868704</td>
      <td>Embarked_Q</td>
    </tr>
    <tr>
      <th>48</th>
      <td>74.967792</td>
      <td>Embarked_C</td>
    </tr>
    <tr>
      <th>50</th>
      <td>97.344161</td>
      <td>Embarked_S</td>
    </tr>
    <tr>
      <th>52</th>
      <td>inf</td>
      <td>distinction_in_tikect_Low</td>
    </tr>
    <tr>
      <th>51</th>
      <td>inf</td>
      <td>distinction_in_tikect_High</td>
    </tr>
    <tr>
      <th>1</th>
      <td>inf</td>
      <td>family</td>
    </tr>
    <tr>
      <th>41</th>
      <td>inf</td>
      <td>Cabin_Letter_E</td>
    </tr>
    <tr>
      <th>42</th>
      <td>inf</td>
      <td>Cabin_Letter_F</td>
    </tr>
    <tr>
      <th>53</th>
      <td>inf</td>
      <td>distinction_in_tikect_Others</td>
    </tr>
    <tr>
      <th>40</th>
      <td>inf</td>
      <td>Cabin_Letter_D</td>
    </tr>
    <tr>
      <th>39</th>
      <td>inf</td>
      <td>Cabin_Letter_C</td>
    </tr>
    <tr>
      <th>38</th>
      <td>inf</td>
      <td>Cabin_Letter_B</td>
    </tr>
    <tr>
      <th>37</th>
      <td>inf</td>
      <td>Cabin_Letter_A</td>
    </tr>
    <tr>
      <th>24</th>
      <td>inf</td>
      <td>SibSp</td>
    </tr>
    <tr>
      <th>25</th>
      <td>inf</td>
      <td>Parch</td>
    </tr>
    <tr>
      <th>43</th>
      <td>inf</td>
      <td>Cabin_Letter_G</td>
    </tr>
    <tr>
      <th>54</th>
      <td>inf</td>
      <td>distinction_in_tikect_PC</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To solve Cabin Letter, we can try remove only the lowest frequency 'A', and see if we can accept the VIFs of others Cabins:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[59]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Step 1: Remove one feature with VIF on Inf from the same category and run a multiple regression</span>
<span class="n">cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;Cabin_Letter_A&#39;</span><span class="p">)</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
<span class="n">scale</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">(</span><span class="n">with_std</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scale</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span> <span class="n">cols</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">y_train</span><span class="p">,</span> <span class="n">df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># get y and X dataframes based on this regression:</span>
<span class="n">y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">dmatrices</span><span class="p">(</span><span class="s1">&#39;Survived ~&#39;</span> <span class="o">+</span> <span class="n">features</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;dataframe&#39;</span><span class="p">)</span>

<span class="c1">#Step 2: Calculate VIF Factors</span>
<span class="c1"># For each X, calculate VIF and save in dataframe</span>
<span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;VIF Factor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>

<span class="c1">#Step 3: Inspect VIF Factors</span>
<span class="n">display</span><span class="p">(</span><span class="n">vif</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;VIF Factor&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VIF Factor</th>
      <th>features</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.000000</td>
      <td>Intercept</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1.027080</td>
      <td>surname_Beane</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.039424</td>
      <td>surname_Mellinger</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1.048763</td>
      <td>surname_Doling</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.056317</td>
      <td>surname_Hamalainen</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.061651</td>
      <td>surname_Taylor</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.063774</td>
      <td>surname_Chambers</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.071730</td>
      <td>surname_Goldenberg</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.072810</td>
      <td>surname_Moor</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.081285</td>
      <td>surname_Beckwith</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1.082148</td>
      <td>surname_Dick</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1.083090</td>
      <td>surname_Hippach</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1.091573</td>
      <td>surname_Bishop</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.091714</td>
      <td>surname_Richards</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.097315</td>
      <td>surname_Harper</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.101053</td>
      <td>surname_Yarred</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.107265</td>
      <td>surname_Carter</td>
    </tr>
    <tr>
      <th>46</th>
      <td>1.121313</td>
      <td>Personal_Titles_Technical</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.133671</td>
      <td>surname_Baclini</td>
    </tr>
    <tr>
      <th>34</th>
      <td>1.382636</td>
      <td>Without_Age</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1.594563</td>
      <td>Cabin_Number</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1.768952</td>
      <td>Personal_Titles_Royalty</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1.865907</td>
      <td>surname_Gordon</td>
    </tr>
    <tr>
      <th>43</th>
      <td>2.156407</td>
      <td>Personal_Titles_Kid</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2.185638</td>
      <td>companions</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.201757</td>
      <td>surname_Alone</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2.954703</td>
      <td>distinction_in_name</td>
    </tr>
    <tr>
      <th>32</th>
      <td>3.021953</td>
      <td>relatives</td>
    </tr>
    <tr>
      <th>27</th>
      <td>3.750101</td>
      <td>passenger_fare</td>
    </tr>
    <tr>
      <th>22</th>
      <td>4.436090</td>
      <td>Pclass</td>
    </tr>
    <tr>
      <th>39</th>
      <td>4.520122</td>
      <td>Cabin_Letter_D</td>
    </tr>
    <tr>
      <th>31</th>
      <td>4.540579</td>
      <td>parents</td>
    </tr>
    <tr>
      <th>23</th>
      <td>4.742809</td>
      <td>Age</td>
    </tr>
    <tr>
      <th>37</th>
      <td>4.871771</td>
      <td>Cabin_Letter_B</td>
    </tr>
    <tr>
      <th>44</th>
      <td>5.008117</td>
      <td>Personal_Titles_Miss</td>
    </tr>
    <tr>
      <th>38</th>
      <td>5.836347</td>
      <td>Cabin_Letter_C</td>
    </tr>
    <tr>
      <th>30</th>
      <td>6.128749</td>
      <td>sons</td>
    </tr>
    <tr>
      <th>36</th>
      <td>6.403387</td>
      <td>genre</td>
    </tr>
    <tr>
      <th>35</th>
      <td>7.591511</td>
      <td>Age_bin_custom_label</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.644149</td>
      <td>non_relatives</td>
    </tr>
    <tr>
      <th>42</th>
      <td>9.446441</td>
      <td>Cabin_Letter_G</td>
    </tr>
    <tr>
      <th>41</th>
      <td>16.107676</td>
      <td>Cabin_Letter_F</td>
    </tr>
    <tr>
      <th>40</th>
      <td>17.938593</td>
      <td>Cabin_Letter_E</td>
    </tr>
    <tr>
      <th>26</th>
      <td>20.666651</td>
      <td>qtd_same_ticket_bin</td>
    </tr>
    <tr>
      <th>48</th>
      <td>39.868704</td>
      <td>Embarked_Q</td>
    </tr>
    <tr>
      <th>47</th>
      <td>74.967792</td>
      <td>Embarked_C</td>
    </tr>
    <tr>
      <th>49</th>
      <td>97.344161</td>
      <td>Embarked_S</td>
    </tr>
    <tr>
      <th>25</th>
      <td>inf</td>
      <td>Parch</td>
    </tr>
    <tr>
      <th>24</th>
      <td>inf</td>
      <td>SibSp</td>
    </tr>
    <tr>
      <th>1</th>
      <td>inf</td>
      <td>family</td>
    </tr>
    <tr>
      <th>50</th>
      <td>inf</td>
      <td>distinction_in_tikect_High</td>
    </tr>
    <tr>
      <th>51</th>
      <td>inf</td>
      <td>distinction_in_tikect_Low</td>
    </tr>
    <tr>
      <th>52</th>
      <td>inf</td>
      <td>distinction_in_tikect_Others</td>
    </tr>
    <tr>
      <th>53</th>
      <td>inf</td>
      <td>distinction_in_tikect_PC</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now our focus is on distinct in name, since "High" has less observations, let's try dropped it and drop the bins of Parch and SibSp.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[60]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;distinction_in_tikect_High&#39;</span><span class="p">)</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
<span class="n">scale</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">(</span><span class="n">with_std</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scale</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span> <span class="n">cols</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">y_train</span><span class="p">,</span> <span class="n">df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># get y and X dataframes based on this regression:</span>
<span class="n">y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">dmatrices</span><span class="p">(</span><span class="s1">&#39;Survived ~&#39;</span> <span class="o">+</span> <span class="n">features</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;dataframe&#39;</span><span class="p">)</span>

<span class="c1">#Step 2: Calculate VIF Factors</span>
<span class="c1"># For each X, calculate VIF and save in dataframe</span>
<span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;VIF Factor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>

<span class="c1">#Step 3: Inspect VIF Factors</span>
<span class="n">display</span><span class="p">(</span><span class="n">vif</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;VIF Factor&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VIF Factor</th>
      <th>features</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.000000</td>
      <td>Intercept</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1.027080</td>
      <td>surname_Beane</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.039424</td>
      <td>surname_Mellinger</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1.048763</td>
      <td>surname_Doling</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.056317</td>
      <td>surname_Hamalainen</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.061651</td>
      <td>surname_Taylor</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.063774</td>
      <td>surname_Chambers</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.071730</td>
      <td>surname_Goldenberg</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.072810</td>
      <td>surname_Moor</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.081285</td>
      <td>surname_Beckwith</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1.082148</td>
      <td>surname_Dick</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1.083090</td>
      <td>surname_Hippach</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1.091573</td>
      <td>surname_Bishop</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.091714</td>
      <td>surname_Richards</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.097315</td>
      <td>surname_Harper</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.101053</td>
      <td>surname_Yarred</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.107265</td>
      <td>surname_Carter</td>
    </tr>
    <tr>
      <th>46</th>
      <td>1.121313</td>
      <td>Personal_Titles_Technical</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.133671</td>
      <td>surname_Baclini</td>
    </tr>
    <tr>
      <th>34</th>
      <td>1.382636</td>
      <td>Without_Age</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1.594563</td>
      <td>Cabin_Number</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1.768952</td>
      <td>Personal_Titles_Royalty</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1.865907</td>
      <td>surname_Gordon</td>
    </tr>
    <tr>
      <th>43</th>
      <td>2.156407</td>
      <td>Personal_Titles_Kid</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2.185638</td>
      <td>companions</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.201757</td>
      <td>surname_Alone</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2.954703</td>
      <td>distinction_in_name</td>
    </tr>
    <tr>
      <th>32</th>
      <td>3.021953</td>
      <td>relatives</td>
    </tr>
    <tr>
      <th>50</th>
      <td>3.271151</td>
      <td>distinction_in_tikect_Low</td>
    </tr>
    <tr>
      <th>27</th>
      <td>3.750101</td>
      <td>passenger_fare</td>
    </tr>
    <tr>
      <th>52</th>
      <td>4.229762</td>
      <td>distinction_in_tikect_PC</td>
    </tr>
    <tr>
      <th>22</th>
      <td>4.436090</td>
      <td>Pclass</td>
    </tr>
    <tr>
      <th>39</th>
      <td>4.520122</td>
      <td>Cabin_Letter_D</td>
    </tr>
    <tr>
      <th>31</th>
      <td>4.540579</td>
      <td>parents</td>
    </tr>
    <tr>
      <th>23</th>
      <td>4.742809</td>
      <td>Age</td>
    </tr>
    <tr>
      <th>37</th>
      <td>4.871771</td>
      <td>Cabin_Letter_B</td>
    </tr>
    <tr>
      <th>44</th>
      <td>5.008117</td>
      <td>Personal_Titles_Miss</td>
    </tr>
    <tr>
      <th>51</th>
      <td>5.273404</td>
      <td>distinction_in_tikect_Others</td>
    </tr>
    <tr>
      <th>38</th>
      <td>5.836347</td>
      <td>Cabin_Letter_C</td>
    </tr>
    <tr>
      <th>30</th>
      <td>6.128749</td>
      <td>sons</td>
    </tr>
    <tr>
      <th>36</th>
      <td>6.403387</td>
      <td>genre</td>
    </tr>
    <tr>
      <th>35</th>
      <td>7.591511</td>
      <td>Age_bin_custom_label</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.644149</td>
      <td>non_relatives</td>
    </tr>
    <tr>
      <th>42</th>
      <td>9.446441</td>
      <td>Cabin_Letter_G</td>
    </tr>
    <tr>
      <th>41</th>
      <td>16.107676</td>
      <td>Cabin_Letter_F</td>
    </tr>
    <tr>
      <th>40</th>
      <td>17.938593</td>
      <td>Cabin_Letter_E</td>
    </tr>
    <tr>
      <th>26</th>
      <td>20.666651</td>
      <td>qtd_same_ticket_bin</td>
    </tr>
    <tr>
      <th>48</th>
      <td>39.868704</td>
      <td>Embarked_Q</td>
    </tr>
    <tr>
      <th>47</th>
      <td>74.967792</td>
      <td>Embarked_C</td>
    </tr>
    <tr>
      <th>49</th>
      <td>97.344161</td>
      <td>Embarked_S</td>
    </tr>
    <tr>
      <th>24</th>
      <td>inf</td>
      <td>SibSp</td>
    </tr>
    <tr>
      <th>25</th>
      <td>inf</td>
      <td>Parch</td>
    </tr>
    <tr>
      <th>1</th>
      <td>inf</td>
      <td>family</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, we now have to remove one between family, parch and SibSp. Note that non_relatives qtd_same_ticket_bin are already with relatively acceptable VIFs. The first is directly calculated from the family and the second is very close as we have seen. So let's discard the family.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[61]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;family&#39;</span><span class="p">)</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
<span class="n">scale</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">(</span><span class="n">with_std</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scale</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span> <span class="n">cols</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">y_train</span><span class="p">,</span> <span class="n">df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># get y and X dataframes based on this regression:</span>
<span class="n">y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">dmatrices</span><span class="p">(</span><span class="s1">&#39;Survived ~&#39;</span> <span class="o">+</span> <span class="n">features</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;dataframe&#39;</span><span class="p">)</span>

<span class="c1">#Step 2: Calculate VIF Factors</span>
<span class="c1"># For each X, calculate VIF and save in dataframe</span>
<span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;VIF Factor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">vif</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>

<span class="c1">#Step 3: Inspect VIF Factors</span>
<span class="n">display</span><span class="p">(</span><span class="n">vif</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;VIF Factor&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VIF Factor</th>
      <th>features</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.000000</td>
      <td>Intercept</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1.027080</td>
      <td>surname_Beane</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1.039424</td>
      <td>surname_Mellinger</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.048763</td>
      <td>surname_Doling</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.056317</td>
      <td>surname_Hamalainen</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1.061651</td>
      <td>surname_Taylor</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.063774</td>
      <td>surname_Chambers</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.071730</td>
      <td>surname_Goldenberg</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.072810</td>
      <td>surname_Moor</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.081285</td>
      <td>surname_Beckwith</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.082148</td>
      <td>surname_Dick</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1.083090</td>
      <td>surname_Hippach</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1.091573</td>
      <td>surname_Bishop</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.091714</td>
      <td>surname_Richards</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.097315</td>
      <td>surname_Harper</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.101053</td>
      <td>surname_Yarred</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.107265</td>
      <td>surname_Carter</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1.121313</td>
      <td>Personal_Titles_Technical</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.133671</td>
      <td>surname_Baclini</td>
    </tr>
    <tr>
      <th>33</th>
      <td>1.382636</td>
      <td>Without_Age</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1.594563</td>
      <td>Cabin_Number</td>
    </tr>
    <tr>
      <th>44</th>
      <td>1.768952</td>
      <td>Personal_Titles_Royalty</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1.865907</td>
      <td>surname_Gordon</td>
    </tr>
    <tr>
      <th>42</th>
      <td>2.156407</td>
      <td>Personal_Titles_Kid</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2.185638</td>
      <td>companions</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.201757</td>
      <td>surname_Alone</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2.954703</td>
      <td>distinction_in_name</td>
    </tr>
    <tr>
      <th>31</th>
      <td>3.021953</td>
      <td>relatives</td>
    </tr>
    <tr>
      <th>49</th>
      <td>3.271151</td>
      <td>distinction_in_tikect_Low</td>
    </tr>
    <tr>
      <th>26</th>
      <td>3.750101</td>
      <td>passenger_fare</td>
    </tr>
    <tr>
      <th>51</th>
      <td>4.229762</td>
      <td>distinction_in_tikect_PC</td>
    </tr>
    <tr>
      <th>21</th>
      <td>4.436090</td>
      <td>Pclass</td>
    </tr>
    <tr>
      <th>38</th>
      <td>4.520122</td>
      <td>Cabin_Letter_D</td>
    </tr>
    <tr>
      <th>30</th>
      <td>4.540579</td>
      <td>parents</td>
    </tr>
    <tr>
      <th>22</th>
      <td>4.742809</td>
      <td>Age</td>
    </tr>
    <tr>
      <th>36</th>
      <td>4.871771</td>
      <td>Cabin_Letter_B</td>
    </tr>
    <tr>
      <th>23</th>
      <td>4.913654</td>
      <td>SibSp</td>
    </tr>
    <tr>
      <th>43</th>
      <td>5.008117</td>
      <td>Personal_Titles_Miss</td>
    </tr>
    <tr>
      <th>50</th>
      <td>5.273404</td>
      <td>distinction_in_tikect_Others</td>
    </tr>
    <tr>
      <th>37</th>
      <td>5.836347</td>
      <td>Cabin_Letter_C</td>
    </tr>
    <tr>
      <th>29</th>
      <td>6.128749</td>
      <td>sons</td>
    </tr>
    <tr>
      <th>35</th>
      <td>6.403387</td>
      <td>genre</td>
    </tr>
    <tr>
      <th>24</th>
      <td>6.585030</td>
      <td>Parch</td>
    </tr>
    <tr>
      <th>34</th>
      <td>7.591511</td>
      <td>Age_bin_custom_label</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.644149</td>
      <td>non_relatives</td>
    </tr>
    <tr>
      <th>41</th>
      <td>9.446441</td>
      <td>Cabin_Letter_G</td>
    </tr>
    <tr>
      <th>40</th>
      <td>16.107676</td>
      <td>Cabin_Letter_F</td>
    </tr>
    <tr>
      <th>39</th>
      <td>17.938593</td>
      <td>Cabin_Letter_E</td>
    </tr>
    <tr>
      <th>25</th>
      <td>20.666651</td>
      <td>qtd_same_ticket_bin</td>
    </tr>
    <tr>
      <th>47</th>
      <td>39.868704</td>
      <td>Embarked_Q</td>
    </tr>
    <tr>
      <th>46</th>
      <td>74.967792</td>
      <td>Embarked_C</td>
    </tr>
    <tr>
      <th>48</th>
      <td>97.344161</td>
      <td>Embarked_S</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Yea, we can accept, and we can proceed to the next step.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Feature-Selection-by-Filter-Methods">Feature Selection by Filter Methods<a class="anchor-link" href="#Feature-Selection-by-Filter-Methods">&#182;</a></h3><p>Filter methods use statistical methods for evaluation of a subset of features, they are generally used as a preprocessing step. These methods are also known as <strong>univariate feature selection</strong>, they examines each feature individually to determine the strength of the relationship of the feature with the dependet variable. These methods are <strong>simple to run and understand</strong> and are in general particularly <strong>good for gaining a better understanding</strong> of data, but <strong>not necessarily for optimizing the feature set for better generalization</strong>.</p>
<p>So, the features are selected on the basis of their scores in various statistical tests for their correlation with the outcome variable. The correlation is a subjective term here. For basic guidance, you can refer to the following table for defining correlation co-efficients.</p>
<table>
<thead><tr>
<th>Feature/Response</th>
<th>Continuous</th>
<th>Categorical</th>
</tr>
</thead>
<tbody>
<tr>
<td>Continuous</td>
<td>Pearson's Correlation</td>
<td>LDA</td>
</tr>
<tr>
<td>Categorical</td>
<td>Anova</td>
<td>Chi-Square</td>
</tr>
</tbody>
</table>
<p>One thing that should be kept in mind is that filter methods do not remove multicollinearity. So, you must deal with multicollinearity of features as well before training models for your data.</p>
<p>There are lot of different options for univariate selection. Some exaples are:</p>
<ul>
<li>Model Based Ranking</li>
<li>Mutual information and maximal information coefficient (MIC).</li>
</ul>
<p>I did not approach the latter, becouse there has been some critique about MICs statistical power, i.e. the ability to reject the null hypothesis when the null hypothesis is false. This may or may not be a concern, depending on the particular dataset and its noisiness. If you have intterest on this, in python, MIC is available in the <a href="http://minepy.sourceforge.net/docs/1.0.0/cpp.html?highlight=mic#MINE::MINE::mic">minepy</a> library.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Feature-Selection-by-Model-based-ranking">Feature Selection by Model based ranking<a class="anchor-link" href="#Feature-Selection-by-Model-based-ranking">&#182;</a></h4><p>We can use an arbitrary machine learning method to build a predictive model for the response variable using each individual feature, and measure the performance of each model.</p>
<p>In fact, this is already put to use with Pearsons correlation coefficient, since it is equivalent to standardized regression coefficient that is used for prediction in linear regression. But this method it is not good to select features with non-linear relation to dependent variable. For this, there are a number of alternatives, for example tree based methods (decision trees, random forest), linear model with basis expansion etc. Tree based methods are probably among the easiest to apply, since they can model non-linear relations well and dont require much tuning. The main thing to avoid is overfitting, so the depth of tree(s) should be relatively small, and cross-validation should be applied.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[62]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
     <span class="n">score</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
     <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">score</span><span class="p">),</span> <span class="mi">3</span><span class="p">),</span> <span class="n">cols</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="n">MBR</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Score&#39;</span><span class="p">,</span> <span class="s1">&#39;Feature&#39;</span><span class="p">])</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">MBR</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">15</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Feature&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">MBR</span> <span class="o">=</span> <span class="n">MBR</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_123_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Feature-Selection-by-SelectKBest:">Feature Selection by <a href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectKBest.html">SelectKBest</a>:<a class="anchor-link" href="#Feature-Selection-by-SelectKBest:">&#182;</a></h4><p>On scikit-learn we find variety of implementation oriented to classifications taks to select features according to the k highest scores, see below some of that:</p>
<ul>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.f_classif.html#sklearn.feature_selection.f_classif">f_classif</a> compute the ANOVA F-value for the provided sample.</li>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.chi2.html#sklearn.feature_selection.chi2">chi2</a> compute chi-squared stats between each non-negative feature and class. </li>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.mutual_info_classif.html#sklearn.feature_selection.mutual_info_classif">mutual_info_classif</a> estimate mutual information for a discrete target variable.</li>
</ul>
<p>The methods based on F-test estimate the degree of linear dependency between two random variables. On the other hand, mutual information methods can capture any kind of statistical dependency, but being nonparametric, they require more samples for accurate estimation.</p>
<p>Other important point is if you use sparse data, for example if we continue concider hot-encode of surnames, chi2  and mutual_info_classif will deal with the data without making it dense.</p>
<p>Lets see the SelectKBest of f_classif and chi2 for our data:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>

<span class="n">skb</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span><span class="o">=</span><span class="n">f_classif</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">skb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">select_features_kbest</span> <span class="o">=</span> <span class="n">skb</span><span class="o">.</span><span class="n">get_support</span><span class="p">()</span>
<span class="n">feature_f_clas</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">select_features_kbest</span><span class="p">]</span>
<span class="n">feature_f_clas_scores</span> <span class="o">=</span> <span class="p">[(</span><span class="n">item</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">skb</span><span class="o">.</span><span class="n">scores_</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total features slected by f_classif Statistical Methods&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_f_clas</span><span class="p">))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">feature_f_clas_scores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])[:</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_f_clas</span><span class="p">)],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Feature&#39;</span><span class="p">,</span><span class="s1">&#39;F-Calss Score&#39;</span><span class="p">])</span><span class="o">.</span>\
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Feature&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span> <span class="s1">&#39;F Class Score&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">f1</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">scale</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="p">])</span>
<span class="n">skb</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span><span class="o">=</span><span class="n">chi2</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">skb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">select_features_kbest</span> <span class="o">=</span> <span class="n">skb</span><span class="o">.</span><span class="n">get_support</span><span class="p">()</span>
<span class="n">feature_chi2</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">select_features_kbest</span><span class="p">]</span>
<span class="n">feature_chi2_scores</span> <span class="o">=</span> <span class="p">[(</span><span class="n">item</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">skb</span><span class="o">.</span><span class="n">scores_</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total features slected by chi2 Statistical Methods&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_chi2</span><span class="p">))</span>
<span class="n">f2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">feature_chi2_scores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])[:</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_chi2</span><span class="p">)],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Feature&#39;</span><span class="p">,</span><span class="s1">&#39;Chi2 Score&#39;</span><span class="p">])</span><span class="o">.</span>\
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Feature&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span>  <span class="n">title</span><span class="o">=</span> <span class="s1">&#39;Chi2 Score&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">f2</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">SMcols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">feature_f_clas</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">feature_chi2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extra features select by f_class:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">feature_f_clas</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">feature_chi2</span><span class="p">)),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extra features select by chi2:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">feature_chi2</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">feature_f_clas</span><span class="p">)),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Intersection features select by f_class and chi2:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nb">set</span><span class="p">(</span><span class="n">feature_f_clas</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">feature_chi2</span><span class="p">)),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total number of features selected:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">SMcols</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">SMcols</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Total features slected by f_classif Statistical Methods 10
Total features slected by chi2 Statistical Methods 10
Extra features select by f_class:
 {&#39;passenger_fare&#39;, &#39;Embarked_S&#39;} 

Extra features select by chi2:
 {&#39;distinction_in_tikect_PC&#39;, &#39;Cabin_Letter_C&#39;} 

Intersection features select by f_class and chi2:
 {&#39;Embarked_C&#39;, &#39;Cabin_Letter_E&#39;, &#39;Cabin_Letter_B&#39;, &#39;genre&#39;, &#39;distinction_in_tikect_Low&#39;, &#39;Pclass&#39;, &#39;distinction_in_name&#39;, &#39;Personal_Titles_Miss&#39;} 

Total number of features selected: 12
{&#39;passenger_fare&#39;, &#39;Embarked_C&#39;, &#39;Cabin_Letter_E&#39;, &#39;Cabin_Letter_B&#39;, &#39;genre&#39;, &#39;distinction_in_tikect_Low&#39;, &#39;Pclass&#39;, &#39;distinction_in_name&#39;, &#39;Embarked_S&#39;, &#39;distinction_in_tikect_PC&#39;, &#39;Cabin_Letter_C&#39;, &#39;Personal_Titles_Miss&#39;}
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_125_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Wrapper-Methods">Wrapper Methods<a class="anchor-link" href="#Wrapper-Methods">&#182;</a></h3><p>In wrapper methods, we try to use a subset of features and train a model using them. Based on the inferences that we draw from the previous model, we decide to add or remove features from your subset. The problem is essentially reduced to a search problem.</p>
<p>The two main disadvantages of these methods are :</p>
<ul>
<li>The increasing overfitting risk when the number of observations is insufficient.</li>
<li>These methods are usually computationally very expensive.</li>
</ul>
<h4 id="Backward-Elimination">Backward Elimination<a class="anchor-link" href="#Backward-Elimination">&#182;</a></h4><p>In backward elimination, we start with all the features and removes the least significant feature at each iteration which improves the performance of the model. We repeat this until no improvement is observed on removal of features.</p>
<p>We will see below row implementation of backward elimination, one to select by P-values and other based on the accuracy of a model the we submitted to it.</p>
<h5 id="Backward-Elimination-By-P-values">Backward Elimination By P-values<a class="anchor-link" href="#Backward-Elimination-By-P-values">&#182;</a></h5><p>The <strong>P-value</strong>, or probability value, or asymptotic significance, is a <strong>probability</strong> value for a given <strong>statistical model</strong> that, <strong><em>if the null hypothesis is true</em></strong>, a set of statistical observations more commonly known as <strong>the statistical summary</strong> <i>is greater than or equal in magnitude to</i> <strong>the observed results</strong>.</p>
<p>The <strong>null hypothesis</strong> is a general statement that <strong>there is no relationship between two measured phenomena</strong>.</p>
<p>For example, if the correlation is very small and furthermore, the p-value is high meaning that it is very likely to observe such correlation on a dataset of this size purely by chance.</p>
<p>But you need to be careful how you interpret the statistical significance of a correlation. If your correlation coefficient has been determined to be statistically significant this does not mean that you have a strong association. It simply tests the null hypothesis that there is no relationship. By rejecting the null hypothesis, you accept the alternative hypothesis that states that there is a relationship, but with no information about the strength of the relationship or its importance.</p>
<p>Since removal of different features from the dataset will have different effects on the p-value for the dataset, we can remove different features and measure the p-value in each case. These measured p-values can be used to decide whether to keep a feature or not.</p>
<p>Next we make the test of a <strong><em>logit regression</em></strong> to check the result and <strong>select features</strong> based on its the <strong>P-value</strong>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[64]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logit_model</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">Logit</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="n">df</span><span class="p">)</span>
<span class="n">result</span><span class="o">=</span><span class="n">logit_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfgs&#39;</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization terminated successfully.
         Current function value: 0.363678
         Iterations: 285
         Function evaluations: 289
         Gradient evaluations: 289
                           Logit Regression Results                           
==============================================================================
Dep. Variable:               Survived   No. Observations:                  891
Model:                          Logit   Df Residuals:                      840
Method:                           MLE   Df Model:                           50
Date:                Sat, 22 Sep 2018   Pseudo R-squ.:                  0.4539
Time:                        18:38:46   Log-Likelihood:                -324.04
converged:                       True   LL-Null:                       -593.33
                                        LLR p-value:                 4.183e-83
================================================================================================
                                   coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------------------------
non_relatives                    0.6521      0.248      2.626      0.009       0.165       1.139
surname_Alone                    0.2531      0.317      0.797      0.425      -0.369       0.875
surname_Baclini                 35.0286    5.2e+05   6.74e-05      1.000   -1.02e+06    1.02e+06
surname_Carter                   0.3247      1.478      0.220      0.826      -2.572       3.221
surname_Richards                24.5135    1.8e+05      0.000      1.000   -3.53e+05    3.53e+05
surname_Harper                   1.6077      1.493      1.077      0.282      -1.319       4.534
surname_Beckwith                25.2653   1.48e+05      0.000      1.000    -2.9e+05     2.9e+05
surname_Goldenberg              18.1282   6212.320      0.003      0.998   -1.22e+04    1.22e+04
surname_Moor                    12.1274    708.078      0.017      0.986   -1375.680    1399.934
surname_Chambers                20.4606    1.8e+04      0.001      0.999   -3.53e+04    3.53e+04
surname_Hamalainen              12.1778    769.487      0.016      0.987   -1495.989    1520.345
surname_Dick                    23.5492   5.64e+04      0.000      1.000    -1.1e+05    1.11e+05
surname_Taylor                  26.5937   2.03e+05      0.000      1.000   -3.97e+05    3.97e+05
surname_Doling                  11.1800    568.824      0.020      0.984   -1103.695    1126.054
surname_Gordon                  21.6263   1.37e+04      0.002      0.999   -2.67e+04    2.68e+04
surname_Beane                   29.3099   9.09e+05   3.23e-05      1.000   -1.78e+06    1.78e+06
surname_Hippach                  9.4228    329.299      0.029      0.977    -635.992     654.838
surname_Bishop                  13.9600    991.219      0.014      0.989   -1928.793    1956.713
surname_Mellinger               12.1126    747.967      0.016      0.987   -1453.876    1478.101
surname_Yarred                  17.7443   6003.748      0.003      0.998   -1.17e+04    1.18e+04
Pclass                          -1.0271      0.258     -3.982      0.000      -1.533      -0.522
Age                             -0.0297      0.016     -1.848      0.065      -0.061       0.002
SibSp                           -0.1467      0.216     -0.679      0.497      -0.570       0.277
Parch                            0.1022      0.302      0.338      0.736      -0.491       0.695
qtd_same_ticket_bin             -0.6804      0.361     -1.885      0.059      -1.388       0.027
passenger_fare                   0.0444      0.019      2.320      0.020       0.007       0.082
distinction_in_name              1.2501      0.419      2.987      0.003       0.430       2.070
Cabin_Number                     0.0699      0.037      1.876      0.061      -0.003       0.143
sons                             0.6661      0.697      0.956      0.339      -0.700       2.032
parents                          0.3338      0.712      0.469      0.639      -1.061       1.729
relatives                        0.2784      0.485      0.574      0.566      -0.672       1.229
companions                      -0.2517      0.508     -0.496      0.620      -1.247       0.744
Without_Age                     -0.2149      0.292     -0.737      0.461      -0.787       0.357
Age_bin_custom_label             0.0610      0.209      0.291      0.771      -0.349       0.471
genre                           -3.0048      0.526     -5.715      0.000      -4.035      -1.974
Cabin_Letter_B                  -0.2343      0.786     -0.298      0.766      -1.774       1.306
Cabin_Letter_C                  -0.3873      0.727     -0.533      0.594      -1.812       1.037
Cabin_Letter_D                   0.6481      0.738      0.878      0.380      -0.799       2.095
Cabin_Letter_E                   0.6878      0.752      0.914      0.361      -0.787       2.162
Cabin_Letter_F                   1.1108      0.756      1.468      0.142      -0.372       2.593
Cabin_Letter_G                   0.8240      0.896      0.919      0.358      -0.933       2.581
Personal_Titles_Kid              3.7469      0.723      5.179      0.000       2.329       5.165
Personal_Titles_Miss             0.0229      0.551      0.042      0.967      -1.056       1.102
Personal_Titles_Royalty         -1.6139      2.035     -0.793      0.428      -5.602       2.374
Personal_Titles_Technical        0.0623      0.663      0.094      0.925      -1.236       1.361
Embarked_C                      -3.1700     15.027     -0.211      0.833     -32.623      26.283
Embarked_Q                      -3.3883     15.032     -0.225      0.822     -32.851      26.074
Embarked_S                      -3.6679     15.026     -0.244      0.807     -33.119      25.783
distinction_in_tikect_Low       -1.9666      0.786     -2.501      0.012      -3.508      -0.426
distinction_in_tikect_Others    -1.1537      0.546     -2.114      0.035      -2.223      -0.084
distinction_in_tikect_PC        -1.8562      0.726     -2.558      0.011      -3.278      -0.434
================================================================================================
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As expect, <strong>P-values</strong> of dummies is high. Like before, I excluded one by one of the features with the highest P-value and run again until get only <strong>P-values below to 0.1</strong>, but here I use a backward elimination process.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pv_cols</span> <span class="o">=</span> <span class="n">cols</span><span class="o">.</span><span class="n">values</span>

<span class="k">def</span> <span class="nf">backwardElimination</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">sl</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
    <span class="n">numVars</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">numVars</span><span class="p">):</span>
        <span class="n">regressor</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Logit</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfgs&#39;</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">maxVar</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">regressor</span><span class="o">.</span><span class="n">pvalues</span><span class="p">)</span> <span class="c1">#.astype(float)</span>
        <span class="k">if</span> <span class="n">maxVar</span> <span class="o">&gt;</span> <span class="n">sl</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">numVars</span> <span class="o">-</span> <span class="n">i</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">regressor</span><span class="o">.</span><span class="n">pvalues</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="o">==</span> <span class="n">maxVar</span><span class="p">):</span>
                    <span class="n">columns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columns</span><span class="p">]</span>
                    
    <span class="nb">print</span><span class="p">(</span><span class="n">regressor</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Select </span><span class="si">{:d}</span><span class="s1"> features from </span><span class="si">{:d}</span><span class="s1"> by best p-values.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The max p-value from the features selecte is </span><span class="si">{:.3f}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">maxVar</span><span class="p">))</span>
    
    <span class="c1"># odds ratios and 95% CI</span>
    <span class="n">conf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">regressor</span><span class="o">.</span><span class="n">conf_int</span><span class="p">())</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;Odds Ratios&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">regressor</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2.5%&#39;</span><span class="p">,</span> <span class="s1">&#39;97.5%&#39;</span><span class="p">,</span> <span class="s1">&#39;Odds Ratios&#39;</span><span class="p">]</span>
    <span class="n">display</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">columns</span><span class="p">,</span> <span class="n">regressor</span>

<span class="n">SL</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pv_cols</span><span class="p">])</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">pv_cols</span><span class="p">)</span>

<span class="n">pv_cols</span><span class="p">,</span> <span class="n">Logit</span> <span class="o">=</span> <span class="n">backwardElimination</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">SL</span><span class="p">,</span> <span class="n">pv_cols</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>                           Logit Regression Results                           
==============================================================================
Dep. Variable:               Survived   No. Observations:                  891
Model:                          Logit   Df Residuals:                      876
Method:                           MLE   Df Model:                           14
Date:                Sat, 22 Sep 2018   Pseudo R-squ.:                  0.4146
Time:                        18:38:51   Log-Likelihood:                -347.36
converged:                       True   LL-Null:                       -593.33
                                        LLR p-value:                 4.732e-96
================================================================================================
                                   coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------------------------
non_relatives                    9.8711      1.312      7.525      0.000       7.300      12.442
Pclass                          -2.0428      0.354     -5.777      0.000      -2.736      -1.350
Age                             -2.2167      0.782     -2.834      0.005      -3.750      -0.683
qtd_same_ticket_bin             -3.7108      0.575     -6.451      0.000      -4.838      -2.583
passenger_fare                   3.0945      1.683      1.839      0.066      -0.204       6.393
distinction_in_name              1.1604      0.307      3.783      0.000       0.559       1.762
sons                             1.0338      0.443      2.332      0.020       0.165       1.903
parents                          1.1074      0.457      2.425      0.015       0.212       2.002
relatives                        0.5993      0.305      1.963      0.050       0.001       1.198
genre                           -2.9115      0.252    -11.566      0.000      -3.405      -2.418
Personal_Titles_Kid              3.4269      0.576      5.948      0.000       2.298       4.556
Embarked_S                      -0.3645      0.221     -1.649      0.099      -0.798       0.069
distinction_in_tikect_Low       -2.1724      0.739     -2.941      0.003      -3.620      -0.724
distinction_in_tikect_Others    -1.3182      0.475     -2.777      0.005      -2.249      -0.388
distinction_in_tikect_PC        -2.0141      0.654     -3.078      0.002      -3.297      -0.732
================================================================================================

Select 15 features from 51 by best p-values.
The max p-value from the features selecte is 0.099.
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2.5%</th>
      <th>97.5%</th>
      <th>Odds Ratios</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>non_relatives</th>
      <td>1480.171472</td>
      <td>253274.069118</td>
      <td>19362.051846</td>
    </tr>
    <tr>
      <th>Pclass</th>
      <td>0.064837</td>
      <td>0.259310</td>
      <td>0.129665</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>0.023516</td>
      <td>0.504884</td>
      <td>0.108964</td>
    </tr>
    <tr>
      <th>qtd_same_ticket_bin</th>
      <td>0.007920</td>
      <td>0.075521</td>
      <td>0.024457</td>
    </tr>
    <tr>
      <th>passenger_fare</th>
      <td>0.815520</td>
      <td>597.572483</td>
      <td>22.075600</td>
    </tr>
    <tr>
      <th>distinction_in_name</th>
      <td>1.749180</td>
      <td>5.821927</td>
      <td>3.191175</td>
    </tr>
    <tr>
      <th>sons</th>
      <td>1.179098</td>
      <td>6.704660</td>
      <td>2.811664</td>
    </tr>
    <tr>
      <th>parents</th>
      <td>1.236503</td>
      <td>7.407207</td>
      <td>3.026389</td>
    </tr>
    <tr>
      <th>relatives</th>
      <td>1.000811</td>
      <td>3.312990</td>
      <td>1.820900</td>
    </tr>
    <tr>
      <th>genre</th>
      <td>0.033212</td>
      <td>0.089092</td>
      <td>0.054396</td>
    </tr>
    <tr>
      <th>Personal_Titles_Kid</th>
      <td>9.951006</td>
      <td>95.205077</td>
      <td>30.779641</td>
    </tr>
    <tr>
      <th>Embarked_S</th>
      <td>0.450403</td>
      <td>1.071116</td>
      <td>0.694574</td>
    </tr>
    <tr>
      <th>distinction_in_tikect_Low</th>
      <td>0.026771</td>
      <td>0.484601</td>
      <td>0.113901</td>
    </tr>
    <tr>
      <th>distinction_in_tikect_Others</th>
      <td>0.105529</td>
      <td>0.678613</td>
      <td>0.267607</td>
    </tr>
    <tr>
      <th>distinction_in_tikect_PC</th>
      <td>0.037006</td>
      <td>0.481179</td>
      <td>0.133440</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From the results, we can highlight:</p>
<ul>
<li><p>we're very confident about some relationship between the probability of being survived:</p>
<ul>
<li>there is an inverse  relationship with class, Age and genere of the pessanger.</li>
<li>there is an positive relationship, from greater to low, with non relatives, Kids, passenger fare and distinction in name of the pessanger.</li>
</ul>
</li>
<li><p>From the coefficient:</p>
<ul>
<li>Non relatives, we confirm that felows or companions of families had better chances to survived.</li>
<li>As we saw in the EDA, passengers who embarked on S had a higher fatality rate.  </li>
<li>The model is only able to translate a single straight line by variable, obviously pondered by the others. Then he points out that the greater the number of passagers with the same ticket, the greater the likelihood of death. As seen through the <a href="#Tikect">tikect EDA</a>, this is partly true, however, this coefficient does not adequately capture the fact that the chances of survival increase from 1 to 3 passengers with the same ticket. As you can see above, the model balances this through the variables of family relationships. However, this is a good example of why you should not ignore the EDA phase, and above all do not rely on a conclusion based on a single fact or point of view. Remember, models are not full truths, and possess precision, confident and accuracy!</li>
</ul>
</li>
</ul>
<p>Take the <strong>exponential</strong> of each of the <strong>coefficients</strong> to generate the <strong><em>odds ratios</em></strong>. This tells you how a 1 unit increase or decrease in a variable affects the odds of being survived. For example, we can expect the odds of being survived to decrease by about 69.5% if the pessager embarked on S. Go back to the <a href="#Embarked">embarked EDA</a> and see that this hits the stacked bar chart.</p>
<p>You must be wondering, after all, this model has how much of accuracy?</p>
<p>Although we did not do cross validation or even split, let's take a look, redeem the probabilities generated by it and take advantage to see how we can plot the results of models that return probabilities, so we can refine our perception much more than simply evaluate p-value, coefficients, acuricity, etc.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[66]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">Logit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="n">pv_cols</span><span class="p">])</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;proba&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accurancy: </span><span class="si">{0:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">plot_proba</span><span class="p">(</span><span class="n">continous</span><span class="p">,</span> <span class="n">predict</span><span class="p">,</span> <span class="n">discret</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">grouped</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="n">predict</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">continous</span><span class="p">,</span> <span class="n">discret</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="s1">&#39;rbgyrbgy&#39;</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">discret</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
        <span class="n">plt_data</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">grouped</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="n">col</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plt_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">plt_data</span><span class="p">[</span><span class="n">predict</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">col</span><span class="p">)])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">continous</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Probabilities&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">discret</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">discret</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Probabilities with &quot;</span> <span class="o">+</span> <span class="n">continous</span> <span class="o">+</span> <span class="s2">&quot; and &quot;</span> <span class="o">+</span> <span class="n">discret</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">231</span><span class="p">)</span>
<span class="n">plot_proba</span><span class="p">(</span><span class="s1">&#39;non_relatives&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="s1">&#39;Pclass&#39;</span><span class="p">,</span> <span class="n">train</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">232</span><span class="p">)</span>
<span class="n">plot_proba</span><span class="p">(</span><span class="s1">&#39;non_relatives&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="n">train</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">233</span><span class="p">)</span>
<span class="n">plot_proba</span><span class="p">(</span><span class="s1">&#39;non_relatives&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="s1">&#39;qtd_same_ticket_bin&#39;</span><span class="p">,</span> <span class="n">train</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">234</span><span class="p">)</span>
<span class="n">plot_proba</span><span class="p">(</span><span class="s1">&#39;qtd_same_ticket_bin&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="s1">&#39;distinction_in_name&#39;</span><span class="p">,</span> <span class="n">train</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">235</span><span class="p">)</span>
<span class="n">plot_proba</span><span class="p">(</span><span class="s1">&#39;qtd_same_ticket_bin&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="s1">&#39;Embarked_S&#39;</span><span class="p">,</span> <span class="n">train</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">235</span><span class="p">)</span>
<span class="n">plot_proba</span><span class="p">(</span><span class="s1">&#39;qtd_same_ticket_bin&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="s1">&#39;Embarked_S&#39;</span><span class="p">,</span> <span class="n">train</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">236</span><span class="p">)</span>
<span class="n">plot_proba</span><span class="p">(</span><span class="s1">&#39;qtd_same_ticket_bin&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="s1">&#39;parents&#39;</span><span class="p">,</span> <span class="n">train</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Accurancy: 83.73%
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_131_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Backward-Elimination-By-Accuracy---A-Sequential-Backward-Selection">Backward Elimination By Accuracy - A Sequential Backward Selection<a class="anchor-link" href="#Backward-Elimination-By-Accuracy---A-Sequential-Backward-Selection">&#182;</a></h5><p><strong>Sequential feature selection algorithms</strong> are a family of <strong>greedy search algorithms</strong> that are used to reduce an initial d-dimensional feature space to a k-dimensional feature subspace where k &lt; d. The motivation behind feature selection algorithms is to automatically select a subset of features that are most relevant to the problem to improve computational effciency or reduce the generalization error of the model by removing irrelevant features or noise, <strong><em>which can be useful for algorithms that don't
support regularization</em></strong>.</p>
<p>Greedy algorithms make locally optimal choices at each stage of a combinatorial search problem and generally yield a suboptimal solution to the problem in contrast to exhaustive search algorithms, which evaluate all possible combinations and are guaranteed to find the optimal solution. However, in practice, an exhaustive search is often computationally not feasible, whereas greedy algorithms allow for a less complex, computationally more efficient solution.</p>
<p>SBS aims to reduce the dimensionality of the initial feature subspace with a minimum decay in performance of the classifier to improve upon computational efficiency. In certain cases, SBS can even improve the predictive power of the model if a model suffers from overfitting.</p>
<p>SBS sequentially removes features from the full feature subset until the new feature subspace contains the desired number of features. In order to determine which feature is to be removed at each stage, we need to define criterion function J that we want to minimize. The criterion calculated by the criterion function can simply be the difference in performance of the classifier after and before the removal of a particular feature. Then the feature to be removed at each stage can simply be defined as the feature that maximizes this criterion.</p>
<p>From interactive executions, I already know that I need remove the surnames with less than 0.06 of correlation.</p>
<p>So, let's see a exemple of SBS in our data,</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[67]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SBS</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estimator</span><span class="p">,</span> <span class="n">k_features</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scoring</span> <span class="o">=</span> <span class="n">scoring</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">clone</span><span class="p">(</span><span class="n">estimator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_features</span> <span class="o">=</span> <span class="n">k_features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_size</span> <span class="o">=</span> <span class="n">test_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">test_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indices_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsets_</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">indices_</span><span class="p">]</span>
        <span class="n">score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scores_</span> <span class="o">=</span> <span class="p">[</span><span class="n">score</span><span class="p">]</span>
        
        <span class="k">while</span> <span class="n">dim</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_features</span><span class="p">:</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">subsets</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices_</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">dim</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
                <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
                <span class="n">subsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
                
            <span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">indices_</span> <span class="o">=</span> <span class="n">subsets</span><span class="p">[</span><span class="n">best</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subsets_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices_</span><span class="p">)</span>
            <span class="n">dim</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scores_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">best</span><span class="p">])</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">k_score_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scores_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">_calc_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">indices</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">indices</span><span class="p">],</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">indices</span><span class="p">])</span>
        <span class="n">score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scoring</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">score</span>
    
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sbs</span> <span class="o">=</span> <span class="n">SBS</span><span class="p">(</span><span class="n">knn</span><span class="p">,</span> <span class="n">k_features</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;surname_Harper&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Beckwith&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Goldenberg&#39;</span><span class="p">,</span>
                <span class="s1">&#39;surname_Moor&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Chambers&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Hamalainen&#39;</span><span class="p">,</span>
                <span class="s1">&#39;surname_Dick&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Taylor&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Doling&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Gordon&#39;</span><span class="p">,</span>
                <span class="s1">&#39;surname_Beane&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Hippach&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Bishop&#39;</span><span class="p">,</span>
                <span class="s1">&#39;surname_Mellinger&#39;</span><span class="p">,</span> <span class="s1">&#39;surname_Yarred&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">sbs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Score:&#39;</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">sbs</span><span class="o">.</span><span class="n">scores_</span><span class="p">))</span>

<span class="n">k_feat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">sbs</span><span class="o">.</span><span class="n">subsets_</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_feat</span><span class="p">,</span> <span class="n">sbs</span><span class="o">.</span><span class="n">scores_</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="c1">#plt.ylim([0.7, max(sbs.scores_)+0.01])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sbs</span><span class="o">.</span><span class="n">subsets_</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sbs</span><span class="o">.</span><span class="n">subsets_</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of features&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First best accuracy with:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">sbs</span><span class="o">.</span><span class="n">subsets_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">sbs</span><span class="o">.</span><span class="n">scores_</span><span class="p">)]]))</span>

<span class="n">SBS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">sbs</span><span class="o">.</span><span class="n">subsets_</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sbs</span><span class="o">.</span><span class="n">scores_</span><span class="p">))[(</span><span class="n">sbs</span><span class="o">.</span><span class="n">scores_</span><span class="o">==</span><span class="nb">max</span><span class="p">(</span><span class="n">sbs</span><span class="o">.</span><span class="n">scores_</span><span class="p">))])])])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Best accuracy with </span><span class="si">{0:2d}</span><span class="s1"> features:</span><span class="se">\n</span><span class="si">{1:}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SBS</span><span class="p">),</span> <span class="n">SBS</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Best Score: 0.8340807174887892
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_133_1.png"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>First best accuracy with:
 [&#39;non_relatives&#39;, &#39;surname_Goldenberg&#39;, &#39;surname_Chambers&#39;, &#39;surname_Hamalainen&#39;, &#39;surname_Dick&#39;, &#39;surname_Beane&#39;, &#39;surname_Mellinger&#39;, &#39;surname_Yarred&#39;, &#39;Age&#39;, &#39;SibSp&#39;, &#39;qtd_same_ticket_bin&#39;, &#39;Cabin_Number&#39;, &#39;relatives&#39;, &#39;Age_bin_custom_label&#39;]

Best accuracy with 14 features:
[&#39;non_relatives&#39;, &#39;surname_Goldenberg&#39;, &#39;surname_Chambers&#39;, &#39;surname_Hamalainen&#39;, &#39;surname_Dick&#39;, &#39;surname_Beane&#39;, &#39;surname_Mellinger&#39;, &#39;surname_Yarred&#39;, &#39;Age&#39;, &#39;SibSp&#39;, &#39;qtd_same_ticket_bin&#39;, &#39;Cabin_Number&#39;, &#39;relatives&#39;, &#39;Age_bin_custom_label&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Select-Features-by-Recursive-Feature-Elimination">Select Features by Recursive Feature Elimination<a class="anchor-link" href="#Select-Features-by-Recursive-Feature-Elimination">&#182;</a></h4><p>The goal of <a href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.RFE.html">Recursive Feature Elimination</a> (RFE) is to select features by recursively considering smaller and smaller sets of features.</p>
<p>RFE is based on the idea to repeatedly construct a model and choose either the best or worst performing feature, setting the feature aside and then repeating the process with the rest of the features. This process is applied until all features in the dataset are exhausted.</p>
<p>Other option is equential Feature Selector (SFS) from mlxtend, a separate Python library that is designed to work well with scikit-learn, also provides a S that works a bit differently.</p>
<p>RFE is computationally less complex using the feature's weight coefficients (e.g., linear models) or feature importances (tree-based algorithms) to eliminate features recursively, whereas SFSs eliminate (or add) features based on a user-defined classifier/regression performance metric.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[68]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="k">import</span> <span class="n">RFE</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">rfe</span> <span class="o">=</span> <span class="n">RFE</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span>  <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rfe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">FRFE</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">rfe</span><span class="o">.</span><span class="n">ranking_</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Features selected:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">FRFE</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Total Features selected:&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Features selected:
 Index([&#39;non_relatives&#39;, &#39;surname_Baclini&#39;, &#39;surname_Richards&#39;,
       &#39;surname_Harper&#39;, &#39;surname_Beckwith&#39;, &#39;surname_Goldenberg&#39;,
       &#39;surname_Moor&#39;, &#39;surname_Chambers&#39;, &#39;surname_Dick&#39;, &#39;surname_Taylor&#39;,
       &#39;surname_Beane&#39;, &#39;surname_Bishop&#39;, &#39;surname_Yarred&#39;, &#39;Pclass&#39;,
       &#39;qtd_same_ticket_bin&#39;, &#39;distinction_in_name&#39;, &#39;sons&#39;, &#39;parents&#39;,
       &#39;relatives&#39;, &#39;genre&#39;, &#39;Personal_Titles_Kid&#39;, &#39;Embarked_S&#39;,
       &#39;distinction_in_tikect_Low&#39;, &#39;distinction_in_tikect_Others&#39;,
       &#39;distinction_in_tikect_PC&#39;],
      dtype=&#39;object&#39;)

 Total Features selected: 25
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Select-Features-by-Embedded-Methods">Select Features by Embedded Methods<a class="anchor-link" href="#Select-Features-by-Embedded-Methods">&#182;</a></h3><p>In addition to the return of the performance itself, some models has in their internal process some step to features select that best fit their proposal, and returns the features importance too. Thus, they provide two straightforward methods for feature selection and combine the qualities of filter and wrapper methods.</p>
<p>Some of the most popular examples of these methods are LASSO, RIDGE, SVM, Regularized trees, Memetic algorithm, and Random multinomial logit.</p>
<p>In the case of Random Forest, some other models base on trees, we have two basic approaches implemented in the packages:</p>
<ol>
<li>Gini/Entropy Importance or Mean Decrease in Impurity (MDI)</li>
<li>Permutation Importance or Mean Decrease in Accuracy </li>
<li>Permutation with Shadow Features</li>
<li>Gradient Boosting</li>
</ol>
<p>Others models has concerns om <strong>multicollinearity</strong> problem and adding additional <strong>constraints</strong> or <strong>penalty</strong> to <strong>regularize</strong>. When there are multiple correlated features, as is the case with very many real life datasets, the model becomes unstable, meaning that small changes in the data can cause large changes in the model, making model interpretation very difficult on the regularization terms.</p>
<p>This applies to regression models like LASSO and RIDGE. In classifier cases, you can use SGDClassifier where you can set the loss parameter to 'log' for Logistic Regression or 'hinge' for SVM. In SGDClassifier you can set the penalty to either of 'l1', 'l2' or 'elasticnet' which is a combination of both.</p>
<p>Let's start with more details and examples:</p>
<h4 id="Feature-Selection-by-Mean-Decrease-Impurity">Feature Selection by Mean Decrease Impurity<a class="anchor-link" href="#Feature-Selection-by-Mean-Decrease-Impurity">&#182;</a></h4><p>There are a two things to keep in mind when using the impurity based ranking:</p>
<ul>
<li>Feature selection based on impurity reduction is biased towards preferring variables with more categories.</li>
<li>It can lead to the incorrect conclusion that one of the features is a strong predictor while the others in the same group are unimportant, while actually they are very close in terms of their relationship with the independet variable.</li>
</ul>
<p>The second one reffers to when the dataset has two or more correlated features, then from the point of view of the model, any of these correlated features can be used as the predictor, with no concrete preference of one over the others. But once one of them is used, the importance of others is significantly reduced since effectively the impurity they can remove is already removed by the first feature. As a consequence, they will have a lower reported importance. This is not an issue when we want to use feature selection to reduce overfitting, since it makes sense to remove features that are mostly duplicated by other features. But when interpreting the data. The effect of this phenomenon is somewhat reduced thanks to random selection of features at each node creation, but in general the effect is not removed completely.</p>
<p>The Random Forests is one of them, the reason is because the tree-based strategies used by random forests naturally ranks by how well they improve the purity of the node. This mean decrease in impurity over all trees, wheres for <strong>classification</strong>, it is typically either <strong>Gini impurity</strong> or <strong>information gain/entropy</strong> and for <strong>*regression</strong> it is <strong><em>variance</em></strong>. Thus when training a tree, it can be computed how much each feature decreases the weighted impurity in a tree. For a forest, the impurity decrease from each feature can be averaged and the features are ranked according to this measure.</p>
<p>Random forests are a popular method for feature ranking, since they are so easy to apply: in general they require very little feature engineering and parameter tuning and mean decrease impurity is exposed in most random forest libraries. But they come with their own gotchas, especially when data interpretation is concerned. With correlated features, strong features can end up with low scores and the method can be biased towards variables with many categories. As long as the gotchas are kept in mind, there really is no reason not to try them out on your data.</p>
<p>Them, we run a quick Random Forest to select the features most importantes:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[69]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rfc</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="n">rfc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">feature_importances</span> <span class="o">=</span> <span class="p">[(</span><span class="n">feature</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">feature</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">rfc</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">)]</span>

<span class="n">MDI</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">rfc</span><span class="o">.</span><span class="n">feature_importances_</span><span class="o">&gt;</span><span class="mf">0.010</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total features slected by Random Forest:&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">MDI</span><span class="p">))</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">feature_importances</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])[:</span><span class="nb">len</span><span class="p">(</span><span class="n">MDI</span><span class="p">)],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Feature&#39;</span><span class="p">,</span><span class="s1">&#39;Importance&#39;</span><span class="p">])</span><span class="o">.</span>\
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Feature&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Total features slected by Random Forest: 15
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_137_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Feature-Selection-by-Mean-Decrease-Accuracy">Feature Selection by Mean Decrease Accuracy<a class="anchor-link" href="#Feature-Selection-by-Mean-Decrease-Accuracy">&#182;</a></h4><p>The general idea is to permute the values of each feature and measure how much the permutation decreases the accuracy of the model. Clearly, for unimportant feature, the permutation should have little to no effect on model accuracy, while permuting important feature should significantly decrease it.</p>
<p>This method is not directly exposed in sklearn, but it is straightforward to implement it. Start record a baseline accuracy (classifier) or R2 score (regressor) by passing a validation set or the out-of-bag (OOB) samples through the random forest. Permute the column values of a single predictor feature and then pass all test samples back through the random forest and recompute the accuracy or R2. The importance of that feature is the difference between the baseline and the drop in overall accuracy or R2 caused by permuting the column. The permutation mechanism is much more computationally expensive than the mean decrease in impurity mechanism, but the results are more reliable.</p>
<p>The rfpimp package in the src dir provided it For Random Florest, lets see:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[70]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">y_train</span> <span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span>  <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>

<span class="c1"># Add column of random numbers</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;random&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<span class="n">X_test</span><span class="p">[</span><span class="s1">&#39;random&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>

<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">imp</span> <span class="o">=</span> <span class="n">importances</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># permutation</span>
<span class="n">MDA</span> <span class="o">=</span> <span class="n">imp</span><span class="p">[</span><span class="n">imp</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
<span class="k">if</span> <span class="s1">&#39;random&#39;</span> <span class="ow">in</span> <span class="n">MDA</span><span class="p">:</span>
   <span class="n">MDA</span> <span class="o">=</span>  <span class="n">MDA</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;random&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> features are selected.&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">MDA</span><span class="p">))</span>
<span class="n">plot_importances</span><span class="p">(</span><span class="n">imp</span><span class="p">[</span><span class="n">imp</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>16 features are selected.
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_139_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Feature-Selection-by-Permutation-with-Shadow-Features">Feature Selection by Permutation with Shadow Features<a class="anchor-link" href="#Feature-Selection-by-Permutation-with-Shadow-Features">&#182;</a></h4><p>Boruta randomly permutes variables like Permutation Importance does, but performs on all variables at the same time and concatenates the shuffled features with the original ones. The concatenated result is used to fit the model.</p>
<p>Daniel Homola, who also wrote the Python version of Boruta, <a href="https://github.com/scikit-learn-contrib/boruta_py/blob/master/boruta/boruta_py.py">BorutaPy</a>, gave an wonderful overview of the Boruta algorithm in his blog post
"The shuffled features (a.k.a. shadow features) are basically noises with identical marginal distribution w.r.t the original feature. We count the times a variable performs better than the best noise and calculate the confidence towards it being better than noise (the p-value) or not. Features which are confidently better are marked confirmed, and those which are confidently on par with noises are marked rejected. Then we remove those marked features and repeat the process until all features are marked or a certain number of iteration is reached."</p>
<p>Although Boruta is a feature selection algorithm, we can use the order of confirmation/rejection as a way to rank the importance of features.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># NOTE BorutaPy accepts numpy arrays only, hence the .values attribute</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="c1"># define random forest classifier, with utilising all cores and</span>
<span class="c1"># sampling in proportion to y labels</span>
<span class="c1">#rf = RandomForestClassifier(n_estimators=10, min_samples_leaf=5, n_jobs=-1, oob_score=True, random_state=101)</span>
<span class="n">rf</span> <span class="o">=</span> <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>

<span class="c1"># define Boruta feature selection method</span>
<span class="n">feat_selector</span> <span class="o">=</span> <span class="n">BorutaPy</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>

<span class="c1"># find all relevant features - 5 features should be selected</span>
<span class="n">feat_selector</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">shadow</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">feat_selector</span><span class="o">.</span><span class="n">support_</span><span class="p">]</span>
<span class="c1"># check selected features - first 5 features are selected</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Features selected:&#39;</span><span class="p">,</span><span class="n">shadow</span><span class="p">)</span>

<span class="c1"># call transform() on X to filter it down to selected features</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Data transformaded has </span><span class="si">%d</span><span class="s1"> features&#39;</span> <span class="o">%</span> <span class="n">feat_selector</span><span class="o">.</span><span class="n">n_features_</span><span class="p">)</span> <span class="c1">#feat_selector.transform(X).shape[1])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Check the selector ranking:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Columns&#39;</span><span class="p">]),</span> 
           <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feat_selector</span><span class="o">.</span><span class="n">ranking_</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Rank&#39;</span><span class="p">])],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Rank&#39;</span><span class="p">]))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Features selected: Index([&#39;surname_Alone&#39;, &#39;Pclass&#39;, &#39;Age&#39;, &#39;SibSp&#39;, &#39;Parch&#39;,
       &#39;qtd_same_ticket_bin&#39;, &#39;passenger_fare&#39;, &#39;distinction_in_name&#39;, &#39;sons&#39;,
       &#39;relatives&#39;, &#39;Age_bin_custom_label&#39;, &#39;genre&#39;, &#39;Cabin_Letter_B&#39;,
       &#39;Cabin_Letter_C&#39;, &#39;Cabin_Letter_E&#39;, &#39;Cabin_Letter_G&#39;,
       &#39;Personal_Titles_Kid&#39;, &#39;Personal_Titles_Miss&#39;, &#39;Embarked_C&#39;,
       &#39;Embarked_S&#39;, &#39;distinction_in_tikect_Low&#39;, &#39;distinction_in_tikect_PC&#39;],
      dtype=&#39;object&#39;)
Data transformaded has 22 features
Check the selector ranking:
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Columns</th>
      <th>Rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25</th>
      <td>passenger_fare</td>
      <td>1</td>
    </tr>
    <tr>
      <th>22</th>
      <td>SibSp</td>
      <td>1</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Parch</td>
      <td>1</td>
    </tr>
    <tr>
      <th>24</th>
      <td>qtd_same_ticket_bin</td>
      <td>1</td>
    </tr>
    <tr>
      <th>26</th>
      <td>distinction_in_name</td>
      <td>1</td>
    </tr>
    <tr>
      <th>28</th>
      <td>sons</td>
      <td>1</td>
    </tr>
    <tr>
      <th>30</th>
      <td>relatives</td>
      <td>1</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Age_bin_custom_label</td>
      <td>1</td>
    </tr>
    <tr>
      <th>34</th>
      <td>genre</td>
      <td>1</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Cabin_Letter_B</td>
      <td>1</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Cabin_Letter_C</td>
      <td>1</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Cabin_Letter_E</td>
      <td>1</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Cabin_Letter_G</td>
      <td>1</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Personal_Titles_Kid</td>
      <td>1</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Personal_Titles_Miss</td>
      <td>1</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Embarked_C</td>
      <td>1</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Embarked_S</td>
      <td>1</td>
    </tr>
    <tr>
      <th>48</th>
      <td>distinction_in_tikect_Low</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Age</td>
      <td>1</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Pclass</td>
      <td>1</td>
    </tr>
    <tr>
      <th>50</th>
      <td>distinction_in_tikect_PC</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>surname_Alone</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>non_relatives</td>
      <td>2</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Without_Age</td>
      <td>2</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Cabin_Letter_D</td>
      <td>2</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Cabin_Number</td>
      <td>3</td>
    </tr>
    <tr>
      <th>29</th>
      <td>parents</td>
      <td>3</td>
    </tr>
    <tr>
      <th>31</th>
      <td>companions</td>
      <td>3</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Cabin_Letter_F</td>
      <td>5</td>
    </tr>
    <tr>
      <th>49</th>
      <td>distinction_in_tikect_Others</td>
      <td>6</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Embarked_Q</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>surname_Baclini</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>surname_Richards</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>surname_Carter</td>
      <td>10</td>
    </tr>
    <tr>
      <th>9</th>
      <td>surname_Chambers</td>
      <td>11</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Personal_Titles_Technical</td>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>surname_Doling</td>
      <td>13</td>
    </tr>
    <tr>
      <th>19</th>
      <td>surname_Yarred</td>
      <td>14</td>
    </tr>
    <tr>
      <th>10</th>
      <td>surname_Hamalainen</td>
      <td>15</td>
    </tr>
    <tr>
      <th>6</th>
      <td>surname_Beckwith</td>
      <td>16</td>
    </tr>
    <tr>
      <th>11</th>
      <td>surname_Dick</td>
      <td>17</td>
    </tr>
    <tr>
      <th>15</th>
      <td>surname_Beane</td>
      <td>18</td>
    </tr>
    <tr>
      <th>12</th>
      <td>surname_Taylor</td>
      <td>19</td>
    </tr>
    <tr>
      <th>8</th>
      <td>surname_Moor</td>
      <td>20</td>
    </tr>
    <tr>
      <th>18</th>
      <td>surname_Mellinger</td>
      <td>20</td>
    </tr>
    <tr>
      <th>7</th>
      <td>surname_Goldenberg</td>
      <td>22</td>
    </tr>
    <tr>
      <th>16</th>
      <td>surname_Hippach</td>
      <td>22</td>
    </tr>
    <tr>
      <th>17</th>
      <td>surname_Bishop</td>
      <td>24</td>
    </tr>
    <tr>
      <th>14</th>
      <td>surname_Gordon</td>
      <td>25</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Personal_Titles_Royalty</td>
      <td>26</td>
    </tr>
    <tr>
      <th>5</th>
      <td>surname_Harper</td>
      <td>27</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Feature-Selection-by-Gradient-Boosting">Feature Selection by Gradient Boosting<a class="anchor-link" href="#Feature-Selection-by-Gradient-Boosting">&#182;</a></h4><p>For Kagglers, this part should be familiar due to the extreme popularity of XGBoost and LightGBM. Both packages implement more of the same measures (XGBoost has one more):</p>
<p>On the LightGBM model the importance is calculed from, if split, result contains numbers of times the feature is used in a model, if gain, result contains total gains of splits which use the feature.</p>
<p>On the <a href="https://xgboost.readthedocs.io/en/latest/python/python_api.html">XGBoost</a> model the importance is calculed by:</p>
<ul>
<li>weight: the number of times a feature is used to split the data across all trees.</li>
<li>gain: the average gain across all splits the feature is used in.</li>
<li>cover: the average coverage across all splits the feature is used in.</li>
<li>total_gain: the total gain across all splits the feature is used in.</li>
<li>total_cover: the total coverage across all splits the feature is used in.</li>
</ul>
<p>First measure is split-based and is very similar with the one given by for Gini Importance. But it doesnt take the number of samples into account.</p>
<p>The second measure is gain-based. Its basically the same as the Gini Importance implemented in R packages and in scikit-learn with Gini impurity replaced by the objective used by the gradient boosting model.</p>
<p>The cover, implemented exclusively in XGBoost, is counting the number of samples affected by the splits based on a feature.</p>
<p>get_score(fmap='', importance_type='weight')
Get feature importance of each feature. Importance type can be defined as:</p>
<p>The default measure of both XGBoost and LightGBM is the split-based one. I think this measure will be problematic if there are one or two feature with strong signals and a few features with weak signals. The model will exploit the strong features in the first few trees and use the rest of the features to improve on the residuals. The strong features will look not as important as they actually are. While setting lower learning rate and early stopping should alleviate the problem, also checking gain-based measure may be a good idea.</p>
<p>Note that these measures are purely calculated using training data, so theres a chance that a split creates no improvement on the objective in the holdout set. This problem is more severe than in the random forest since gradient boosting models are more prone to over-fitting.</p>
<p>Feature importance scores can be used for feature selection in scikit-learn.</p>
<p>This is done using the SelectFromModel class that takes a model and can transform a dataset into a subset with selected features.</p>
<p>This class can take a pre-trained model, such as one trained on the entire training dataset. It can then use a threshold to decide which features to select. This threshold is used when you call the transform() method on the SelectFromModel instance to consistently select the same features on the training dataset and the test dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[72]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>

<span class="c1"># split data into train and test sets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>

<span class="c1"># fit model on all training data</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">importance_type</span><span class="o">=</span><span class="s1">&#39;gain&#39;</span><span class="p">,</span> <span class="n">scale_pos_weight</span><span class="o">=</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">/</span><span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">plot_importance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># Using each unique importance as a threshold</span>
<span class="n">thresholds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">))</span> <span class="c1">#np.sort(model.feature_importances_[model.feature_importances_&gt;0])</span>
<span class="n">best</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">colsbest</span> <span class="o">=</span> <span class="mi">31</span>
<span class="n">my_model</span> <span class="o">=</span> <span class="n">model</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">thresh</span> <span class="ow">in</span> <span class="n">thresholds</span><span class="p">:</span>
    <span class="c1"># select features using threshold</span>
    <span class="n">selection</span> <span class="o">=</span> <span class="n">SelectFromModel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">thresh</span><span class="p">,</span> <span class="n">prefit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">select_X_train</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="c1"># train model</span>
    <span class="n">selection_model</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">importance_type</span><span class="o">=</span><span class="s1">&#39;gain&#39;</span><span class="p">,</span> <span class="n">scale_pos_weight</span><span class="o">=</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">/</span><span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
    <span class="n">selection_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">select_X_train</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="c1"># eval model</span>
    <span class="n">select_X_test</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">selection_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">select_X_test</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">y_pred</span><span class="p">]</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Thresh=</span><span class="si">{:1.3f}</span><span class="s2">, n=</span><span class="si">{:d}</span><span class="s2">, Accuracy: </span><span class="si">{:2.2%}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">thresh</span><span class="p">,</span> <span class="n">select_X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">accuracy</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">best</span> <span class="o">&lt;=</span> <span class="n">accuracy</span><span class="p">):</span>
        <span class="n">best</span> <span class="o">=</span> <span class="n">accuracy</span>
        <span class="n">colsbest</span> <span class="o">=</span> <span class="n">select_X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">my_model</span> <span class="o">=</span> <span class="n">selection_model</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="n">thresh</span>
        
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">plot_importance</span><span class="p">(</span><span class="n">my_model</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;The best accuracy: </span><span class="si">{:2.2%}</span><span class="s1"> with </span><span class="si">{:d}</span><span class="s1"> features&#39;</span><span class="o">.</span>\
                    <span class="nb">format</span><span class="p">(</span><span class="n">best</span><span class="p">,</span> <span class="n">colsbest</span><span class="p">))</span>

<span class="n">feature_importances</span> <span class="o">=</span> <span class="p">[(</span><span class="n">score</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span> <span class="k">for</span> <span class="n">score</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">cols</span><span class="p">)]</span>
<span class="n">XGBest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">feature_importances</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="n">colsbest</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Score&#39;</span><span class="p">,</span> <span class="s1">&#39;Feature&#39;</span><span class="p">])</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">XGBest</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Feature&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
     <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Original feature importance from selected features&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">XGBestCols</span> <span class="o">=</span> <span class="n">XGBest</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Thresh=0.000, n=51, Accuracy: 84.33%
Thresh=0.002, n=26, Accuracy: 84.33%
Thresh=0.003, n=24, Accuracy: 84.70%
Thresh=0.005, n=23, Accuracy: 84.70%
Thresh=0.007, n=21, Accuracy: 84.70%
Thresh=0.008, n=19, Accuracy: 84.33%
Thresh=0.010, n=17, Accuracy: 84.33%
Thresh=0.017, n=15, Accuracy: 84.33%
Thresh=0.018, n=13, Accuracy: 83.58%
Thresh=0.020, n=12, Accuracy: 83.96%
Thresh=0.025, n=11, Accuracy: 84.33%
Thresh=0.029, n=10, Accuracy: 82.09%
Thresh=0.042, n=9, Accuracy: 82.09%
Thresh=0.045, n=8, Accuracy: 83.21%
Thresh=0.052, n=7, Accuracy: 83.21%
Thresh=0.059, n=6, Accuracy: 82.84%
Thresh=0.062, n=5, Accuracy: 82.84%
Thresh=0.065, n=4, Accuracy: 70.52%
Thresh=0.067, n=3, Accuracy: 69.40%
Thresh=0.186, n=2, Accuracy: 69.03%
Thresh=0.228, n=1, Accuracy: 63.06%
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_143_1.png"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_143_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Feature-Selection-by-Regularized-Models">Feature Selection by Regularized Models<a class="anchor-link" href="#Feature-Selection-by-Regularized-Models">&#182;</a></h4><p>Regularization is a method for adding additional constraints or penalty to a model, with the goal of preventing overfitting and improving generalization. Instead of minimizing a loss function E(X,Y), the loss function to minimize becomes E(X,Y)+w, where w is the vector of model coefficients,  is typically L1 or L2 norm and  is a tunable free parameter, specifying the amount of regularization (so =0 implies an unregularized model). The two widely used regularization methods are L1 and L2 regularization, also called lasso and ridge.</p>
<p>Regularized models are a powerful set of tool for feature interpretation and selection. Lasso produces sparse solutions and as such is very useful selecting a strong subset of features for improving model performance. Ridge on the other hand can be used for data interpretation due to its stability and the fact that useful features tend to have non-zero coefficients. Since the relationship between the response variable and features in often non-linear, basis expansion can be used to convert features into a more suitable space, while keeping the simple linear models fully applicable.</p>
<p>Let's see the SGDClassifier that have this concept implemented for classifications cases, and to address the skewness of our dataset in terms of labels we use the class_weight parameter of SGDCassifier and set it to "balanced":</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">y_train</span> <span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span>  <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>

<span class="c1"># Add column of random numbers</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;random&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<span class="n">X_test</span><span class="p">[</span><span class="s1">&#39;random&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>

<span class="n">svm</span> <span class="o">=</span> <span class="n">SGDClassifier</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;elasticnet&#39;</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="n">svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">imp</span> <span class="o">=</span> <span class="n">importances</span><span class="p">(</span><span class="n">svm</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># permutation</span>
<span class="n">RM</span> <span class="o">=</span> <span class="n">imp</span><span class="p">[</span><span class="n">imp</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
<span class="k">if</span> <span class="s1">&#39;random&#39;</span> <span class="ow">in</span> <span class="n">RM</span><span class="p">:</span>
    <span class="n">RM</span> <span class="o">=</span> <span class="n">RM</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;random&#39;</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> features are selected.&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">RM</span><span class="p">))</span>
<span class="n">plot_importances</span><span class="p">(</span><span class="n">imp</span><span class="p">[</span><span class="n">imp</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>21 features are selected.
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_145_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Combine-Features-Selection-Methods">Combine Features Selection Methods<a class="anchor-link" href="#Combine-Features-Selection-Methods">&#182;</a></h3><p>As each machine learning model benefits from one or another set of features selected, depending on its own method, and our dataset does in fact present few features, since we first removed the collinear and multilinear with the highest correlation and the highest degree of FIV that represents risk for our model, now we can union all selected features in a unique set, and check what features are elected exclusively by a unique method.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bcols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDI</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDA</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MBR</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SMcols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">RM</span><span class="p">))</span><span class="o">.</span>\
        <span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">XGBestCols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SBS</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extra features select by RFE:&quot;</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">FRFE</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDI</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDA</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MBR</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">RM</span><span class="p">))</span><span class="o">.</span>\
                                                            <span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SMcols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">XGBestCols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SBS</span><span class="p">))),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extra features select by pv_cols:&quot;</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">FRFE</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDI</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDA</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MBR</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SMcols</span><span class="p">))</span><span class="o">.</span>\
                                              <span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">RM</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">XGBestCols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SBS</span><span class="p">))),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extra features select by Statistical Methods:&quot;</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">SMcols</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDI</span><span class="p">))</span><span class="o">.</span>\
                                                         <span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDA</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MBR</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">RM</span><span class="p">))</span><span class="o">.</span>\
                                                        <span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">XGBestCols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SBS</span><span class="p">))),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extra features select by MDI:&quot;</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">MDI</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDA</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MBR</span><span class="p">))</span><span class="o">.</span>\
                                          <span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SMcols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">RM</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">XGBestCols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SBS</span><span class="p">))),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extra features select by MDA:&quot;</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">MDA</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDI</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MBR</span><span class="p">))</span><span class="o">.</span>\
                                          <span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SMcols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">RM</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">XGBestCols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SBS</span><span class="p">))),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extra features select by MBR:&quot;</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">MBR</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDI</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDA</span><span class="p">))</span><span class="o">.</span>\
                                          <span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SMcols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">RM</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">XGBestCols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SBS</span><span class="p">))),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extra features select by RM:&quot;</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">RM</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDI</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDA</span><span class="p">))</span><span class="o">.</span>\
                                          <span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SMcols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MBR</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">XGBestCols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SBS</span><span class="p">))),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extra features select by XGBestCols:&quot;</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">XGBestCols</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDI</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDA</span><span class="p">))</span><span class="o">.</span>\
                                          <span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SMcols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MBR</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">RM</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SBS</span><span class="p">))),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extra features select by SBS:&quot;</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">SBS</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDI</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDA</span><span class="p">))</span><span class="o">.</span>\
                                          <span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SMcols</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MBR</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">RM</span><span class="p">))</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">XGBestCols</span><span class="p">))),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Intersection features:&quot;</span><span class="p">,</span><span class="nb">set</span><span class="p">(</span><span class="n">MDI</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SMcols</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">))</span><span class="o">.</span>\
                                  <span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">RM</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MDA</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">MBR</span><span class="p">))</span><span class="o">.</span>\
                                  <span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">XGBestCols</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">SBS</span><span class="p">)),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total number of features selected:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bcols</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bcols</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{0:2d}</span><span class="s1"> features removed if use the union of selections:</span><span class="se">\n</span><span class="si">{1:}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">bcols</span><span class="p">)),</span> <span class="n">cols</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">bcols</span><span class="p">)))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Extra features select by RFE: {&#39;surname_Baclini&#39;, &#39;surname_Bishop&#39;, &#39;surname_Taylor&#39;, &#39;surname_Harper&#39;, &#39;surname_Richards&#39;, &#39;surname_Moor&#39;, &#39;surname_Beckwith&#39;} 

Extra features select by pv_cols: set() 

Extra features select by Statistical Methods: set() 

Extra features select by MDI: set() 

Extra features select by MDA: {&#39;Cabin_Letter_G&#39;} 

Extra features select by MBR: set() 

Extra features select by RM: {&#39;Cabin_Letter_D&#39;, &#39;Cabin_Letter_F&#39;} 

Extra features select by XGBestCols: {&#39;surname_Alone&#39;} 

Extra features select by SBS: {&#39;surname_Mellinger&#39;, &#39;surname_Hamalainen&#39;} 

Intersection features: set() 

Total number of features selected: 44
{&#39;Without_Age&#39;, &#39;distinction_in_tikect_Others&#39;, &#39;surname_Bishop&#39;, &#39;surname_Dick&#39;, &#39;surname_Harper&#39;, &#39;SibSp&#39;, &#39;sons&#39;, &#39;distinction_in_tikect_PC&#39;, &#39;passenger_fare&#39;, &#39;non_relatives&#39;, &#39;surname_Baclini&#39;, &#39;Cabin_Letter_E&#39;, &#39;Age&#39;, &#39;relatives&#39;, &#39;distinction_in_tikect_Low&#39;, &#39;surname_Beckwith&#39;, &#39;surname_Goldenberg&#39;, &#39;surname_Alone&#39;, &#39;Cabin_Letter_B&#39;, &#39;surname_Beane&#39;, &#39;surname_Hamalainen&#39;, &#39;Pclass&#39;, &#39;surname_Richards&#39;, &#39;Cabin_Letter_C&#39;, &#39;Personal_Titles_Miss&#39;, &#39;Cabin_Letter_F&#39;, &#39;surname_Yarred&#39;, &#39;Age_bin_custom_label&#39;, &#39;Embarked_C&#39;, &#39;Parch&#39;, &#39;Cabin_Letter_D&#39;, &#39;surname_Chambers&#39;, &#39;Cabin_Letter_G&#39;, &#39;surname_Taylor&#39;, &#39;companions&#39;, &#39;parents&#39;, &#39;genre&#39;, &#39;qtd_same_ticket_bin&#39;, &#39;distinction_in_name&#39;, &#39;Embarked_S&#39;, &#39;surname_Moor&#39;, &#39;Cabin_Number&#39;, &#39;surname_Mellinger&#39;, &#39;Personal_Titles_Kid&#39;}

 7 features removed if use the union of selections:
Index([&#39;Embarked_Q&#39;, &#39;Personal_Titles_Royalty&#39;, &#39;Personal_Titles_Technical&#39;,
       &#39;surname_Carter&#39;, &#39;surname_Doling&#39;, &#39;surname_Gordon&#39;,
       &#39;surname_Hippach&#39;],
      dtype=&#39;object&#39;)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Chose-The-Features-From-The-Selection-Methods">Chose The Features From The Selection Methods<a class="anchor-link" href="#Chose-The-Features-From-The-Selection-Methods">&#182;</a></h3><p>As you can saw the methods chose some different features that,if we consider the intersection, there is nothing left, and if the union only removes eight features.As expected, we can't made a unique strategy, the right chose depends on your proposal and the respective model that you will run.</p>
<p>Since, we have few features, by the reason of don't consider all results of hot encode of surnames, we can try some models with different sets and check the influence in the results, like we did on the methods that selecting based on accuracy of the model. In the other hand, we can make the feature selection as parte of the pipeline of the model and select features based on the best for the respective model. This is allows different strategies, including the use of methods for sparse data and thus evaluate the surnames, or methods that apply regularization in data to submit to models that don't have regularization terms.</p>
<p>For the submission, I already run multiple times and made choices to submit. Here for simplicity, I chose the initial result with only drop collinearity and multicollinearity, and make the selection into the pipelines, but we need first check what we can get from dimension reduction techniques.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Additional-Feature-Engineering:-Feature-transformation">Additional Feature Engineering: Feature transformation<a class="anchor-link" href="#Additional-Feature-Engineering:-Feature-transformation">&#182;</a></h2><p><strong>Feature transformation</strong> (<a href="http://scikit-learn.org/stable/data_transforms.html">FT</a>) refers to family of algorithms that create new features using the existing features. These new features may not have the same interpretation as the original features, but they may have more discriminatory power in a different space than the original space. This can also be used for feature reduction. FT may happen in many ways, by simple/linear combinations of original features or using non-linear functions. Some common techniques for FT are:</p>
<ul>
<li><a href="http://scikit-learn.org/stable/modules/preprocessing.html#standardization-or-mean-removal-and-variance-scaling">Scaling</a> or normalizing features (e.g.: StandardScaler, RobustSacaler and MinMaxScaler)</li>
<li>Principle Component Analysis</li>
<li><a href="http://scikit-learn.org/stable/modules/random_projection.html">Random Projection</a></li>
<li>Neural Networks</li>
<li>SVM also transforms features internally.</li>
<li>Transforming <a href="http://scikit-learn.org/stable/modules/preprocessing.html#encoding-categorical-features">categorical</a> features to numerical.</li>
</ul>
<h3 id="Polynomial-Features---Create-Degree-3-of-some-Features"><a href="http://scikit-learn.org/stable/modules/preprocessing.html#generating-polynomial-features">Polynomial Features</a> - Create Degree 3 of some Features<a class="anchor-link" href="#Polynomial-Features---Create-Degree-3-of-some-Features">&#182;</a></h3><p>Often its useful to add complexity to the model by considering nonlinear features of the input data. A simple and common method to use is polynomial features, which can get features high-order and interaction terms.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[75]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pf</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">interaction_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">,</span> <span class="s1">&#39;passenger_fare&#39;</span><span class="p">]])</span>

<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pf</span><span class="o">.</span><span class="n">powers_</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">,</span> <span class="s1">&#39;passenger_fare&#39;</span><span class="p">]))</span>
<span class="k">del</span> <span class="n">res</span> 

<span class="c1"># We can contact the new res with data, but we need treat the items without interactions and power, </span>
<span class="c1"># or if is few features it can generate and incorporate to data manually.</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Pclass^2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">**</span><span class="mi">2</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Plcass_X_p_fare&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Pclass</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;p_fare^2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">passenger_fare</span><span class="o">**</span><span class="mi">2</span>

<span class="n">cols</span> <span class="o">=</span> <span class="n">cols</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="s1">&#39;Pclass^2&#39;</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">cols</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">34</span><span class="p">,</span> <span class="s1">&#39;Plcass_X_p_fare&#39;</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">cols</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="s1">&#39;p_fare^2&#39;</span><span class="p">)</span>

<span class="n">bcols</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Pclass^2&#39;</span><span class="p">)</span>
<span class="n">bcols</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Plcass_X_p_fare&#39;</span><span class="p">)</span>
<span class="n">bcols</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;p_fare^2&#39;</span><span class="p">)</span>

<span class="n">scale</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">(</span><span class="n">with_std</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scale</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span> <span class="n">cols</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pclass</th>
      <th>passenger_fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Defining-Categorical-Data-as-Category">Defining Categorical Data as Category<a class="anchor-link" href="#Defining-Categorical-Data-as-Category">&#182;</a></h3><p>In order that the models do not make inappropriate use of features transformed into numbers and apply only calculations relevant to cetegoricas, we have to transform their type into category type</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">Pclass</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Pclass</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">genre</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">genre</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">distinction_in_tikect_Low</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">distinction_in_tikect_Low</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">distinction_in_tikect_PC</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">distinction_in_tikect_PC</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">distinction_in_tikect_Others</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">distinction_in_tikect_Others</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter_B</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter_B</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter_C</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter_C</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter_D</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter_D</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter_E</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter_E</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter_F</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter_F</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter_G</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Cabin_Letter_G</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Embarked_C</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Embarked_C</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Embarked_S</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Embarked_S</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Embarked_Q</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Embarked_Q</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles_Royalty</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles_Royalty</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles_Technical</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles_Technical</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles_Kid</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles_Kid</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles_Mrs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles_Mrs</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles_Mr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles_Mr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles_Miss</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Personal_Titles_Miss</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">Without_Age</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Without_Age</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">distinction_in_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">distinction_in_name</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">parents</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">parents</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">relatives</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">relatives</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">sons</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sons</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">companions</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">companions</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Alone</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Alone</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Baclini</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Baclini</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Carter</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Carter</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Richards</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Richards</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Harper</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Harper</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Beckwith</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Beckwith</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Goldenberg</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Goldenberg</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Moor</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Moor</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Chambers</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Chambers</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Hamalainen</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Hamalainen</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Dick</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Dick</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Taylor</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Taylor</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Doling</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Doling</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Gordon</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Gordon</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Beane</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Beane</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Hippach</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Hippach</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Bishop</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Bishop</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Mellinger</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Mellinger</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">surname_Yarred</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">surname_Yarred</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Box-cox-transformation-of-highly-skewed-features">Box cox transformation of highly skewed features<a class="anchor-link" href="#Box-cox-transformation-of-highly-skewed-features">&#182;</a></h3><p>A Box Cox transformation is a way to transform non-normal dependent variables into a normal shape.</p>
<p>Why does this matter?</p>
<ul>
<li><strong>Model bias and spurious interactions</strong>: If you are performing a regression or any statistical modelling, this asymmetrical behavior may lead to a bias in the model. If a factor has a significant effect on the average, because the variability is much larger, many factors will seem to have a stronger effect when the mean is larger. This is not due, however, to a true factor effect but rather to an increased amount of variability that affects all factor effect estimates when the mean gets larger. This will probably generate spurious interactions due to a non-constant variation, resulting in a <strong>very complex model</strong> with many <strong>spurious</strong> and <strong>unrealistic</strong> interactions.</li>
<li><strong>Normality is an important assumption for many statistical techniques</strong>: such as individuals control charts, Cp/Cpk analysis, t-tests and analysis of variance (ANOVA). A substantial departure from normality will bias your capability estimates.</li>
</ul>
<p>One solution to this is to transform your data into normality using a <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.boxcox.html">Box-Cox transformation</a> means that you are able to run a broader number of tests.</p>
<p>At the core of the Box Cox transformation is an exponent, lambda (), which varies from -5 to 5. All values of  are considered and the optimal value for your data is selected; The optimal value is the one which results in the best approximation of a normal distribution curve. The transformation of Y has the form:
<img src="attachment:image.png" alt="image.png"></p>
<p>The scipy implementation proceeded with this formula, then you need before take care of negatives values if you have. A common technique for handling negative values is to add a constant value to the data prior to applying the log transform. The transformation is therefore log(Y+a) where a is the constant. Some people like to choose a so that min(Y+a) is a very small positive number (like 0.001). Others choose a so that min(Y+a) = 1. For the latter choice, you can show that a = b  min(Y), where b is either a small number or is 1.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This test only works for positive data. However, Box and Cox did propose a second formula that can be used for negative y-values, not implementd in scipy:
<img src="attachment:image.png" alt="image.png">
The formulae are deceptively simple. Testing all possible values by hand is unnecessarily labor intensive.</p>
<p align='center'> Common Box-Cox Transformations 
</p><table>
<thead><tr>
<th>Lambda value ()</th>
<th>Transformed data (Y)</th>
</tr>
</thead>
<tbody>
<tr>
<td>-3</td>
<td>Y**-3 = 1/Y**3</td>
</tr>
<tr>
<td>-2</td>
<td>Y**-2 = 1/Y**2</td>
</tr>
<tr>
<td>-1</td>
<td>Y**-1 = 1/Y</td>
</tr>
<tr>
<td>-0.5</td>
<td>Y**-0.5 = 1/((Y))</td>
</tr>
<tr>
<td>0</td>
<td>log(Y)(*)</td>
</tr>
<tr>
<td>0.5</td>
<td>Y0.5 = (Y)</td>
</tr>
<tr>
<td>1</td>
<td>Y**1 = Y</td>
</tr>
<tr>
<td>2</td>
<td>Y**2</td>
</tr>
<tr>
<td>3</td>
<td>Y**3</td>
</tr>
</tbody>
</table>
<p>(*)Note: the transformation for zero is log(0), otherwise all data would transform to Y**0 = 1.
The transformation doesnt always work well, so make sure you check your data after the transformation with a normal probability plot or if the skew are reduced, tending to zero.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">numeric_features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">!=</span> <span class="s2">&quot;category&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># non_relative is skwed and have negatives values, so we need adding 6 as a shift parameter.</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;non_relatives_shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">non_relatives</span> <span class="o">+</span> <span class="mi">6</span>
<span class="n">numeric_features</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;non_relatives&#39;</span><span class="p">)</span>
<span class="n">numeric_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;non_relatives_shift&#39;</span><span class="p">)</span>

<span class="n">skewed_features</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">numeric_features</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">skew</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">()))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">#compute skewness</span>
<span class="n">skewness</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Skew&#39;</span> <span class="p">:</span><span class="n">skewed_features</span><span class="p">})</span>   

<span class="c1"># Get only higest skewed features</span>
<span class="n">skewness</span> <span class="o">=</span> <span class="n">skewness</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">skewness</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">]</span>
<span class="n">skewness</span> <span class="o">=</span> <span class="n">skewness</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> higest skewed numerical features to box cox transform&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">skewness</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="n">l_opt</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1">#df = pd.DataFrame()    </span>
<span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">skewness</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="c1">#df[feat] = boxcox1p(data[feat], l_opt[feat])</span>
    <span class="c1">#data[feat] = boxcox1p(data[feat], l_opt[feat])</span>
    <span class="n">data</span><span class="p">[</span><span class="n">feat</span><span class="p">],</span> <span class="n">l_opt</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span> <span class="o">=</span> <span class="n">boxcox</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

<span class="c1">#skewed_features2 = df.apply(lambda x : skew (x.dropna())).sort_values(ascending=False)</span>
<span class="n">skewed_features2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">skewness</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">skew</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">()))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">#compute skewness</span>
<span class="n">skewness2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;New Skew&#39;</span> <span class="p">:</span><span class="n">skewed_features2</span><span class="p">})</span>   
<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">skewness</span><span class="p">,</span> <span class="n">skewness2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Skew&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 8 higest skewed numerical features to box cox transform
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Skew</th>
      <th>New Skew</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>p_fare^2</th>
      <td>10.198854</td>
      <td>-0.042275</td>
    </tr>
    <tr>
      <th>Plcass_X_p_fare</th>
      <td>4.275970</td>
      <td>0.799022</td>
    </tr>
    <tr>
      <th>SibSp</th>
      <td>3.839814</td>
      <td>0.795656</td>
    </tr>
    <tr>
      <th>Parch</th>
      <td>3.664872</td>
      <td>1.255973</td>
    </tr>
    <tr>
      <th>passenger_fare</th>
      <td>3.041171</td>
      <td>-0.028864</td>
    </tr>
    <tr>
      <th>non_relatives_shift</th>
      <td>2.721651</td>
      <td>0.464157</td>
    </tr>
    <tr>
      <th>qtd_same_ticket_bin</th>
      <td>1.378407</td>
      <td>0.390559</td>
    </tr>
    <tr>
      <th>Cabin_Number</th>
      <td>1.253198</td>
      <td>-0.013094</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, we were able at first to bring the numerical values closer to normal. Let's take a look at the QQ test of these fascities.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[78]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">QQ_plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">measure</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

    <span class="c1">#Get the fitted parameters used by the function</span>
    <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1">#Kernel Density plot</span>
    <span class="n">fig1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
    <span class="n">fig1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">measure</span> <span class="o">+</span> <span class="s1">&#39; Distribution ( mu = </span><span class="si">{:.2f}</span><span class="s1"> and sigma = </span><span class="si">{:.2f}</span><span class="s1"> )&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">fig1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">measure</span><span class="p">)</span>
    <span class="n">fig1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>

    <span class="c1">#QQ plot</span>
    <span class="n">fig2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">probplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">fig2</span><span class="p">)</span>
    <span class="n">fig2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">measure</span> <span class="o">+</span> <span class="s1">&#39; Probability Plot (skewness: </span><span class="si">{:.6f}</span><span class="s1"> and kurtosis: </span><span class="si">{:.6f}</span><span class="s1"> )&#39;</span><span class="o">.</span>\
                   <span class="nb">format</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">skew</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">kurt</span><span class="p">()),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
<span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">skewness</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="n">QQ_plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">feat</span><span class="p">],</span> <span class="p">(</span><span class="s1">&#39;Boxcox1p of </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">feat</span><span class="p">)))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_157_0.png"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_157_1.png"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_157_2.png"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_157_3.png"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_157_4.png"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_157_5.png"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_157_6.png"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_157_7.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Compressing-Data-via-Dimensionality-Reduction">Compressing Data via Dimensionality Reduction<a class="anchor-link" href="#Compressing-Data-via-Dimensionality-Reduction">&#182;</a></h3><h4 id="PCA-evaluetion">PCA evaluetion<a class="anchor-link" href="#PCA-evaluetion">&#182;</a></h4><p><strong>Principal component analysis</strong> (<a href="http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html">PCA</a>) is a statistical procedure that uses an orthogonal transformation to convert a set of observations of possibly correlated variables into a set of values of linearly uncorrelated variables called principal components. If there are n observations with p variables, then the number of distinct principal components is <code>min(n-1,p)</code>. This transformation is defined in such a way that the first principal component has the largest possible variance, and each succeeding component in turn has the highest variance possible under the constraint that it is orthogonal to the preceding components. The resulting vectors are an uncorrelated orthogonal basis set. PCA is sensitive to the relative scaling of the original variables.
<img src="attachment:image.png" alt="image.png"></p>
<p>Let's see how PCA can reduce the dimensionality of our dataset with minimum of lose information:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pca_all</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">whiten</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="n">my_color</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>

<span class="c1"># Store results of PCA in a data frame</span>
<span class="n">result</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pca_all</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PCA</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])],</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Plot initialisation</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;PCA0&#39;</span><span class="p">],</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;PCA1&#39;</span><span class="p">],</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;PCA2&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">my_color</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Set2_r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
 
<span class="c1"># make simple, bare axis lines through space:</span>
<span class="n">xAxisLine</span> <span class="o">=</span> <span class="p">((</span><span class="nb">min</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;PCA0&#39;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;PCA0&#39;</span><span class="p">])),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xAxisLine</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xAxisLine</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xAxisLine</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">yAxisLine</span> <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;PCA1&#39;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;PCA1&#39;</span><span class="p">])),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yAxisLine</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yAxisLine</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">yAxisLine</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">zAxisLine</span> <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;PCA2&#39;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;PCA2&#39;</span><span class="p">])))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">zAxisLine</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zAxisLine</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zAxisLine</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
 
<span class="c1"># label the axes</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;PC3&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PCA on the Titanic data set&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">X_train</span> <span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span> <span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Training Accuracy: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))))</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Accuracy: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;_&#39;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Apply PCA:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">AccPca</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Components&#39;</span><span class="p">,</span> <span class="s1">&#39;Var_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;Train_Acc&#39;</span><span class="p">,</span> <span class="s1">&#39;Test_Acc&#39;</span><span class="p">])</span>

<span class="k">for</span> <span class="n">componets</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">variance_ratio</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pca_all</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[:</span><span class="n">componets</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
    <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">componets</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">whiten</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">X_train_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">Components</span> <span class="o">=</span> <span class="n">X_train_pca</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
    <span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_pca</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">Training_Accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_pca</span><span class="p">))</span>
    <span class="n">X_test_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_pca</span><span class="p">)</span>
    <span class="n">Test_Accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">AccPca</span> <span class="o">=</span> <span class="n">AccPca</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="n">Components</span><span class="p">,</span> <span class="n">variance_ratio</span><span class="p">,</span> <span class="n">Training_Accuracy</span><span class="p">,</span> <span class="n">Test_Accuracy</span><span class="p">)],</span>
                                        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Components&#39;</span><span class="p">,</span> <span class="s1">&#39;Var_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;Train_Acc&#39;</span><span class="p">,</span> <span class="s1">&#39;Test_Acc&#39;</span><span class="p">]))</span><span class="c1">#], axis=0)</span>

<span class="n">AccPca</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Components&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">AccPca</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Test_Acc&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_159_0.png"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>LR Training Accuracy: 84.27%
LR Accuracy: 81.72%
________________________________________

Apply PCA:

</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Var_ratio</th>
      <th>Train_Acc</th>
      <th>Test_Acc</th>
    </tr>
    <tr>
      <th>Components</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>22</th>
      <td>99.999974</td>
      <td>0.812199</td>
      <td>0.832090</td>
    </tr>
    <tr>
      <th>25</th>
      <td>99.999985</td>
      <td>0.813804</td>
      <td>0.824627</td>
    </tr>
    <tr>
      <th>23</th>
      <td>99.999978</td>
      <td>0.815409</td>
      <td>0.824627</td>
    </tr>
    <tr>
      <th>24</th>
      <td>99.999982</td>
      <td>0.813804</td>
      <td>0.820896</td>
    </tr>
    <tr>
      <th>18</th>
      <td>99.999953</td>
      <td>0.810594</td>
      <td>0.820896</td>
    </tr>
    <tr>
      <th>31</th>
      <td>99.999995</td>
      <td>0.839486</td>
      <td>0.817164</td>
    </tr>
    <tr>
      <th>28</th>
      <td>99.999991</td>
      <td>0.844302</td>
      <td>0.817164</td>
    </tr>
    <tr>
      <th>19</th>
      <td>99.999959</td>
      <td>0.813804</td>
      <td>0.817164</td>
    </tr>
    <tr>
      <th>17</th>
      <td>99.999947</td>
      <td>0.799358</td>
      <td>0.813433</td>
    </tr>
    <tr>
      <th>16</th>
      <td>99.999937</td>
      <td>0.794543</td>
      <td>0.813433</td>
    </tr>
    <tr>
      <th>30</th>
      <td>99.999994</td>
      <td>0.841091</td>
      <td>0.813433</td>
    </tr>
    <tr>
      <th>29</th>
      <td>99.999993</td>
      <td>0.841091</td>
      <td>0.813433</td>
    </tr>
    <tr>
      <th>21</th>
      <td>99.999970</td>
      <td>0.810594</td>
      <td>0.813433</td>
    </tr>
    <tr>
      <th>20</th>
      <td>99.999965</td>
      <td>0.813804</td>
      <td>0.813433</td>
    </tr>
    <tr>
      <th>53</th>
      <td>100.000000</td>
      <td>0.861958</td>
      <td>0.809701</td>
    </tr>
    <tr>
      <th>36</th>
      <td>99.999997</td>
      <td>0.841091</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>48</th>
      <td>99.999999</td>
      <td>0.861958</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>52</th>
      <td>100.000000</td>
      <td>0.861958</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>51</th>
      <td>100.000000</td>
      <td>0.861958</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>50</th>
      <td>100.000000</td>
      <td>0.861958</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>49</th>
      <td>99.999999</td>
      <td>0.861958</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>34</th>
      <td>99.999997</td>
      <td>0.841091</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>35</th>
      <td>99.999997</td>
      <td>0.844302</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>47</th>
      <td>99.999999</td>
      <td>0.861958</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>33</th>
      <td>99.999996</td>
      <td>0.842697</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>11</th>
      <td>99.999852</td>
      <td>0.781701</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>37</th>
      <td>99.999997</td>
      <td>0.842697</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>14</th>
      <td>99.999913</td>
      <td>0.796148</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>32</th>
      <td>99.999996</td>
      <td>0.844302</td>
      <td>0.805970</td>
    </tr>
    <tr>
      <th>46</th>
      <td>99.999999</td>
      <td>0.861958</td>
      <td>0.802239</td>
    </tr>
    <tr>
      <th>45</th>
      <td>99.999999</td>
      <td>0.861958</td>
      <td>0.802239</td>
    </tr>
    <tr>
      <th>44</th>
      <td>99.999999</td>
      <td>0.861958</td>
      <td>0.802239</td>
    </tr>
    <tr>
      <th>27</th>
      <td>99.999990</td>
      <td>0.823435</td>
      <td>0.798507</td>
    </tr>
    <tr>
      <th>26</th>
      <td>99.999988</td>
      <td>0.826645</td>
      <td>0.798507</td>
    </tr>
    <tr>
      <th>15</th>
      <td>99.999926</td>
      <td>0.797753</td>
      <td>0.798507</td>
    </tr>
    <tr>
      <th>13</th>
      <td>99.999896</td>
      <td>0.794543</td>
      <td>0.798507</td>
    </tr>
    <tr>
      <th>38</th>
      <td>99.999998</td>
      <td>0.849117</td>
      <td>0.794776</td>
    </tr>
    <tr>
      <th>43</th>
      <td>99.999998</td>
      <td>0.855538</td>
      <td>0.794776</td>
    </tr>
    <tr>
      <th>41</th>
      <td>99.999998</td>
      <td>0.847512</td>
      <td>0.791045</td>
    </tr>
    <tr>
      <th>42</th>
      <td>99.999998</td>
      <td>0.847512</td>
      <td>0.791045</td>
    </tr>
    <tr>
      <th>39</th>
      <td>99.999998</td>
      <td>0.841091</td>
      <td>0.787313</td>
    </tr>
    <tr>
      <th>40</th>
      <td>99.999998</td>
      <td>0.837881</td>
      <td>0.787313</td>
    </tr>
    <tr>
      <th>12</th>
      <td>99.999875</td>
      <td>0.783307</td>
      <td>0.783582</td>
    </tr>
    <tr>
      <th>2</th>
      <td>99.992725</td>
      <td>0.654896</td>
      <td>0.746269</td>
    </tr>
    <tr>
      <th>4</th>
      <td>99.998387</td>
      <td>0.683788</td>
      <td>0.731343</td>
    </tr>
    <tr>
      <th>9</th>
      <td>99.999792</td>
      <td>0.703050</td>
      <td>0.723881</td>
    </tr>
    <tr>
      <th>5</th>
      <td>99.999328</td>
      <td>0.658106</td>
      <td>0.720149</td>
    </tr>
    <tr>
      <th>10</th>
      <td>99.999824</td>
      <td>0.720706</td>
      <td>0.708955</td>
    </tr>
    <tr>
      <th>1</th>
      <td>99.978042</td>
      <td>0.672552</td>
      <td>0.708955</td>
    </tr>
    <tr>
      <th>6</th>
      <td>99.999525</td>
      <td>0.701445</td>
      <td>0.705224</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99.996828</td>
      <td>0.677368</td>
      <td>0.705224</td>
    </tr>
    <tr>
      <th>8</th>
      <td>99.999747</td>
      <td>0.691814</td>
      <td>0.690299</td>
    </tr>
    <tr>
      <th>7</th>
      <td>99.999643</td>
      <td>0.688604</td>
      <td>0.690299</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In that case, although we can see some separation in planes, you can see that we lose too much information if we consider only the 3 first PCAs, and we can get the best test accuracy from 22 components.</p>
<h4 id="Linear-Discriminant-Analysis-(LDA)">Linear Discriminant Analysis (LDA)<a class="anchor-link" href="#Linear-Discriminant-Analysis-(LDA)">&#182;</a></h4><p>As a supervised dimensionality reduction technique for maximizing class separability. LDA can be used as a technique for feature extraction to increase the computational efficiency and reduce the degree of over-fitting due to the curse of dimensionality in nonregularized models.</p>
<p>So, the goal is to find the feature subspace that optimizes class separability.
<img src="attachment:image.png" alt="image.png">
However, even if one or more of those assumptions are slightly violated, LDA for dimensionality reduction can still work reasonably well.</p>
<p><strong>Some Important Parameters:</strong>
solver : string, optional
    Solver to use, possible values:</p>

<pre><code>  - svd: Singular value decomposition (default).
    Does not compute the covariance matrix, therefore this solver is
    recommended for data with a large number of features.
  - eigen: Eigenvalue decomposition, can be combined with shrinkage.

</code></pre>
<p>shrinkage : string or float, optional
    Shrinkage parameter, possible values:</p>

<pre><code>  - None: no shrinkage (default).
  - auto: automatic shrinkage using the Ledoit-Wolf lemma.
  - float between 0 and 1: fixed shrinkage parameter.

Note that shrinkage works only with 'lsqr' and 'eigen' solvers.</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[80]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span> <span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span> <span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Training Accuracy: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))))</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Accuracy: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;_&#39;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Apply LDA:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">lda</span> <span class="o">=</span> <span class="n">LDA</span><span class="p">(</span><span class="n">store_covariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train_lda</span> <span class="o">=</span> <span class="n">lda</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="c1">#X_train_lda = pd.DataFrame(X_train_lda)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of features after LDA:&#39;</span><span class="p">,</span><span class="n">X_train_lda</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_lda</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Training Accuracy With LDA: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_lda</span><span class="p">))))</span>
<span class="n">X_test_lda</span> <span class="o">=</span> <span class="n">lda</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_lda</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Test Accuracy With LDA: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train_lda</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train_lda</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span><span class="mi">1</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train_lda</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train_lda</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span><span class="mi">1</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;LDA on Training Data Set&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;LDA&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_test_lda</span><span class="p">[</span><span class="n">y_test</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_test_lda</span><span class="p">[</span><span class="n">y_test</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span><span class="mi">1</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_test_lda</span><span class="p">[</span><span class="n">y_test</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_test_lda</span><span class="p">[</span><span class="n">y_test</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span><span class="mi">1</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;LDA on Test Data Set&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;LDA&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>LR Training Accuracy: 84.27%
LR Accuracy: 81.72%
________________________________________

Apply LDA:

Number of features after LDA: 1
LR Training Accuracy With LDA: 85.55%
LR Test Accuracy With LDA: 80.60%
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_161_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can saw, we have better accuracy on training after LDA, but with overfitting, sure without cross validation.</p>
<p>If I don't consider the surnames below to 0.06 of correlation with survived, we can get basically the same results after LDA, with lose only 0.48% at training and 0.38% at test, but reduce the difference in 0.10%.</p>
<p>The LDA returns a total of components equal to the number of class minus 1, or less if you define the n_components less than the number of classes. Since our case is binary classification, we only have one column after applying the LDA.</p>
<p>For we can have another visualization, a small trick to having two componets as a return is to fit some rows to X with a not common in their training observations, in theat case with -0.1 for example, and the same number of rows with -1 to y. Let's see it:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[81]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span> <span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span> <span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)))</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">))),</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Artficial training </span><span class="si">%d</span><span class="s1"> observations&#39;</span> <span class="o">%</span> <span class="n">X_train</span><span class="o">.</span><span class="n">Age</span><span class="p">[</span><span class="n">y</span><span class="o">==-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Training Accuracy: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))))</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Accuracy: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;_&#39;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Apply LDA:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">lda</span> <span class="o">=</span> <span class="n">LDA</span><span class="p">(</span><span class="n">store_covariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train_lda</span> <span class="o">=</span> <span class="n">lda</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of features after LDA:&#39;</span><span class="p">,</span><span class="n">X_train_lda</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number test observations predit as -1:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test_lda</span><span class="p">[</span><span class="n">y_test</span><span class="o">==-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_lda</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Training Accuracy With LDA: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_lda</span><span class="p">))))</span>
<span class="n">X_test_lda</span> <span class="o">=</span> <span class="n">lda</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_lda</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Test Accuracy With LDA: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_train_lda</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">X_train_lda</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_train_lda</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">X_train_lda</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;LDA on Training Data Set&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;LDA 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;LDA 2&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_test_lda</span><span class="p">[</span><span class="n">y_test</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">X_test_lda</span><span class="p">[</span><span class="n">y_test</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_test_lda</span><span class="p">[</span><span class="n">y_test</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">X_test_lda</span><span class="p">[</span><span class="n">y_test</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;LDA on Test Data Set&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;LDA 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;LDA 2&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Artficial training 20 observations
LR Training Accuracy: 85.07%
LR Accuracy: 81.72%
________________________________________

Apply LDA:

Number of features after LDA: 2
Number test observations predit as -1: 0
LR Training Accuracy With LDA: 85.69%
LR Test Accuracy With LDA: 80.60%
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_163_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Nonlinear-dimensionality-reduction-via-kernel-principal-component-analysis">Nonlinear dimensionality reduction via kernel principal component analysis<a class="anchor-link" href="#Nonlinear-dimensionality-reduction-via-kernel-principal-component-analysis">&#182;</a></h4><p>Many machine learning algorithms make assumptions about the linear separability of the input data. If we are dealing with nonlinear problems, which is more common in real cases, linear transformation techniques for dimensionality reduction like PCA and LDA, may not be the best choice. Using kernel PCA to transform nonlinear data onto a new, lower-dimensional subspace that is suitable for linear classifiers.</p>
<p>In what way, with <strong><em>kernel PCA</em></strong> we perform a <strong>nonlinear mapping</strong> that transforms the data onto a <strong>higher-dimensional space</strong> and use <strong>standard PCA</strong> in this higher-dimensional space to <strong>project</strong> the data <strong>back onto a lower-dimensional space</strong> where the samples can be separated by a linear classifier. However, one downside of this approach is that it is <strong><em>computationally very expensive</em></strong>.</p>
<p>Using the <strong><em>kernel trick</em></strong>, we can compute the similarity between two high-dimension feature vectors in the original feature space. In other words, what we obtain after kernel PCA are the samples already projected onto the respective components.</p>
<p>The most commonly used kernels</p>
<ul>
<li>The polynomial kernel.</li>
<li>The hyperbolic tangent (sigmoid) kernel.</li>
<li>The Radial Basis Function (RBF) or Gaussian kernel.</li>
</ul>
<p>Scikit-learn implements a <strong><a href="http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.KernelPCA.html">kernel PCA</a> class</strong> and also implements <strong><a href="http://scikit-learn.org/stable/modules/manifold.html">manifold</a></strong>, a class with advanced techniques for nonlinear dimensionality reduction.</p>
<p><strong>Some important parameters</strong>:</p>
<ul>
<li><p>n_components : int, default=None. Number of components. If None, all non-zero components are kept.</p>
</li>
<li><p>eigen_solver : string ['auto'|'dense'|'arpack'], default='auto'&lt;/p&gt;
  Select eigensolver to use. If n_components is much less than the number of training samples, arpack may be more efficient than the dense eigensolver.</p>
</li>
<li><p>kernel : "linear" | "poly" | "rbf" | "sigmoid" | "cosine" | "precomputed". Kernel. Default="linear".</p>
</li>
<li><p>gamma : float, default=1/n_features. Kernel coefficient for rbf, poly and sigmoid kernels. Ignored by other kernels.</p>
</li>
<li><p>degree : int, default=3. Degree for poly kernels. Ignored by other kernels.</p>
</li>
<li><p>coef0 : float, default=1. Independent term in poly and sigmoid kernels. Ignored by other kernels.</p>
</li>
</ul>
<p>Let's start and see if kernel PCA can help with our data:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[82]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_components</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span> 
<span class="n">degree</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">kpca</span> <span class="o">=</span> <span class="n">KernelPCA</span><span class="p">(</span><span class="n">n_components</span> <span class="o">=</span> <span class="n">n_components</span><span class="p">,</span> <span class="n">degree</span> <span class="o">=</span> <span class="n">degree</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">101</span><span class="p">,</span> <span class="c1">#gamma = gamma,</span>
                <span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">eigen_solver</span><span class="o">=</span><span class="s1">&#39;arpack&#39;</span><span class="p">)</span>
<span class="n">X_kpca</span> <span class="o">=</span> <span class="n">kpca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Plot first two KPCA components</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span>  <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">X_kpca</span><span class="p">[</span><span class="n">y_train</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">X_kpca</span><span class="p">[</span><span class="n">y_train</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">X_kpca</span><span class="p">[</span><span class="n">y_train</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">X_kpca</span><span class="p">[</span><span class="n">y_train</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;KPCA_0&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;KPCA_1&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Plot of first 2 KPCA Components on the Titanic data set&quot;</span><span class="p">)</span>

<span class="n">my_color</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>

<span class="c1"># Store results of PCA in a data frame</span>
<span class="n">result</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_kpca</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;KPCA</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_components</span><span class="p">)],</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Plot initialisation</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;KPCA0&#39;</span><span class="p">],</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;KPCA1&#39;</span><span class="p">],</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;KPCA2&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">my_color</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Set2_r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
 
<span class="c1"># make simple, bare axis lines through space:</span>
<span class="n">xAxisLine</span> <span class="o">=</span> <span class="p">((</span><span class="nb">min</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;KPCA0&#39;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;KPCA0&#39;</span><span class="p">])),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xAxisLine</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xAxisLine</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xAxisLine</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">yAxisLine</span> <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;KPCA1&#39;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;KPCA1&#39;</span><span class="p">])),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yAxisLine</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yAxisLine</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">yAxisLine</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">zAxisLine</span> <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;KPCA2&#39;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;KPCA2&#39;</span><span class="p">])))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">zAxisLine</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zAxisLine</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zAxisLine</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
 
<span class="c1"># label the axes</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;KPCA_0&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;KPCA_1&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;KPCA_2&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;KPCA of 3 Components on the Titanic data set&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">X_train</span> <span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span> <span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Logistic Regression over data without transformation:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">*</span> <span class="mi">53</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Training Accuracy: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))))</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Test Accuracy: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)))</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Apply KPCA:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">*</span> <span class="mi">53</span><span class="p">)</span>
<span class="n">kpca</span> <span class="o">=</span> <span class="n">KernelPCA</span><span class="p">(</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">101</span><span class="p">,</span> <span class="n">degree</span> <span class="o">=</span> <span class="n">degree</span><span class="p">,</span> <span class="n">eigen_solver</span><span class="o">=</span><span class="s1">&#39;arpack&#39;</span><span class="p">,</span> <span class="n">n_components</span> <span class="o">=</span> <span class="mi">23</span><span class="p">)</span>
<span class="n">X_train_kpca</span> <span class="o">=</span> <span class="n">kpca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of features after KPCA:&#39;</span><span class="p">,</span> <span class="n">X_train_kpca</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Training Accuracy: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_kpca</span><span class="p">))))</span>
<span class="n">X_test_kpca</span> <span class="o">=</span> <span class="n">kpca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_kpca</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LR Test Accuracy: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_165_0.png"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Logistic Regression over data without transformation:
_____________________________________________________

LR Training Accuracy: 84.27%
LR Test Accuracy: 81.72%

Apply KPCA:
_____________________________________________________
Number of features after KPCA: 23
LR Training Accuracy: 81.06%
LR Test Accuracy: 83.21%
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although the algorithm is admittedly exhaustive, as we have few data it runs very well, even using a single core.</p>
<p>So, instead of proceeding with a hyper parameterization via grid search, I chose to run manually with some variations to see the graphs and results on acuricity. I leave the best result I got, but if you want you can proceed with play it and check for yourself.</p>
<p>My conclusions are:</p>
<ul>
<li>The liner solver not exceeding PCA and we don't see a great difference in accuracy, if we deffine the number of features to 23, and get the same with 45.</li>
<li>The poly solver degenerate our accuracy.</li>
<li>With rbf solver we have overfitting.</li>
<li>With sigmoid or cosine the accuracy is the worst.</li>
</ul>
<p>So applying nonlinear transformations to all of these data may not be the best, and it's important checked it against your model's performance. Also, as you may notice these transformations are subject to hyperparametrization, then, you should not ignore this if your case is computationally costs</p>
<h3 id="Feature-Selection-into-the-Pipeline">Feature Selection into the Pipeline<a class="anchor-link" href="#Feature-Selection-into-the-Pipeline">&#182;</a></h3><p>Since we have a very different selection of features selection methods, from the results it may be interesting keeping only the removal of collinear, multicolinear and most of one-hot encode results from surnames, and apply PCA around 22 or LDA to linear models, and we can still improve the results through hyperparameterization and cross-validation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">select_fetaures</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="c1"># BaseEstimator, TransformerMixin, </span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select_cols</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_cols_</span> <span class="o">=</span> <span class="n">select_cols</span>
    
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recive </span><span class="si">{0:2d}</span><span class="s1"> features...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Select </span><span class="si">{0:2d}</span><span class="s1"> features&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_cols_</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_cols_</span><span class="p">]</span>    

    <span class="k">def</span> <span class="nf">fit_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span> 
        <span class="c1">#X.loc[:, self.select_cols_]    </span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Test_ID</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">PassengerId</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">cols</span><span class="p">)]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">cols</span><span class="p">)]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Modeling---Hiperparametrization">Modeling - Hiperparametrization<a class="anchor-link" href="#Modeling---Hiperparametrization">&#182;</a></h2><p>First, we strat to looking at different approaches to implement classifiers models, and use hiperparametrization, cross validattion and compare the results between diferents erros measures.</p>
<p>The standard error of the coefficient (std err) indicates the precision of the coefficient estimates. Smaller values represent more reliable estimates.</p>
<p>When you run two models to chek the effects of multicollinearity, ever compare the Summary of Model statistics between the two models and youll notice that Pseudo R-squ. and the others are all identical, if the effects is None or minimal. In that case multicollinearity doesnt affect how well the model fits. In fact, if you want to use the model to make predictions, both models produce identical results for fitted values and prediction intervals!</p>
<h3 id="Simplify-Get-Results">Simplify Get Results<a class="anchor-link" href="#Simplify-Get-Results">&#182;</a></h3><p>Let's build a function to standardize the capture and exposure of the results of our models.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[85]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">,</span> <span class="n">reasume</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="n">modelo</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Best Accuracy: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">best</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span>
    <span class="n">param_grid</span> <span class="o">=</span> <span class="n">best</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">meu</span><span class="o">.</span><span class="n">display_model_performance_metrics</span><span class="p">(</span><span class="n">true_labels</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">predicted_labels</span><span class="o">=</span><span class="n">y_pred</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">              ROC AUC Score: </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_score</span><span class="o">=</span><span class="n">y_pred</span><span class="p">)))</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">param_grid</span><span class="p">,</span> <span class="s1">&#39;predict_proba&#39;</span><span class="p">):</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">score_roc</span> <span class="o">=</span> <span class="n">prob</span><span class="p">[:,</span> <span class="n">prob</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
            <span class="n">prob</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">param_grid</span><span class="p">,</span> <span class="s1">&#39;decision_function&#39;</span><span class="p">):</span>
            <span class="n">score_roc</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Estimator doesn&#39;t have a probability or confidence scoring system!&quot;</span><span class="p">)</span>
    <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_score</span><span class="o">=</span><span class="n">score_roc</span><span class="p">)</span>
    <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Receiver Operating Characteristic (ROC) Curve&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;AUC = </span><span class="si">{:2.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">r1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="n">prob</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span> 
                         <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_score</span><span class="o">=</span><span class="n">y_pred</span><span class="p">),</span> <span class="n">roc_auc</span><span class="p">)],</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">],</span>
                         <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Prob&#39;</span><span class="p">,</span> <span class="s1">&#39;CV Accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;Acc All&#39;</span><span class="p">,</span> <span class="s1">&#39;ROC AUC Score&#39;</span><span class="p">,</span> <span class="s1">&#39;ROC Area&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">reasume</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">r1</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">name</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>        
        <span class="n">results</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">name</span><span class="p">],</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">r1</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">results</span><span class="p">,</span> <span class="n">modelo</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Logistic-Regression"><a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html">Logistic Regression</a><a class="anchor-link" href="#Logistic-Regression">&#182;</a></h3><p>This class implements regularized logistic regression using the 'liblinear' library, 'newton-cg', 'sag' and 'lbfgs' solvers. It can handle both dense and sparse input.</p>
<p><strong>Adtional Parameters</strong></p>
<ul>
<li><p>class_weight : dict or 'balanced', default: None
The "balanced" mode uses the values of y to automatically adjust weights inversely proportional to class frequencies in the input data as <code>n_samples / (n_classes * np.bincount(y))</code>.</p>
<p>For how class_weight works: It penalizes mistakes in samples of class[i] with class_weight[i] instead of 1. So higher class-weight means you want to put more emphasis on a class. For example, our class 0 is 1.24 times more frequent than class 1. So you should increase the class_weight of class 1 relative to class 0, say {1: 0.6, 0: 0.4}. If the class_weight doesn't sum to 1, it will basically change the regularization parameter.</p>
<p>"balanced" basically means replicating the smaller class until you have as many samples as in the larger one, but in an implicit way.</p>
</li>
</ul>
<ul>
<li>warm_start : bool, default: False. Useless for liblinear solver.</li>
<li><code>'clf__multi_class' : ['ovr', 'multinomial']</code> for <code>'clf__solver': ['newton-cg', 'sag', 'lbfgs']</code></li>
</ul>
<p><strong>Attributes:</strong></p>
<ul>
<li>coef_ : array, shape (1, n_features) or (n_classes, n_features)</li>
<li>intercept_ : array, shape (1,) or (n_classes,)</li>
<li>n<em>iter</em> : array, shape (n_classes,) or (1, )</li>
</ul>
<p><strong>See also:</strong></p>
<ul>
<li>SGDClassifier : incrementally trained logistic regression (when given the parameter <code>loss="log"</code>).</li>
<li><p>sklearn.svm.LinearSVC : learns SVM models using the same algorithm.</p>
<p>See the best results below, wheres get with PCA 21 but take more time then LDA.</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[86]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="c1">#(&#39;pca&#39;, PCA(random_state = 101)),</span>
        <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">))])</span>  

<span class="c1"># a list of dictionaries to specify the parameters that we&#39;d want to tune</span>
<span class="n">n_components</span><span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">54</span><span class="p">]</span>
<span class="n">whiten</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">C</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.007</span><span class="p">,</span> <span class="mf">0.009</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span><span class="c1">#, 0.1, 1.0, 10.0, 100.0, 1000.0]</span>
<span class="n">tol</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">]</span> <span class="c1"># [1e-06, 5e-07, 1e-05, 1e-04, 1e-03, 1e-02, 1e-01]</span>

<span class="n">param_grid</span> <span class="o">=</span>\
    <span class="p">[{</span><span class="s1">&#39;clf__C&#39;</span><span class="p">:</span> <span class="n">C</span>
     <span class="p">,</span><span class="s1">&#39;clf__solver&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="s1">&#39;saga&#39;</span><span class="p">]</span> 
     <span class="p">,</span><span class="s1">&#39;clf__penalty&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="s1">&#39;l2&#39;</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__tol&#39;</span> <span class="p">:</span> <span class="n">tol</span> 
     <span class="p">,</span><span class="s1">&#39;clf__class_weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;balanced&#39;</span><span class="p">]</span>
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
<span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;clf__C&#39;</span><span class="p">:</span> <span class="n">C</span>
     <span class="p">,</span><span class="s1">&#39;clf__max_iter&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__solver&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;newton-cg&#39;</span><span class="p">,</span> <span class="s1">&#39;sag&#39;</span><span class="p">,</span> <span class="s1">&#39;lbfgs&#39;</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__penalty&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l2&#39;</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__tol&#39;</span> <span class="p">:</span> <span class="n">tol</span> 
     <span class="p">,</span><span class="s1">&#39;clf__class_weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;balanced&#39;</span><span class="p">]</span> 
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
<span class="p">}]</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">main_pip</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">,</span> <span class="n">select_fetaures</span><span class="p">(</span><span class="n">select_cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">shadow</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;scl&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;lda&#39;</span><span class="p">,</span> <span class="n">LDA</span><span class="p">(</span><span class="n">store_covariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
        <span class="p">(</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>
 <span class="p">])</span>  


<span class="n">results</span><span class="p">,</span> <span class="n">lr</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">main_pip</span><span class="p">,</span> <span class="s1">&#39;LogisticRegression&#39;</span><span class="p">,</span> <span class="n">reasume</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recive 54 features...
Select 22 features
Fitting 5 folds for each of 304 candidates, totalling 1520 fits
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=3)]: Done 785 tasks      | elapsed:    4.1s
[Parallel(n_jobs=3)]: Done 1520 out of 1520 | elapsed:    5.9s finished
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Best Accuracy: 82.27%
{&#39;clf__C&#39;: 0.008, &#39;clf__class_weight&#39;: &#39;balanced&#39;, &#39;clf__max_iter&#39;: 4, &#39;clf__penalty&#39;: &#39;l2&#39;, &#39;clf__solver&#39;: &#39;sag&#39;, &#39;clf__tol&#39;: 0.001} 

Select 22 features
Model Performance metrics:
------------------------------
Accuracy:  82.83% 
Precision: 82.72% 
Recall:    82.83% 
F1 Score:  82.74% 

Model Classification report:
------------------------------
             precision    recall  f1-score   support

          1       0.79      0.75      0.77       342
          0       0.85      0.88      0.86       549

avg / total       0.83      0.83      0.83       891


Prediction Confusion Matrix:
------------------------------
          Predicted:     
                   1    0
Actual: 1        257   85
        0         68  481


              ROC AUC Score: 81.38%
Select 22 features
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_172_3.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="SGDClassifier"><a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html#sklearn.linear_model.SGDClassifier">SGDClassifier</a><a class="anchor-link" href="#SGDClassifier">&#182;</a></h3><p>This estimator implements regularized linear models with stochastic gradient descent (SGD) learning: the gradient of the loss is estimated each sample at a time and the model is updated along the way with a decreasing strength schedule (aka learning rate). SGD allows minibatch (online/out-of-core) learning, see the partial_fit method. For best results using the default learning rate schedule, the data should have zero mean and unit variance.</p>
<p>This implementation works with data represented as dense or sparse arrays of floating point values for the features. The model it fits can be controlled with the loss parameter; by default, it fits a linear support vector machine (SVM).</p>
<p>The regularizer is a penalty added to the loss function that shrinks model parameters towards the zero vector using either the squared euclidean norm L2 or the absolute norm L1 or a combination of both (Elastic Net). If the parameter update crosses the 0.0 value because of the regularizer, the update is truncated to 0.0 to allow for learning sparse models and achieve online feature selection.</p>
<p><strong>Parameters:</strong></p>
<p><strong><em>loss:</em></strong></p>
<ul>
<li>Classifier: hinge, log, modified_huber, squared_hinge, perceptron<ul>
<li>Defaults to hinge, which gives a linear SVM. </li>
<li>The log loss gives logistic regression, a probabilistic classifier. </li>
<li>modified_huber is another smooth loss that brings tolerance to outliers as well as probability estimates. </li>
<li>squared_hinge is like hinge but is quadratically penalized. </li>
<li>perceptron is the linear loss used by the perceptron algorithm. </li>
</ul>
</li>
<li>regression: squared_loss, huber, epsilon_insensitive, squared_epsilon_insensitive</li>
</ul>
<p><strong><em>penalty</em></strong>: The penalty (aka regularization term) to be used. Defaults to l2 which is the standard regularizer for linear SVM models. l1 and elasticnet might bring sparsity to the model (feature selection) not achievable with l2.</p>
<p><strong><em>alpha</em></strong>: Constant that multiplies the regularization term. Defaults to 0.0001 Also used to compute learning_rate when set to 'optimal'.</p>
<p><strong><em>l1_ratio</em></strong>: The Elastic Net mixing parameter, with 0 &lt;= l1_ratio &lt;= 1. l1_ratio=0 corresponds to L2 penalty, l1_ratio=1 to L1. Defaults to 0.15.</p>
<p><strong><em>tol</em></strong>: The stopping criterion. If it is not None, the iterations will stop when (loss &gt; previous_loss - tol).Defaults to 1e-3 from 0.21.</p>
<p><strong><em>learning_rate</em></strong>:</p>
<ul>
<li>constant: eta = eta0</li>
<li>optimal: eta = 1.0 / (alpha * (t + t0)) [default]</li>
<li>invscaling: eta = eta0 / pow(t, power_t)
where t0 is chosen by a heuristic proposed by Leon Bottou.</li>
</ul>
<p><strong><em>eta0</em></strong>: The initial learning rate for the <strong><em>constant</em></strong> or <strong><em>invscaling</em></strong> schedules. The default value is 0.0 as eta0 is not used by the default schedule optimal.</p>
<p><strong><em>power_t</em></strong>: The exponent for inverse scaling learning rate [default 0.5].</p>
<p><strong><em>class_weight</em></strong>: dict, {class_label: weight} or balanced or None, optional</p>
<ul>
<li>The balanced mode uses the values of y to automatically adjust weights inversely proportional to class frequencies in the input data as n_samples / (n_classes * np.bincount(y))</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[87]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="c1">#(&#39;pca&#39;, PCA(random_state = 101)),</span>
        <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">SGDClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">))])</span>

<span class="c1"># a list of dictionaries to specify the parameters that we&#39;d want to tune</span>
<span class="n">n_components</span><span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">whiten</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4e-03</span><span class="p">,</span> <span class="mf">5e-03</span><span class="p">,</span> <span class="mf">6e-03</span><span class="p">,</span> <span class="mf">1e-03</span><span class="p">]</span>
<span class="n">tol</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-08</span><span class="p">,</span> <span class="mf">1e-07</span><span class="p">,</span> <span class="mf">5e-09</span><span class="p">]</span>

<span class="n">param_grid</span> <span class="o">=</span>\
    <span class="p">[{</span><span class="s1">&#39;clf__loss&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;hinge&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;modified_huber&#39;</span><span class="p">,</span> <span class="s1">&#39;squared_hinge&#39;</span><span class="p">,</span> <span class="s1">&#39;perceptron&#39;</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__tol&#39;</span><span class="p">:</span> <span class="n">tol</span>
     <span class="p">,</span><span class="s1">&#39;clf__alpha&#39;</span><span class="p">:</span> <span class="n">alpha</span>
     <span class="p">,</span><span class="s1">&#39;clf__penalty&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="s1">&#39;l1&#39;</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__class_weight&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;balanced&#39;</span><span class="p">]</span> 
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
     <span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;clf__loss&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;hinge&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;modified_huber&#39;</span><span class="p">,</span> <span class="s1">&#39;squared_hinge&#39;</span><span class="p">,</span> <span class="s1">&#39;perceptron&#39;</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__tol&#39;</span><span class="p">:</span> <span class="n">tol</span>
     <span class="p">,</span><span class="s1">&#39;clf__alpha&#39;</span><span class="p">:</span> <span class="n">alpha</span>
     <span class="p">,</span><span class="s1">&#39;clf__penalty&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;elasticnet&#39;</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__l1_ratio&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__class_weight&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;balanced&#39;</span><span class="p">]</span> 
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
     <span class="p">}]</span>


<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">main_pip</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">,</span> <span class="n">select_fetaures</span><span class="p">(</span><span class="n">select_cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;scl&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;lda&#39;</span><span class="p">,</span> <span class="n">LDA</span><span class="p">(</span><span class="n">store_covariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
        <span class="p">(</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>
 <span class="p">])</span>  

<span class="n">results</span><span class="p">,</span> <span class="n">svm</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">main_pip</span><span class="p">,</span> <span class="s1">&#39;SGDClassifier&#39;</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recive 54 features...
Select 25 features
Fitting 5 folds for each of 300 candidates, totalling 1500 fits
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=3)]: Done 815 tasks      | elapsed:    3.8s
[Parallel(n_jobs=3)]: Done 1500 out of 1500 | elapsed:    4.7s finished
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Best Accuracy: 83.95%
{&#39;clf__alpha&#39;: 0.001, &#39;clf__class_weight&#39;: &#39;balanced&#39;, &#39;clf__l1_ratio&#39;: 0.5, &#39;clf__loss&#39;: &#39;hinge&#39;, &#39;clf__penalty&#39;: &#39;elasticnet&#39;, &#39;clf__tol&#39;: 1e-08} 

Select 25 features
Model Performance metrics:
------------------------------
Accuracy:  83.05% 
Precision: 83.23% 
Recall:    83.05% 
F1 Score:  83.12% 

Model Classification report:
------------------------------
             precision    recall  f1-score   support

          1       0.77      0.80      0.78       342
          0       0.87      0.85      0.86       549

avg / total       0.83      0.83      0.83       891


Prediction Confusion Matrix:
------------------------------
          Predicted:     
                   1    0
Actual: 1        274   68
        0         83  466


              ROC AUC Score: 82.50%
Select 25 features
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_174_3.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Linear-Support-Vector-Classification"><a href="http://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html#sklearn.svm.LinearSVC">Linear Support Vector Classification</a><a class="anchor-link" href="#Linear-Support-Vector-Classification">&#182;</a></h3><p>Similar to SVC with parameter kernel=linear, but implemented in terms of liblinear rather than libsvm, so it has more flexibility in the choice of penalties and loss functions and should scale better to large numbers of samples.</p>
<p>This class supports both dense and sparse input and the multiclass support is handled according to a one-vs-the-rest scheme.</p>
<p>The combination of penalty='l1' and loss='hinge' is not supported, and penalty='l2' and loss='hinge' needs dual=True.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[88]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="c1">#(&#39;pca&#39;, PCA(random_state = 101)),</span>
        <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">))])</span>

<span class="c1"># a list of dictionaries to specify the parameters that we&#39;d want to tune</span>
<span class="n">n_components</span><span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">54</span><span class="p">]</span>
<span class="n">whiten</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">C</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span> <span class="c1">#, 1.0, 10.0, 100.0, 1000.0]</span>
<span class="n">tol</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-06</span><span class="p">,</span> <span class="mf">3e-06</span><span class="p">,</span> <span class="mf">5e-07</span><span class="p">]</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>

<span class="n">param_grid</span> <span class="o">=</span>\
    <span class="p">[{</span><span class="s1">&#39;clf__loss&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;hinge&#39;</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__tol&#39;</span><span class="p">:</span> <span class="n">tol</span>
     <span class="p">,</span><span class="s1">&#39;clf__C&#39;</span><span class="p">:</span> <span class="n">C</span>
     <span class="p">,</span><span class="s1">&#39;clf__penalty&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l2&#39;</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__class_weight&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;balanced&#39;</span><span class="p">]</span> 
     <span class="p">,</span><span class="s1">&#39;clf__max_iter&#39;</span> <span class="p">:</span> <span class="n">max_iter</span>
     <span class="p">,</span><span class="s1">&#39;clf__dual&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span>
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
     <span class="p">}</span>
    <span class="p">,{</span><span class="s1">&#39;clf__loss&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;squared_hinge&#39;</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__tol&#39;</span><span class="p">:</span> <span class="n">tol</span>
     <span class="p">,</span><span class="s1">&#39;clf__C&#39;</span><span class="p">:</span> <span class="n">C</span>
     <span class="p">,</span><span class="s1">&#39;clf__penalty&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="s1">&#39;l1&#39;</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__class_weight&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;balanced&#39;</span><span class="p">]</span> 
     <span class="p">,</span><span class="s1">&#39;clf__max_iter&#39;</span> <span class="p">:</span> <span class="n">max_iter</span>
     <span class="p">,</span><span class="s1">&#39;clf__dual&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span>
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
     <span class="p">}]</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">main_pip</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">,</span> <span class="n">select_fetaures</span><span class="p">(</span><span class="n">select_cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;scl&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;lda&#39;</span><span class="p">,</span> <span class="n">LDA</span><span class="p">(</span><span class="n">store_covariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
        <span class="p">(</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>
 <span class="p">])</span>  

<span class="n">results</span><span class="p">,</span> <span class="n">lsvc</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">main_pip</span><span class="p">,</span> <span class="s1">&#39;LinearSVC&#39;</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recive 54 features...
Select 25 features
Fitting 5 folds for each of 108 candidates, totalling 540 fits
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=3)]: Done 540 out of 540 | elapsed:    3.1s finished
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Best Accuracy: 82.83%
{&#39;clf__C&#39;: 0.5, &#39;clf__class_weight&#39;: &#39;balanced&#39;, &#39;clf__dual&#39;: False, &#39;clf__loss&#39;: &#39;squared_hinge&#39;, &#39;clf__max_iter&#39;: 9, &#39;clf__penalty&#39;: &#39;l2&#39;, &#39;clf__tol&#39;: 1e-06} 

Select 25 features
Model Performance metrics:
------------------------------
Accuracy:  83.05% 
Precision: 83.23% 
Recall:    83.05% 
F1 Score:  83.12% 

Model Classification report:
------------------------------
             precision    recall  f1-score   support

          1       0.77      0.80      0.78       342
          0       0.87      0.85      0.86       549

avg / total       0.83      0.83      0.83       891


Prediction Confusion Matrix:
------------------------------
          Predicted:     
                   1    0
Actual: 1        274   68
        0         83  466


              ROC AUC Score: 82.50%
Select 25 features
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_176_3.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Gaussian-Process-Classifier-(GPC)"><a href="http://scikit-learn.org/stable/modules/generated/sklearn.gaussian_process.GaussianProcessClassifier.html#sklearn.gaussian_process.GaussianProcessClassifier">Gaussian Process Classifier (GPC)</a><a class="anchor-link" href="#Gaussian-Process-Classifier-(GPC)">&#182;</a></h3><p>Internally, the Laplace approximation is used for approximating the non-Gaussian posterior by a Gaussian.</p>
<p>Currently, the implementation is restricted to using the logistic link function. For multi-class classification, several binary one-versus rest classifiers are fitted. Note that this class thus does not implement a true multi-class Laplace approximation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[89]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="c1">#(&#39;pca&#39;, PCA(random_state = 101)),</span>
        <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">GaussianProcessClassifier</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">RBF</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># n_restarts_optimizer=5</span>
<span class="c1"># a list of dictionaries to specify the parameters that we&#39;d want to tune</span>
<span class="n">n_components</span><span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">54</span><span class="p">]</span>
<span class="n">whiten</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">max_iter_predict</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>

<span class="n">param_grid</span> <span class="o">=</span>\
    <span class="p">[{</span><span class="s1">&#39;clf__max_iter_predict&#39;</span><span class="p">:</span>  <span class="n">max_iter_predict</span>
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
     <span class="p">}]</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">main_pip</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">,</span> <span class="n">select_fetaures</span><span class="p">(</span><span class="n">select_cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">bcols</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;scl&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;lda&#39;</span><span class="p">,</span> <span class="n">LDA</span><span class="p">(</span><span class="n">store_covariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
        <span class="p">(</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>
 <span class="p">])</span>  

<span class="n">results</span><span class="p">,</span> <span class="n">gpc</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">main_pip</span><span class="p">,</span> <span class="s1">&#39;GaussianProcessClassifier&#39;</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recive 54 features...
Select 47 features
Fitting 5 folds for each of 4 candidates, totalling 20 fits
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=3)]: Done  20 out of  20 | elapsed:   48.2s finished
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Best Accuracy: 84.40%
{&#39;clf__max_iter_predict&#39;: 10} 

Select 47 features
Model Performance metrics:
------------------------------
Accuracy:  84.40% 
Precision: 84.32% 
Recall:    84.40% 
F1 Score:  84.22% 

Model Classification report:
------------------------------
             precision    recall  f1-score   support

          1       0.83      0.75      0.79       342
          0       0.85      0.91      0.88       549

avg / total       0.84      0.84      0.84       891


Prediction Confusion Matrix:
------------------------------
          Predicted:     
                   1    0
Actual: 1        255   87
        0         52  497


              ROC AUC Score: 82.54%
Select 47 features
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_178_3.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Random-Forest-Classifier"><a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier">Random Forest Classifier</a><a class="anchor-link" href="#Random-Forest-Classifier">&#182;</a></h3><p>A random forest is a meta estimator that fits a number of decision tree classifiers on various sub-samples of the dataset and use averaging to improve the predictive accuracy and control over-fitting. The sub-sample size is always the same as the original input sample size but the samples are drawn with replacement if bootstrap=True (default).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[90]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="c1">#(&#39;pca&#39;, PCA(random_state = 101)),</span>
        <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">))])</span>

<span class="c1"># a list of dictionaries to specify the parameters that we&#39;d want to tune</span>
<span class="n">n_components</span><span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">54</span><span class="p">]</span>
<span class="n">whiten</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">param_grid</span> <span class="o">=</span>\
    <span class="p">[{</span><span class="s1">&#39;clf__n_estimators&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]</span>
      <span class="p">,</span><span class="s1">&#39;clf__criterion&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="s1">&#39;entropy&#39;</span><span class="p">]</span>
      <span class="p">,</span><span class="s1">&#39;clf__min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
      <span class="p">,</span><span class="s1">&#39;clf__min_impurity_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">]</span>
      <span class="c1">#,&#39;clf__max_depth&#39;: [5, 10]</span>
      <span class="c1">#,&#39;clf__min_impurity_decrease&#39;: [0.0003]</span>
      <span class="c1">#,&#39;clf__min_samples_leaf&#39;: [1,2,3,4]</span>
      <span class="p">,</span><span class="s1">&#39;clf__class_weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;balanced&#39;</span><span class="p">]</span>
      <span class="c1">#,&#39;clf__bootstrap&#39;: [True, False]</span>
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
     <span class="p">}]</span>

<span class="n">sele</span> <span class="o">=</span> <span class="n">bcols</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">main_pip</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">,</span> <span class="n">select_fetaures</span><span class="p">(</span><span class="n">select_cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">sele</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;scl&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>
 <span class="p">])</span>  

<span class="n">results</span><span class="p">,</span> <span class="n">rfc</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">main_pip</span><span class="p">,</span> <span class="s1">&#39;RandomForestClassifier&#39;</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recive 54 features...
Select 47 features
Fitting 5 folds for each of 36 candidates, totalling 180 fits
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=3)]: Done  44 tasks      | elapsed:  1.2min
[Parallel(n_jobs=3)]: Done 180 out of 180 | elapsed:  5.3min finished
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Best Accuracy: 83.84%
{&#39;clf__class_weight&#39;: &#39;balanced&#39;, &#39;clf__criterion&#39;: &#39;gini&#39;, &#39;clf__min_impurity_split&#39;: 0.07, &#39;clf__min_samples_split&#39;: 4, &#39;clf__n_estimators&#39;: 500} 

Select 47 features
Model Performance metrics:
------------------------------
Accuracy:  95.85% 
Precision: 95.84% 
Recall:    95.85% 
F1 Score:  95.84% 

Model Classification report:
------------------------------
             precision    recall  f1-score   support

          1       0.96      0.94      0.95       342
          0       0.96      0.97      0.97       549

avg / total       0.96      0.96      0.96       891


Prediction Confusion Matrix:
------------------------------
          Predicted:     
                   1    0
Actual: 1        320   22
        0         15  534


              ROC AUC Score: 95.42%
Select 47 features
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_180_3.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="AdaBoost-classifier"><a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.AdaBoostClassifier.html#sklearn.ensemble.AdaBoostClassifier">AdaBoost classifier</a><a class="anchor-link" href="#AdaBoost-classifier">&#182;</a></h3><p>Is a meta-estimator that begins by fitting a classifier on the original dataset and then fits additional copies of the classifier on the same dataset but where the weights of incorrectly classified instances are adjusted such that subsequent classifiers focus more on difficult cases.</p>
<p>This class implements the algorithm known as AdaBoost-SAMME.</p>
<p><strong>Parametrs:</strong></p>
<ul>
<li><p><strong><em>n_estimators</em></strong>: The maximum number of estimators at which boosting is terminated. In case of perfect fit, the learning procedure is stopped early.</p>
</li>
<li><p><strong><em>learning_rate</em></strong>: Learning rate shrinks the contribution of each classifier by learning_rate. There is a trade-off between learning_rate and n_estimators.</p>
</li>
<li><p><strong><em>algorithm</em></strong>: {SAMME, SAMME.R}. If SAMME.R then use the SAMME.R real boosting algorithm. base_estimator must support calculation of class probabilities. If SAMME then use the SAMME discrete boosting algorithm. The SAMME.R algorithm typically converges faster than SAMME, achieving a lower test error with fewer boosting iterations.</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[91]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="c1">#(&#39;pca&#39;, PCA(random_state = 101)),</span>
        <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">))])</span>
<span class="c1"># , max_iter_predict=500, n_restarts_optimizer=5</span>

<span class="c1"># a list of dictionaries to specify the parameters that we&#39;d want to tune</span>
<span class="n">n_components</span><span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">54</span><span class="p">]</span>
<span class="n">whiten</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>

<span class="n">param_grid</span> <span class="o">=</span>\
    <span class="p">[{</span><span class="s1">&#39;clf__learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3e-03</span><span class="p">,</span> <span class="mf">15e-02</span><span class="p">,</span> <span class="mf">5e-02</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span> <span class="c1"># np.arange(96,115)</span>
     <span class="p">,</span><span class="s1">&#39;clf__algorithm&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SAMME&#39;</span><span class="p">,</span> <span class="s1">&#39;SAMME.R&#39;</span><span class="p">]</span>
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
     <span class="p">}]</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">main_pip</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">,</span> <span class="n">select_fetaures</span><span class="p">(</span><span class="n">select_cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;scl&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;lda&#39;</span><span class="p">,</span> <span class="n">LDA</span><span class="p">(</span><span class="n">store_covariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
        <span class="p">(</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>
 <span class="p">])</span>  

<span class="n">results</span><span class="p">,</span> <span class="n">AdaB</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">main_pip</span><span class="p">,</span> <span class="s1">&#39;AdaBoostClassifier&#39;</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recive 54 features...
Select 25 features
Fitting 5 folds for each of 24 candidates, totalling 120 fits
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=3)]: Done  44 tasks      | elapsed:   12.3s
[Parallel(n_jobs=3)]: Done 120 out of 120 | elapsed:   33.4s finished
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Best Accuracy: 84.06%
{&#39;clf__algorithm&#39;: &#39;SAMME&#39;, &#39;clf__learning_rate&#39;: 0.003, &#39;clf__n_estimators&#39;: 300} 

Select 25 features
Model Performance metrics:
------------------------------
Accuracy:  84.40% 
Precision: 85.03% 
Recall:    84.40% 
F1 Score:  83.87% 

Model Classification report:
------------------------------
             precision    recall  f1-score   support

          1       0.89      0.68      0.77       342
          0       0.82      0.95      0.88       549

avg / total       0.85      0.84      0.84       891


Prediction Confusion Matrix:
------------------------------
          Predicted:     
                   1    0
Actual: 1        231  111
        0         28  521


              ROC AUC Score: 81.22%
Select 25 features
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_182_3.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="K-Nearest-Neighbors"><a href="http://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html#sklearn.neighbors.KNeighborsClassifier">K-Nearest Neighbors</a><a class="anchor-link" href="#K-Nearest-Neighbors">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[92]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="c1">#(&#39;pca&#39;, PCA(random_state = 101)),</span>
        <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())])</span>

<span class="c1">#max_iter_predict=500, n_restarts_optimizer=5</span>
<span class="c1"># a list of dictionaries to specify the parameters that we&#39;d want to tune</span>
<span class="n">n_components</span><span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">54</span><span class="p">]</span>
<span class="n">whiten</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">param_grid</span> <span class="o">=</span>\
    <span class="p">[{</span><span class="s1">&#39;clf__n_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span> <span class="c1">#</span>
     <span class="p">,</span><span class="s1">&#39;clf__weights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">]</span> 
     <span class="p">,</span><span class="s1">&#39;clf__algorithm&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ball_tree&#39;</span><span class="p">,</span> <span class="s1">&#39;kd_tree&#39;</span><span class="p">]</span> <span class="c1"># [&#39;auto&#39;, &#39;ball_tree&#39;, &#39;kd_tree&#39;, &#39;brute&#39;]</span>
     <span class="p">,</span><span class="s1">&#39;clf__leaf_size&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__p&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> 
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
     <span class="p">}]</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">main_pip</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">,</span> <span class="n">select_fetaures</span><span class="p">(</span><span class="n">select_cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;scl&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;lda&#39;</span><span class="p">,</span> <span class="n">LDA</span><span class="p">(</span><span class="n">store_covariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
        <span class="p">(</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>
 <span class="p">])</span>  

<span class="n">results</span><span class="p">,</span> <span class="n">KNNC</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">main_pip</span><span class="p">,</span> <span class="s1">&#39;KNeighborsClassifier&#39;</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recive 54 features...
Select 25 features
Fitting 5 folds for each of 128 candidates, totalling 640 fits
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=3)]: Done 640 out of 640 | elapsed:    3.4s finished
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Best Accuracy: 82.72%
{&#39;clf__algorithm&#39;: &#39;ball_tree&#39;, &#39;clf__leaf_size&#39;: 12, &#39;clf__n_neighbors&#39;: 9, &#39;clf__p&#39;: 1, &#39;clf__weights&#39;: &#39;uniform&#39;} 

Select 25 features
Model Performance metrics:
------------------------------
Accuracy:  85.19% 
Precision: 85.11% 
Recall:    85.19% 
F1 Score:  85.12% 

Model Classification report:
------------------------------
             precision    recall  f1-score   support

          1       0.82      0.79      0.80       342
          0       0.87      0.89      0.88       549

avg / total       0.85      0.85      0.85       891


Prediction Confusion Matrix:
------------------------------
          Predicted:     
                   1    0
Actual: 1        269   73
        0         59  490


              ROC AUC Score: 83.95%
Select 25 features
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_184_3.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multi-layer-Perceptron-classifier"><a href="http://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier">Multi-layer Perceptron classifier</a><a class="anchor-link" href="#Multi-layer-Perceptron-classifier">&#182;</a></h3><p>This model optimizes the log-loss function using LBFGS or stochastic gradient descent.</p>
<p>MLPClassifier trains iteratively since at each time step the partial derivatives of the loss function with respect to the model parameters are computed to update the parameters.</p>
<p>It can also have a regularization term added to the loss function that shrinks model parameters to prevent overfitting.</p>
<p>This implementation works with data represented as dense numpy arrays or sparse scipy arrays of floating point values.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[93]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="c1">#(&#39;pca&#39;, PCA(random_state = 101)),</span>
        <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">))])</span>

<span class="c1"># a list of dictionaries to specify the parameters that we&#39;d want to tune</span>
<span class="n">n_components</span><span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">54</span><span class="p">]</span>
<span class="n">whiten</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">param_grid</span> <span class="o">=</span>\
    <span class="p">[{</span><span class="c1">#&#39;clf__activation&#39;: [&#39;identity&#39;, &#39;logistic&#39;, &#39;tanh&#39;, &#39;relu&#39;],</span>
      <span class="s1">&#39;clf__solver&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;adam&#39;</span><span class="p">]</span> <span class="c1"># , &#39;lbfgs&#39;, &#39;sgd&#39;</span>
     <span class="p">,</span><span class="s1">&#39;clf__tol&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5e-04</span><span class="p">]</span> <span class="c1">#, 3e-04, 7e-04]</span>
     <span class="c1">#,&#39;clf__max_iter&#39;: [200, 1000]</span>
     <span class="p">,</span><span class="s1">&#39;clf__alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e-06</span><span class="p">]</span> <span class="c1">#, 1e-07, 1e-08] </span>
     <span class="p">,</span><span class="s1">&#39;clf__learning_rate_init&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3e-04</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__hidden_layer_sizes&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="p">)]</span><span class="c1">#, (1024, 512, 256, 128, 64, )]</span>
     <span class="p">,</span><span class="s1">&#39;clf__batch_size&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">64</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__epsilon&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e-08</span><span class="p">]</span> 
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
     <span class="p">},</span>
     <span class="p">{</span><span class="s1">&#39;clf__solver&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sgd&#39;</span><span class="p">]</span> 
     <span class="p">,</span><span class="s1">&#39;clf__tol&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5e-04</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__learning_rate_init&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3e-04</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="s1">&#39;adaptive&#39;</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e-06</span><span class="p">]</span> <span class="c1">#, 1e-07, 1e-08] #, 1e-03, 1e-02, 1e-01]</span>
     <span class="p">,</span><span class="s1">&#39;clf__hidden_layer_sizes&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="p">)]</span><span class="c1">#, (1024, 512, 256, 128, 64, )]</span>
     <span class="p">,</span><span class="s1">&#39;clf__batch_size&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">64</span><span class="p">]</span>
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
    <span class="p">},</span>
     <span class="p">{</span><span class="s1">&#39;clf__solver&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sgd&#39;</span><span class="p">]</span> 
     <span class="p">,</span><span class="s1">&#39;clf__tol&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5e-04</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__learning_rate_init&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3e-04</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;invscaling&#39;</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__power_t&#39;</span> <span class="p">:</span> <span class="p">[</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e-06</span><span class="p">]</span>
     <span class="p">,</span><span class="s1">&#39;clf__hidden_layer_sizes&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="p">)]</span>
     <span class="p">,</span><span class="s1">&#39;clf__batch_size&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">64</span><span class="p">]</span>
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
    <span class="p">}]</span>
    
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">main_pip</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">,</span> <span class="n">select_fetaures</span><span class="p">(</span><span class="n">select_cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cols</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;scl&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;lda&#39;</span><span class="p">,</span> <span class="n">LDA</span><span class="p">(</span><span class="n">store_covariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
        <span class="p">(</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>
 <span class="p">])</span>  

<span class="n">results</span><span class="p">,</span> <span class="n">mlpc</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">main_pip</span><span class="p">,</span> <span class="s1">&#39;MLPClassifier&#39;</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recive 54 features...
Select 54 features
Fitting 5 folds for each of 5 candidates, totalling 25 fits
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=3)]: Done  25 out of  25 | elapsed:  1.7min finished
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Best Accuracy: 84.74%
{&#39;clf__alpha&#39;: 1e-06, &#39;clf__batch_size&#39;: 64, &#39;clf__epsilon&#39;: 1e-08, &#39;clf__hidden_layer_sizes&#39;: (512, 256, 128, 64), &#39;clf__learning_rate_init&#39;: 0.0003, &#39;clf__solver&#39;: &#39;adam&#39;, &#39;clf__tol&#39;: 0.0005} 

Select 54 features
Model Performance metrics:
------------------------------
Accuracy:  84.51% 
Precision: 84.46% 
Recall:    84.51% 
F1 Score:  84.30% 

Model Classification report:
------------------------------
             precision    recall  f1-score   support

          1       0.84      0.74      0.79       342
          0       0.85      0.91      0.88       549

avg / total       0.84      0.85      0.84       891


Prediction Confusion Matrix:
------------------------------
          Predicted:     
                   1    0
Actual: 1        253   89
        0         49  500


              ROC AUC Score: 82.53%
Select 54 features
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_186_3.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Gradient-Boosting-for-Classification"><a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html">Gradient Boosting for Classification</a><a class="anchor-link" href="#Gradient-Boosting-for-Classification">&#182;</a></h3><p>GB builds an additive model in a forward stage-wise fashion; it allows for the optimization of arbitrary differentiable loss functions. In each stage n<em>classes</em> regression trees are fit on the negative gradient of the binomial or multinomial deviance loss function. Binary classification is a special case where only a single regression tree is induced.</p>
<ul>
<li>loss: loss function to be optimized. deviance refers to deviance (= logistic regression) for classification with probabilistic outputs. For loss exponential gradient boosting recovers the AdaBoost algorithm.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[94]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="c1">#(&#39;pca&#39;, PCA(random_state = 101)),</span>
        <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">))])</span>  

<span class="c1"># a list of dictionaries to specify the parameters that we&#39;d want to tune</span>
<span class="c1">#cv=None, dual=False,  scoring=None, refit=True,  multi_class=&#39;ovr&#39;</span>
<span class="n">n_components</span><span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">54</span><span class="p">]</span>
<span class="n">whiten</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">learning_rate</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">1e-02</span><span class="p">]</span> <span class="c1">#, 5e-03, 2e-02]</span>
<span class="n">n_estimators</span><span class="o">=</span> <span class="p">[</span><span class="mi">140</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">145</span><span class="p">]</span>
<span class="n">max_depth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="n">param_grid</span> <span class="o">=</span>\
    <span class="p">[{</span><span class="s1">&#39;clf__learning_rate&#39;</span><span class="p">:</span> <span class="n">learning_rate</span>
     <span class="p">,</span><span class="s1">&#39;clf__max_depth&#39;</span><span class="p">:</span> <span class="n">max_depth</span>
     <span class="p">,</span><span class="s1">&#39;clf__n_estimators&#39;</span> <span class="p">:</span> <span class="n">n_estimators</span> 
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : whiten</span>
<span class="p">}]</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">main_pip</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">,</span> <span class="n">select_fetaures</span><span class="p">(</span><span class="n">select_cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">FRFE</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;scl&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;lda&#39;</span><span class="p">,</span> <span class="n">LDA</span><span class="p">(</span><span class="n">store_covariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
        <span class="p">(</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>
 <span class="p">])</span>  

<span class="n">results</span><span class="p">,</span> <span class="n">GBC</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">main_pip</span><span class="p">,</span> <span class="s1">&#39;GradientBoostingClassifier&#39;</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recive 54 features...
Select 25 features
Fitting 5 folds for each of 12 candidates, totalling 60 fits
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=3)]: Done  44 tasks      | elapsed:    4.1s
[Parallel(n_jobs=3)]: Done  60 out of  60 | elapsed:    5.3s finished
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Best Accuracy: 84.06%
{&#39;clf__learning_rate&#39;: 0.01, &#39;clf__max_depth&#39;: 2, &#39;clf__n_estimators&#39;: 140} 

Select 25 features
Model Performance metrics:
------------------------------
Accuracy:  84.40% 
Precision: 85.03% 
Recall:    84.40% 
F1 Score:  83.87% 

Model Classification report:
------------------------------
             precision    recall  f1-score   support

          1       0.89      0.68      0.77       342
          0       0.82      0.95      0.88       549

avg / total       0.85      0.84      0.84       891


Prediction Confusion Matrix:
------------------------------
          Predicted:     
                   1    0
Actual: 1        231  111
        0         28  521


              ROC AUC Score: 81.22%
Select 25 features
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_188_3.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="XGBoost-(eXtreme-Gradient-Boosting)"><a href="https://xgboost.readthedocs.io/en/latest/">XGBoost (eXtreme Gradient Boosting)</a><a class="anchor-link" href="#XGBoost-(eXtreme-Gradient-Boosting)">&#182;</a></h3><p>XGBoost is an advanced implementation of gradient boosting algorithm. Its a highly sophisticated algorithm, powerful enough to deal with all sorts of irregularities of data.</p>
<ul>
<li>Standard GBM implementation has no <strong>regularization</strong> like XGBoost, therefore it also helps to reduce overfitting.</li>
<li>XGBoost implements <strong>parallel processing</strong> to making a tree using all cores and is blazingly faster as compared to GBM.</li>
<li>XGBoost also supports implementation on Hadoop.</li>
<li><strong>High flexibility</strong>, it allow users to define custom optimization objectives and evaluation criteria.</li>
<li>XGBoost has an <strong>in-built routine to handle missing values</strong>.</li>
<li>It make splits upto the max_depth specified and then start <strong>pruning the tree backwards</strong> and remove splits beyond which there is no positive gain.</li>
<li>Sometimes a split of negative loss say -2 may be followed by a split of positive loss +10. GBM would stop as it encounters -2. But XGBoost will go deeper and it will see a <strong>combined effect</strong> of +8 of the split and keep both.</li>
<li>XGBoost <strong>allows user to run a cross-validation</strong> at each iteration of the boosting process and thus it is easy to get the exact optimum number of boosting iterations in a single run. Ypu dont need use grid search.</li>
<li>User can <strong>start training</strong> an XGBoost model <strong>from</strong> its last iteration of <strong>previous run</strong>. </li>
</ul>
<p>The overall parameters have been divided into 3 categories by XGBoost authors, let's see the most importants:</p>
<ol>
<li>General Parameters: Guide the overall functioning:<ul>
<li><strong>booster</strong>: default is gbtree fom ['gbtree', 'gblinear']
<p><p></li>
</ul>
</li>
<li>Booster Parameters: Guide the individual booster (tree/regression) at each step:<ul>
<li><strong>learning_rate</strong> (eta): default is 0.3. Makes the model more robust by shrinking the weights on each step. Typical final values to be used: 0.01-0.2</li>
<li><strong>min_child_weight</strong>: default is 1. Defines the minimum sum of weights of all observations required in a child. Used to control over-fitting. Higher values prevent aover-fitting, but too high values can lead to under-fitting hence, it should be <strong>tuned</strong> using CV.</li>
<li><strong>max_depth</strong>: default is 6. The maximum depth of a tree used to control over-fitting and should be <strong>tuned</strong> using CV. Typical values: 3-10</li>
<li><strong>max_leaf_nodes</strong>: The maximum number of terminal nodes or leaves in a tree. Can be defined in place of max_depth. Since binary trees are created, a depth of n would produce a maximum of 2^n leaves. If this is defined, GBM will ignore max_depth.</li>
<li><strong>gamma</strong>: default is 0. A node is split only when the resulting split gives a positive reduction in the loss function. Gamma specifies the minimum loss reduction required to make a split. Makes the algorithm conservative. <strong>The values can vary depending on the loss function</strong> and should be <strong>tuned</strong>.</li>
<li><strong>max_delta_step</strong>: default is 0. In maximum delta step we allow each trees weight estimation to be. If the value is set to 0, it means there is no constraint. If it is set to a positive value, it can help making the update step more conservative. Usually this parameter is not needed, but <strong>it might help in logistic regression when class is extremely imbalanced</strong>.</li>
<li><strong>subsample</strong>: default is 1. Denotes the fraction of observations to be randomly samples for each tree. Lower values make the algorithm more conservative and prevents overfitting but too small values might lead to under-fitting. Typical values: 0.5-1</li>
<li><strong>colsample_bytree</strong>: default is 1. Denotes the fraction of columns to be randomly samples for each tree. Typical values: 0.5-1</li>
<li><strong>colsample_bylevel</strong>: default is 1. Denotes the subsample ratio of columns for each split, in each level.</li>
<li><strong>reg_lambda</strong> (lambda): default is 1. L2 regularization term on weights, analogous to Ridge regression, it should be explored to reduce overfitting.</li>
<li><strong>reg_alpha</strong> (alpha): default is 0. L1 regularization term on weight, analogous to Lasso regression, Can be used in case of very high dimensionality so that the algorithm runs faster when implemented.</li>
<li><strong>scale_pos_weight</strong>: default is 1. A value greater than 0 should be used in case of high class imbalance as it helps in faster convergence. <strong>To balance use</strong> <code>sum(negative cases)/sum(positive cases)</code> and Use AUC for evaluation.
<p><p></li>
</ul>
</li>
<li>Learning Task Parameters: These parameters are used to define the optimization objective the metric to be calculated at each step: <ul>
<li><strong>objective</strong>: default is reg:linear and binary:logistic for XGBClassifier. This defines the loss function to be minimized. Mostly used values are: <p><ul>
<li>binary:logistic logistic regression for binary classification, returns predicted probability (not class)</li>
<li>multi:softmax multiclass classification using the softmax objective, returns predicted class (not probabilities). You also need to set an additional num_class (number of classes) parameter defining the number of unique classes</li>
<li>multi:softprob same as softmax, but returns predicted probability of each data point belonging to each class.</li>
</ul>
</li>
<li><strong>eval_metric</strong>: The default values are rmse for regression and error for classification. The metric to be used for validation data. Typical values are: <ul>
<li>rmse  root mean square error</li>
<li>mae  mean absolute error</li>
<li>logloss  negative log-likelihood</li>
<li>error  Binary classification error rate (0.5 threshold)</li>
<li>merror  Multiclass classification error rate</li>
<li>mlogloss  Multiclass logloss</li>
<li>auc: Area under the curve</li>
</ul>
</li>
<li><strong>seed</strong>: The random number seed. Can be used for generating reproducible results and also for parameter tuning.
<p><p></li>
</ul>
</li>
</ol>
<p>Before proceeding further, since cgb don't accept categorical let's change it to boolean or intenger.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[95]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">categorical_change_back</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">categorical_features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">==</span> <span class="s2">&quot;category&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">categorical_features</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="n">trainXGB</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">trainXGB</span> <span class="o">=</span> <span class="n">categorical_change_back</span><span class="p">(</span><span class="n">trainXGB</span><span class="p">)</span>
<span class="n">testXGB</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Survived</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">testXGB</span> <span class="o">=</span> <span class="n">categorical_change_back</span><span class="p">(</span><span class="n">testXGB</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>General Approach for Parameter Tuning</strong>:</p>
<ul>
<li>Choose a relatively high learning rate. Generally a learning rate of 0.1 works but somewhere between 0.05 to 0.3 should work for different problems. Determine the optimum number of trees for this learning rate. XGBoost has a very useful function called as cv which performs cross-validation at each boosting iteration and thus returns the optimum number of trees required.</li>
<li>Tune tree-specific parameters ( max_depth, min_child_weight, gamma, subsample, colsample_bytree) for decided learning rate and number of trees. Note that we can choose different parameters to define a tree and Ill take up an example here.</li>
<li>Tune regularization parameters (lambda, alpha) for xgboost which can help reduce model complexity and enhance performance.</li>
<li>Lower the learning rate and decide the optimal parameters .</li>
<li>max_depth: This should be between 3-10. 4-6 can be good starting points.</li>
<li>min_child_weight: Define a smaller value if your data set is a highly imbalanced class problem and leaf nodes can have smaller size groups.</li>
<li>gamma: apply L1 regularization, a smaller value like 0.1-0.2 can also be chosen for starting. </li>
<li>subsample, colsample_bytree: 0.8  is a commonly used used start value. Typical values range between 0.5-0.9.</li>
<li>scale_pos_weight: use to balance, for binary class do ((len(y_train)-y_train.sum())/y_train.sum()).</li>
<li>reg_lambda: apply L2 regularization to reduce overfitting. Though many people dont use this parameters much as gamma provides a substantial way of controlling complexity. But we should always try it. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[146]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="c1">#(&#39;pca&#39;, PCA(random_state = 101)),</span>
        <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">min_child_weight</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">colsample_bytree</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">importance_type</span><span class="o">=</span><span class="s1">&#39;gain&#39;</span><span class="p">,</span>
                 <span class="n">objective</span><span class="o">=</span> <span class="s1">&#39;binary:logistic&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scale_pos_weight</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">))])</span>  

<span class="c1"># a list of dictionaries to specify the parameters that we&#39;d want to tune</span>
<span class="n">n_components</span><span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">21</span><span class="p">]</span> <span class="c1"># [25, 22, 31, 54]</span>
<span class="n">whiten</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">scale</span> <span class="o">=</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span><span class="o">-</span><span class="n">y_train</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">/</span><span class="n">y_train</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>

<span class="n">param_grid</span> <span class="o">=</span> \
    <span class="p">[{</span>
     <span class="s1">&#39;clf__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
     <span class="s1">&#39;clf__min_child_weight&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
     <span class="s1">&#39;clf__gamma&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span>
     <span class="s1">&#39;clf__reg_alpha&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span>
     <span class="s1">&#39;clf__subsample&#39;</span> <span class="p">:</span> <span class="n">sample</span><span class="p">,</span>
     <span class="s1">&#39;clf__colsample_bytree&#39;</span> <span class="p">:</span><span class="n">sample</span>
     <span class="c1">#,&#39;pca__n_components&#39; : n_components</span>
     <span class="c1">#,&#39;pca__whiten&#39; : [True] # whiten</span>
<span class="p">}]</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">main_pip</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">,</span> <span class="n">select_fetaures</span><span class="p">(</span><span class="n">select_cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">))),</span>
        <span class="c1">#(&#39;scl&#39;, StandardScaler()),</span>
        <span class="c1">#(&#39;lda&#39;, LDA(store_covariance=True)),</span>
        <span class="p">(</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>
 <span class="p">])</span>  

<span class="n">results</span><span class="p">,</span> <span class="n">xgb1</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">main_pip</span><span class="p">,</span> <span class="s1">&#39;XGBClassifier&#39;</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">trainXGB</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recive 54 features...
Select 15 features
Fitting 3 folds for each of 24200 candidates, totalling 72600 fits
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=4)]: Done  42 tasks      | elapsed:    4.5s
[Parallel(n_jobs=4)]: Done 192 tasks      | elapsed:   10.7s
[Parallel(n_jobs=4)]: Done 442 tasks      | elapsed:   21.7s
[Parallel(n_jobs=4)]: Done 792 tasks      | elapsed:   38.1s
[Parallel(n_jobs=4)]: Done 1242 tasks      | elapsed:  1.0min
[Parallel(n_jobs=4)]: Done 1792 tasks      | elapsed:  1.5min
[Parallel(n_jobs=4)]: Done 2442 tasks      | elapsed:  2.1min
[Parallel(n_jobs=4)]: Done 3192 tasks      | elapsed:  2.7min
[Parallel(n_jobs=4)]: Done 4042 tasks      | elapsed:  3.5min
[Parallel(n_jobs=4)]: Done 4992 tasks      | elapsed:  4.4min
[Parallel(n_jobs=4)]: Done 6042 tasks      | elapsed:  5.3min
[Parallel(n_jobs=4)]: Done 7192 tasks      | elapsed:  6.2min
[Parallel(n_jobs=4)]: Done 8442 tasks      | elapsed:  7.3min
[Parallel(n_jobs=4)]: Done 9792 tasks      | elapsed:  8.4min
[Parallel(n_jobs=4)]: Done 11242 tasks      | elapsed:  9.7min
[Parallel(n_jobs=4)]: Done 12792 tasks      | elapsed: 11.1min
[Parallel(n_jobs=4)]: Done 14442 tasks      | elapsed: 12.5min
[Parallel(n_jobs=4)]: Done 16192 tasks      | elapsed: 14.0min
[Parallel(n_jobs=4)]: Done 18042 tasks      | elapsed: 15.5min
[Parallel(n_jobs=4)]: Done 19992 tasks      | elapsed: 17.1min
[Parallel(n_jobs=4)]: Done 22042 tasks      | elapsed: 18.8min
[Parallel(n_jobs=4)]: Done 24192 tasks      | elapsed: 20.5min
[Parallel(n_jobs=4)]: Done 26442 tasks      | elapsed: 22.3min
[Parallel(n_jobs=4)]: Done 28792 tasks      | elapsed: 24.2min
[Parallel(n_jobs=4)]: Done 31242 tasks      | elapsed: 26.3min
[Parallel(n_jobs=4)]: Done 33792 tasks      | elapsed: 28.4min
[Parallel(n_jobs=4)]: Done 36442 tasks      | elapsed: 31.0min
[Parallel(n_jobs=4)]: Done 39192 tasks      | elapsed: 33.7min
[Parallel(n_jobs=4)]: Done 42042 tasks      | elapsed: 36.3min
[Parallel(n_jobs=4)]: Done 44992 tasks      | elapsed: 39.0min
[Parallel(n_jobs=4)]: Done 48042 tasks      | elapsed: 41.7min
[Parallel(n_jobs=4)]: Done 51192 tasks      | elapsed: 44.6min
[Parallel(n_jobs=4)]: Done 54442 tasks      | elapsed: 47.6min
[Parallel(n_jobs=4)]: Done 57792 tasks      | elapsed: 51.1min
[Parallel(n_jobs=4)]: Done 61242 tasks      | elapsed: 54.7min
[Parallel(n_jobs=4)]: Done 64792 tasks      | elapsed: 58.3min
[Parallel(n_jobs=4)]: Done 68442 tasks      | elapsed: 61.7min
[Parallel(n_jobs=4)]: Done 72192 tasks      | elapsed: 65.2min
[Parallel(n_jobs=4)]: Done 72600 out of 72600 | elapsed: 65.6min finished
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Best Accuracy: 84.06%
{&#39;clf__colsample_bytree&#39;: 0.7, &#39;clf__gamma&#39;: 0.0, &#39;clf__max_depth&#39;: 3, &#39;clf__min_child_weight&#39;: 2, &#39;clf__reg_alpha&#39;: 0.9, &#39;clf__subsample&#39;: 0.9} 

Select 15 features
Model Performance metrics:
------------------------------
Accuracy:  89.23% 
Precision: 89.25% 
Recall:    89.23% 
F1 Score:  89.24% 

Model Classification report:
------------------------------
             precision    recall  f1-score   support

          1       0.86      0.87      0.86       342
          0       0.92      0.91      0.91       549

avg / total       0.89      0.89      0.89       891


Prediction Confusion Matrix:
------------------------------
          Predicted:     
                   1    0
Actual: 1        296   46
        0         50  499


              ROC AUC Score: 88.72%
Select 15 features
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_192_3.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You may have noticed that the number of estimators is actually a parameter that defines the maximum of interactions, whether or not your final model has this number of estimators.</p>
<p>In fact, the ideal is that it has a smaller number, because this means that its model actually found a local minimum. In fact, this local minimum may not be great, so making a choice by a high number when you are running a grid search may be the best.</p>
<p>However, you may experience performance issues, so you will be tempted to perform some low number interactions to try to find the best possible values for your other parameters and then proceed with an additional round with a high number of estimators. Although this is a valid attitude, beware of the fact that by doing this you may be discarding some value from another paramenter, which would actually be used with a number of estimators to be greater than you have defined.</p>
<p>My recommendation is that after you have tried a bit, and have understood a little more how your model is performing in front of the data, make a run with the number of larger estimators and keep the others in some range, however small, or that it has the value found and two opposite ends.</p>
<p>Since you are verbose in 1, you will be able to estimate the total execution time right after some tasks have been completed, and then evaluate whether you prefer to abort and reduce the number of estimators or the range of some of the other parameters.</p>
<p>Once you have reached a set of parameters that satisfied you, it is interesting that you run it once again, and check if a lower learning rate and higer estimators can produce better results. Lets do it and use our normal 5 CV to get the final model:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[96]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># a list of dictionaries to specify the parameters that we&#39;d want to tune</span>
<span class="n">scale</span> <span class="o">=</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span><span class="o">-</span><span class="n">y_train</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">/</span><span class="n">y_train</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">param_grid</span> <span class="o">=</span> \
    <span class="p">[{</span>
     <span class="s1">&#39;clf__learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">],</span>
     <span class="s1">&#39;clf__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]</span>
<span class="p">}]</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">min_child_weight</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> 
                              <span class="n">subsample</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">colsample_bytree</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">objective</span><span class="o">=</span> <span class="s1">&#39;binary:logistic&#39;</span><span class="p">,</span> <span class="n">importance_type</span><span class="o">=</span><span class="s1">&#39;gain&#39;</span><span class="p">,</span> 
                              <span class="n">reg_alpha</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scale_pos_weight</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">))])</span>  

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">main_pip</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">,</span> <span class="n">select_fetaures</span><span class="p">(</span><span class="n">select_cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">pv_cols</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>
 <span class="p">])</span>  

<span class="n">results</span><span class="p">,</span> <span class="n">xgbF</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">main_pip</span><span class="p">,</span> <span class="s1">&#39;XGBClassifier Final&#39;</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">trainXGB</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recive 54 features...
Select 15 features
Fitting 3 folds for each of 10 candidates, totalling 30 fits
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=4)]: Done  30 out of  30 | elapsed:   12.8s finished
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Best Accuracy: 84.06%
{&#39;clf__learning_rate&#39;: 0.1, &#39;clf__n_estimators&#39;: 200} 

Select 15 features
Model Performance metrics:
------------------------------
Accuracy:  89.23% 
Precision: 89.25% 
Recall:    89.23% 
F1 Score:  89.24% 

Model Classification report:
------------------------------
             precision    recall  f1-score   support

          1       0.86      0.87      0.86       342
          0       0.92      0.91      0.91       549

avg / total       0.89      0.89      0.89       891


Prediction Confusion Matrix:
------------------------------
          Predicted:     
                   1    0
Actual: 1        296   46
        0         50  499


              ROC AUC Score: 88.72%
Select 15 features
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_194_3.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Finalize-The-Model:-Stacking-the-Models">Finalize The Model: Stacking the Models<a class="anchor-link" href="#Finalize-The-Model:-Stacking-the-Models">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Check-the-best-results-from-the-models-hiperparametrization">Check the best results from the models hiperparametrization<a class="anchor-link" href="#Check-the-best-results-from-the-models-hiperparametrization">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[101]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;ROC Area&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Prob</th>
      <th>CV Accuracy</th>
      <th>Acc All</th>
      <th>ROC AUC Score</th>
      <th>ROC Area</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>RandomForestClassifier</th>
      <td>True</td>
      <td>0.838384</td>
      <td>0.9585</td>
      <td>0.954175</td>
      <td>0.993113</td>
    </tr>
    <tr>
      <th>XGBClassifier Final</th>
      <td>True</td>
      <td>0.840629</td>
      <td>0.8923</td>
      <td>0.887211</td>
      <td>0.953539</td>
    </tr>
    <tr>
      <th>KNeighborsClassifier</th>
      <td>True</td>
      <td>0.827160</td>
      <td>0.8519</td>
      <td>0.839541</td>
      <td>0.905762</td>
    </tr>
    <tr>
      <th>MLPClassifier</th>
      <td>True</td>
      <td>0.847363</td>
      <td>0.8451</td>
      <td>0.825256</td>
      <td>0.898074</td>
    </tr>
    <tr>
      <th>GaussianProcessClassifier</th>
      <td>True</td>
      <td>0.843996</td>
      <td>0.8440</td>
      <td>0.825448</td>
      <td>0.896995</td>
    </tr>
    <tr>
      <th>GradientBoostingClassifier</th>
      <td>True</td>
      <td>0.840629</td>
      <td>0.8440</td>
      <td>0.812218</td>
      <td>0.894321</td>
    </tr>
    <tr>
      <th>SGDClassifier</th>
      <td>False</td>
      <td>0.839506</td>
      <td>0.8305</td>
      <td>0.824993</td>
      <td>0.888644</td>
    </tr>
    <tr>
      <th>LinearSVC</th>
      <td>False</td>
      <td>0.828283</td>
      <td>0.8305</td>
      <td>0.824993</td>
      <td>0.888644</td>
    </tr>
    <tr>
      <th>LogisticRegression</th>
      <td>True</td>
      <td>0.822671</td>
      <td>0.8283</td>
      <td>0.813800</td>
      <td>0.877323</td>
    </tr>
    <tr>
      <th>AdaBoostClassifier</th>
      <td>True</td>
      <td>0.840629</td>
      <td>0.8440</td>
      <td>0.812218</td>
      <td>0.875292</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Validation-Function">Validation Function<a class="anchor-link" href="#Validation-Function">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[98]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_folds</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">def</span> <span class="nf">cvscore</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_folds</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span><span class="o">.</span><span class="n">get_n_splits</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">score</span><span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">train</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">kf</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Make-Staked-Classifier">Make Staked Classifier<a class="anchor-link" href="#Make-Staked-Classifier">&#182;</a></h3><p>Create an ensemble model by staked models with mean probabilities.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[118]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="p">(</span> <span class="n">xgbF</span><span class="p">,</span> <span class="n">rfc</span><span class="p">,</span> <span class="n">GBC</span><span class="p">,</span> <span class="n">AdaB</span><span class="p">,</span> <span class="n">mlpc</span><span class="p">,</span> <span class="n">gpc</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">KNNC</span> <span class="p">)</span>

<span class="n">trained_models</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
    <span class="c1">#model.fit(train, targets) models all ready fited</span>
    <span class="n">trained_models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trained_models</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
         <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">testXGB</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Preper Submission File of Probabilities Classifier</span>
<span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

<span class="n">ensemble</span> <span class="o">=</span> <span class="n">predictions_df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">submit</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">submit</span><span class="p">[</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Test_ID</span><span class="o">.</span><span class="n">values</span>
<span class="n">submit</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ensemble</span>

<span class="c1"># ----------------------------- Create File to Submit --------------------------------</span>
<span class="n">submit</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;Titanic_Probabilities_submission.csv&#39;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample of Probabilities Submit:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">submit</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Select 15 features
Select 47 features
Select 25 features
Select 25 features
Select 54 features
Select 47 features
Select 22 features
Select 25 features
Sample of Probabilities Submit:
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>892</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>893</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>894</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>895</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>896</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">&#182;</a></h2><p>As you saw from the results of the models, their accuracy from cross validation vary from 82.27% to 84.74%. In the other hand, you see a more large variance on the ROC accuracy, from 87.93% to 99.31%. Since this accuracy is taken by the probabilities, not by the results class, it may suggest to use a different sets of models to assembly.</p>
<p>In fact, if you submit this stacked classifier as it stands, you'll hit the 0.78947 score, which is exactly the same score I got with just Random Forest in R on my first submission. But, if you play around little you can get best score, if you pay attention to not get into overfitting.</p>
<p>Finally, as you saw, this is a interesting case to training techniques, because it is not easy to obtain a high score without risk of some overfitting, since it really have some cases wheres too specifique. If you try submit to the competition, you discover that you can find some models that have high score, and you use cross validation and take other actions to dealing with overfitting, but your score is worse than other with minor score that you had submitted. Don't give up!</p>
<p>For next steps, you can try:</p>
<ul>
<li>Try other models like Tensorflow</li>
<li>Try others configurations of stacked models (Voting, Mean Probabilities with other set of models)</li>
<li>Not apply boxcox1p on discret data, or apply on all numeric but before the selection features</li>
<li>Create others features and make other transformations</li>
</ul>

</div>
</div>
</div>
    </div>
  </div>
</body>

 


</html>
